{"version":3,"file":"vistorian-core.js","sources":["../src/datamanager.ts","../src/dynamicgraph.ts","../src/queries.ts","../src/utils.ts","../src/ordering.ts","../src/motifs.ts","../src/main.ts","../src/importers.ts","../src/search.ts","../src/messenger.ts","../src/analytics.ts","../src/colors.ts","../src/BSpline.ts","../src/glutils.ts","../src/legend.ts","../src/rangeslider.ts","../src/slider.ts","../src/smartslider.ts","../src/timeline.ts","../src/ui.ts","../src/timeslider.ts"],"sourcesContent":["// namespace networkcube {\r\n\r\n\r\n/* moved from utils to datamanager */\r\nexport function isValidIndex(v: number | undefined): boolean {\r\n    return v != undefined && v > -1;\r\n}\r\n\r\n/* moved from dynamicgraph to datamanager */\r\nexport class Selection {\r\n    name: string;\r\n    elementIds: number[];\r\n    acceptedType: string;\r\n    color: string = \"#3366cc\"; // INIT??\r\n    id: number;\r\n    showColor: boolean = true;\r\n    filter: boolean = false;\r\n    priority: number = 0;\r\n\r\n    constructor(id: number, acceptedType: string) {\r\n        this.id = id;\r\n        this.name = 'Selection-' + this.id\r\n        this.elementIds = [];\r\n        this.acceptedType = acceptedType;\r\n        this.priority = id;\r\n    }\r\n\r\n    acceptsType(type: string) {\r\n        return this.acceptedType == type;\r\n    }\r\n}\r\n\r\n// data set / graph with name\r\nexport class DataSet {\r\n    name: string;\r\n    nodeTable: any[];\r\n    linkTable: any[];\r\n    locationTable: any[] = [];\r\n    nodeSchema: NodeSchema;\r\n    linkSchema: LinkSchema;\r\n    locationSchema: LocationSchema;\r\n    selections: Selection[] = [] //predefined selections (not link type)\r\n\r\n    timeFormat: string = ''; // INIT?????????????\r\n    directed: boolean;\r\n\r\n    // constructor(name:string, nodeTable:any[], linkTable:any[], nodeSchema:NodeSchema, linkSchema:LinkSchema, locationTable?:any, locationSchema?:LocationSchema){\r\n    constructor(params: any) { // before without any\r\n        this.name = params.name;\r\n        this.nodeTable = params.nodeTable;\r\n        this.linkTable = params.linkTable;\r\n        this.directed = params.directed;\r\n\r\n        if (params.nodeSchema == undefined)\r\n            this.nodeSchema = getDefaultNodeSchema();\r\n        else\r\n            this.nodeSchema = params.nodeSchema;\r\n\r\n        if (params.linkSchema == undefined)\r\n            this.linkSchema = getDefaultLinkSchema();\r\n        else\r\n            this.linkSchema = params.linkSchema;\r\n\r\n        if (params.locationTable != undefined)\r\n            this.locationTable = params.locationTable;\r\n\r\n        if (params.locationSchema == undefined)\r\n            this.locationSchema = getDefaultLocationSchema();\r\n        else\r\n            this.locationSchema = params.locationSchema;\r\n\r\n        console.log('[n3] data set created', this);\r\n    }\r\n}\r\n\r\nexport function getDefaultNodeSchema(): NodeSchema {\r\n    return new NodeSchema(0);\r\n}\r\nexport function getDefaultLinkSchema(): LinkSchema {\r\n    return new LinkSchema(0, 1, 2);\r\n}\r\nexport function getDefaultLocationSchema(): LocationSchema {\r\n    return new LocationSchema(0, 1, 2, 3, 4, 5, 6, 7, 8);\r\n}\r\n\r\nexport class TableSchema {\r\n    name: string;\r\n    constructor(name: string) {\r\n        this.name = name;\r\n    }\r\n}\r\n\r\n// default node schema for node table\r\nexport class NodeSchema extends TableSchema {\r\n    id: number;\r\n    /* INIT ?????????????????? */\r\n    label: number = -1;\r\n    time: number = -1;\r\n    location: number = -1;\r\n    nodeType: number = -1;\r\n    shape: number = -1;\r\n    color: number = -1;\r\n    constructor(id: number) {\r\n        super('nodeSchema');\r\n        this.id = id;\r\n    }\r\n}\r\n\r\n// default node schema for link table\r\nexport class LinkSchema extends TableSchema {\r\n    id: number;\r\n    source: number;\r\n    target: number;\r\n    weight: number = -1; // INIT????????\r\n    linkType: number = -1;\r\n    directed: number = -1;\r\n    time: number = -1;\r\n    constructor(id: number, source: number, target: number) {\r\n        super('linkSchema');\r\n        this.source = source;\r\n        this.target = target;\r\n        this.id = id;\r\n    }\r\n}\r\nexport class LocationSchema extends TableSchema {\r\n    id: number;\r\n    label: number; // user given label\r\n    geoname: number = -1; // actual geo name (english)\r\n    longitude: number = -1;\r\n    latitude: number = -1;\r\n    x: number = -1;\r\n    y: number = -1;\r\n    z: number = -1;\r\n    radius: number = -1;\r\n\r\n    constructor(\r\n        id: number,\r\n        label: number,\r\n        geoname?: number,\r\n        longitude?: number,\r\n        latitude?: number,\r\n        x?: number,\r\n        y?: number,\r\n        z?: number,\r\n        radius?: number) {\r\n\r\n        super('locationSchema');\r\n\r\n        this.id = id;\r\n        this.label = label;\r\n\r\n        if (isValidIndex(geoname))\r\n            this.geoname = geoname != undefined ? geoname : -1; // geoname never will be undefined at this point\r\n        if (isValidIndex(longitude))\r\n            this.longitude = longitude != undefined ? longitude : -1;\r\n        if (isValidIndex(latitude))\r\n            this.latitude = latitude != undefined ? latitude : -1;\r\n        if (isValidIndex(x))\r\n            this.x = x != undefined ? x : -1;\r\n        if (isValidIndex(y))\r\n            this.y = y != undefined ? y : -1;\r\n        if (isValidIndex(z))\r\n            this.z = z != undefined ? z : -1;\r\n        if (isValidIndex(radius))\r\n            this.radius = radius != undefined ? radius : -1;\r\n    }\r\n}\r\n//}\r\n","import { DataSet, Selection, isValidIndex } from './datamanager'\r\nimport * as moment from 'moment'\r\nimport * as LZString from \"lz-string\";\r\n\r\nexport var GRANULARITY: moment.unitOfTime.Base[] = ['millisecond', 'second', 'minute', 'hour', 'day', 'week', 'month', 'year']; //, 'decade', 'century', 'millenium'];\r\n\r\nexport var DGRAPH_SUB: string = \"[*dgraph*]\";\r\nexport var DGRAPH_SER_VERBOSE_LOGGING = false;\r\n\r\nexport function dgraphReviver(dgraph: DynamicGraph, key: any, value: any): any {\r\n    if (value == DGRAPH_SUB)\r\n        return dgraph;\r\n    else\r\n        return value;\r\n}\r\n\r\nexport function dgraphReplacer(key: string, value: any): any {\r\n    // don't write out graph, as this would cause cycles\r\n    if (DGRAPH_SER_VERBOSE_LOGGING) {\r\n        console.log(\"dgraphReplacer\", key, value);\r\n    }\r\n    if (value instanceof DynamicGraph) {\r\n        console.log(\"dgraphReplacer found a DynamicGraph property\", key);\r\n        return DGRAPH_SUB;\r\n    }\r\n    return value;\r\n}\r\n\r\nexport class DynamicGraph {\r\n\r\n    private default_colors(i: number): string {\r\n        var colors = [\"#3366cc\", \"#dc3912\", \"#ff9900\", \"#109618\", \"#990099\", \"#0099c6\", \"#dd4477\", \"#66aa00\", \"#b82e2e\", \"#316395\", \"#994499\", \"#22aa99\", \"#aaaa11\", \"#6633cc\", \"#e67300\", \"#8b0707\", \"#651067\", \"#329262\", \"#5574a6\", \"#3b3eac\"];\r\n        return colors[i % colors.length];\r\n    }\r\n\r\n    // BOOKMARK_COLORS: string[] = colorSchemes.schema5;\r\n    BOOKMARK_COLORS: (i: number) => string = this.default_colors;\r\n    selectionColor_pointer: number = 0;\r\n\r\n    //data: DataSet;\r\n    name: string = ''; // INIT??\r\n\r\n    // data meta data\r\n    gran_min: number = 0; // INIT?\r\n    gran_max: number = Number.MAX_VALUE; // INIT?\r\n\r\n    minWeight: number = 10000000;\r\n    maxWeight: number = -10000000;\r\n\r\n    _nodes: Node[] = [];\r\n    _links: Link[] = [];\r\n    directed: boolean = false;\r\n    _nodePairs: NodePair[] = [];\r\n    _locations: Location[] = [];\r\n    // Contains all time objects for this dynamic graph\r\n    _times: Time[] = [];\r\n    // linkTypes: LinkType[] = [];\r\n    timeObjects: any[] = []\r\n\r\n    nodeOrders: Ordering[] = []; // INIT?\r\n\r\n    // Matrix for fast access to node pairs (link)\r\n    matrix: number[][] = []; // fast access to node pairs.\r\n\r\n    selections: Selection[] = [];\r\n\r\n    // node attributes\r\n    nodeArrays: NodeArray = new NodeArray();\r\n\r\n    // link attributes\r\n    linkArrays: LinkArray = new LinkArray();\r\n\r\n    // node pair attributes\r\n    nodePairArrays: NodePairArray = new NodePairArray();\r\n\r\n    // time attributes\r\n    timeArrays: TimeArray = new TimeArray();\r\n\r\n    // array for relation types\r\n    linkTypeArrays: LinkTypeArray = new LinkTypeArray();\r\n\r\n    // array for node types\r\n    nodeTypeArrays: NodeTypeArray = new NodeTypeArray();\r\n\r\n    // array for locations\r\n    locationArrays: LocationArray = new LocationArray();\r\n\r\n    // points to all object arrays. For convenience\r\n    attributeArrays: Object = {\r\n        node: this.nodeArrays,\r\n        link: this.linkArrays,\r\n        time: this.timeArrays,\r\n        nodePair: this.nodePairArrays,\r\n        linkType: this.linkTypeArrays,\r\n        nodeType: this.nodeTypeArrays,\r\n        location: this.locationArrays\r\n    }\r\n\r\n    // highlighted objects\r\n    highlightArrays: IDCompound = new IDCompound();\r\n\r\n    currentSelection_id: number = 0;\r\n\r\n    /* INIT OK?? */\r\n    defaultLinkSelection: Selection = this.createSelection('link');\r\n    defaultNodeSelection: Selection = this.createSelection('node');\r\n\r\n\r\n    // ACCESSOR FUNCTIONS\r\n    // universal accesor\r\n    attr(field: string, id: number, type: string) {\r\n        var r: any;\r\n        try {\r\n            r = (this.attributeArrays as any)[type][field][id]\r\n        } catch (e) {\r\n            r = undefined;\r\n        }\r\n        return r;\r\n    }\r\n\r\n    // storage keys /////////////////////////////////\r\n    //\r\n    gran_min_NAME: string = \"gran_min\";\r\n    gran_max_NAME: string = \"gran_max_NAME\";\r\n\r\n    directed_NAME: string = \"directed_NAME\";\r\n\r\n    minWeight_NAME: string = \"minWeight_NAME\";\r\n    maxWeight_NAME: string = \"maxWeight_NAME\";\r\n\r\n    matrix_NAME: string = \"matrix_NAME\";\r\n\r\n    nodeArrays_NAME: string = \"nodeArrays_NAME\";\r\n    linkArrays_NAME: string = \"linkArrays_NAME\";\r\n    nodePairArrays_NAME: string = \"nodePairArrays_NAME\";\r\n    timeArrays_NAME: string = \"timeArrays_NAME\";\r\n    linkTypeArrays_NAME: string = \"linkTypeArrays_NAME\";\r\n    nodeTypeArrays_NAME: string = \"nodeTypeArrays_NAME\";\r\n    locationArrays_NAME: string = \"locationArrays_NAME\";\r\n    //\r\n    // end storage keys //////////////////////////////\r\n\r\n\r\n\r\n    // FUNCTIONS\r\n\r\n    standardArrayReplacer(key: string, value: any): any {\r\n        // don't write out graph, as this would cause cycles\r\n        if (value instanceof DynamicGraph) {\r\n            console.log(\"standardReplacer found a DynamicGraph property\", key);\r\n            return DGRAPH_SUB;\r\n        }\r\n        // don't write out selection, because we must preserve it independently\r\n        // from the graph\r\n        else if (key == 'selections')\r\n            return undefined;\r\n\r\n        return value;\r\n    }\r\n    static timeReviver(k: string, v: any, s: DynamicGraph): any {\r\n        if (k == '') {\r\n            return copyPropsShallow(v, new Time(v.id, s));\r\n        } else {\r\n            return dgraphReviver(s, k, v);\r\n        }\r\n    }\r\n\r\n    static nodeArrayReviver(k: string, v: any, s: DynamicGraph): any {\r\n        switch (k) {\r\n            case '':\r\n                return copyPropsShallow(v, new NodeArray());\r\n            // case 'nodeType':\r\n            // return copyTimeSeries(v, function() { return new ScalarTimeSeries<string>(); });\r\n            case 'outLinks':\r\n            case 'inLinks':\r\n            case 'links':\r\n                return copyTimeSeries(v, function () { return new ArrayTimeSeries<number>(); });\r\n            case 'outNeighbors':\r\n            case 'inNeighbors':\r\n            case 'neighbors':\r\n                return copyTimeSeries(v, function () { return new ArrayTimeSeries<number>(); });\r\n            case 'locations':\r\n                return copyTimeSeries(v, function () { return new ScalarTimeSeries<number>(); });\r\n            default:\r\n                return v;\r\n        }\r\n    }\r\n\r\n    static linkArrayReviver(k: string, v: any, s: DynamicGraph): any {\r\n        switch (k) {\r\n            case '':\r\n                return copyPropsShallow(v, new LinkArray());\r\n            case 'weights':\r\n                return copyTimeSeries(v, function () { return new ScalarTimeSeries<any>(); });\r\n            default:\r\n                return v;\r\n        }\r\n    }\r\n\r\n    static nodePairArrayReviver(k: string, v: any, s: DynamicGraph): any {\r\n        switch (k) {\r\n            case '':\r\n                return copyPropsShallow(v, new NodePairArray());\r\n            default:\r\n                return v;\r\n        }\r\n    }\r\n\r\n    static timeArrayReviver(k: string, v: any, s: DynamicGraph): any {\r\n        switch (k) {\r\n            case '':\r\n                return copyPropsShallow(v, new TimeArray());\r\n            case 'time':\r\n                var vAsArray: string[] = v;\r\n                return vAsArray.map(function (s, i) { return moment.utc(s); });\r\n            default:\r\n                return v;\r\n        }\r\n    }\r\n\r\n    static linkTypeArrayReviver(k: string, v: any, s: DynamicGraph): any {\r\n        switch (k) {\r\n            case '':\r\n                return copyPropsShallow(v, new LinkTypeArray());\r\n            default:\r\n                return v;\r\n        }\r\n    }\r\n    static nodeTypeArrayReviver(k: string, v: any, s: DynamicGraph): any {\r\n        switch (k) {\r\n            case '':\r\n                return copyPropsShallow(v, new NodeTypeArray());\r\n            default:\r\n                return v;\r\n        }\r\n    }\r\n\r\n    static locationArrayReviver(k: string, v: any, s: DynamicGraph): any {\r\n        switch (k) {\r\n            case '':\r\n                return copyPropsShallow(v, new LocationArray());\r\n            default:\r\n                return v;\r\n        }\r\n    }\r\n\r\n    loadDynamicGraph(dataMgr: DataManager, dataSetName: string): void {\r\n        this.clearSelections();\r\n        this.name = dataSetName;\r\n        var thisGraph = this;\r\n\r\n        // CACHEGRAPH : load from storage the entire state of the graph\r\n\r\n        var gran_min_storage = dataMgr.getFromStorage<number>(this.name, this.gran_min_NAME);\r\n        if (gran_min_storage != undefined)\r\n            this.gran_min = gran_min_storage;\r\n\r\n        var gran_max_storage = dataMgr.getFromStorage<number>(this.name, this.gran_max_NAME);\r\n        if (gran_max_storage != undefined)\r\n            this.gran_max = gran_max_storage;\r\n\r\n        var directed_storage = dataMgr.getFromStorage<boolean>(this.name, this.directed_NAME);\r\n        if (directed_storage != undefined)\r\n            this.directed = directed_storage;\r\n\r\n        var minWeight_storage = dataMgr.getFromStorage<number>(this.name, this.minWeight_NAME);\r\n        if (minWeight_storage != undefined)\r\n            this.minWeight = minWeight_storage;\r\n\r\n        var maxWeight_storage = dataMgr.getFromStorage<number>(this.name, this.maxWeight_NAME);\r\n        if (maxWeight_storage != undefined)\r\n            this.maxWeight = maxWeight_storage;\r\n\r\n        var matrix_storage = dataMgr.getFromStorage<number[][]>(this.name, this.matrix_NAME);\r\n        if (matrix_storage != undefined)\r\n            this.matrix = matrix_storage;\r\n\r\n        var nodeArrays_storage = dataMgr.getFromStorage<NodeArray>(this.name, this.nodeArrays_NAME, DynamicGraph.nodeArrayReviver);\r\n        if (nodeArrays_storage != undefined)\r\n            this.nodeArrays = nodeArrays_storage;\r\n\r\n        var linkArrays_storage = dataMgr.getFromStorage<LinkArray>(this.name, this.linkArrays_NAME, DynamicGraph.linkArrayReviver);\r\n        if (linkArrays_storage != undefined)\r\n            this.linkArrays = linkArrays_storage;\r\n\r\n        var nodePairArrays_storage = dataMgr.getFromStorage<NodePairArray>(this.name, this.nodePairArrays_NAME, DynamicGraph.nodePairArrayReviver);\r\n        if (nodePairArrays_storage != undefined)\r\n            this.nodePairArrays = nodePairArrays_storage;\r\n\r\n        var timeArrays_storage = dataMgr.getFromStorage<TimeArray>(this.name, this.timeArrays_NAME, DynamicGraph.timeArrayReviver);\r\n        if (timeArrays_storage != undefined)\r\n            this.timeArrays = timeArrays_storage;\r\n\r\n        if (!('timeArrays' in this) || !this.timeArrays) {\r\n            console.log('No timeArrays');\r\n            this.timeArrays = new TimeArray();\r\n        }\r\n        else if ('momentTime' in this.timeArrays && 'unixTime' in this.timeArrays) {\r\n            var ta = this.timeArrays['momentTime'];\r\n            for (var i = 0; i < ta.length; i++) {\r\n                ta[i] = moment.utc(this.timeArrays['unixTime'][i]);\r\n            }\r\n        }\r\n\r\n        /* I DON'T KNOW WHY timeArrays IS never */\r\n\r\n        else if ('unixTime' in this.timeArrays) {\r\n            console.log('No time in timeArrays');\r\n            (this.timeArrays as any)['momentTime'] = (this.timeArrays as any)['unixTime'].map(moment.utc());\r\n        }\r\n        else {\r\n            console.log('No time or unixTime in timeArrays');\r\n            (this.timeArrays as any)['momentTime'] = []\r\n        }\r\n\r\n        var linkTypeArrays_storage = dataMgr.getFromStorage<LinkTypeArray>(this.name, this.linkTypeArrays_NAME, DynamicGraph.linkTypeArrayReviver);\r\n        if (linkTypeArrays_storage != undefined)\r\n            this.linkTypeArrays = linkTypeArrays_storage;\r\n\r\n        var nodeTypeArrays_storage = dataMgr.getFromStorage<NodeTypeArray>(this.name, this.nodeTypeArrays_NAME, DynamicGraph.nodeTypeArrayReviver);\r\n        if (nodeTypeArrays_storage != undefined)\r\n            this.nodeTypeArrays = nodeTypeArrays_storage;\r\n\r\n        var locationArrays_storage = dataMgr.getFromStorage<LocationArray>(this.name, this.locationArrays_NAME, DynamicGraph.locationArrayReviver);\r\n        if (locationArrays_storage != undefined)\r\n            this.locationArrays = locationArrays_storage;\r\n\r\n        // points to all object arrays. For convenience\r\n        this.attributeArrays = {\r\n            node: this.nodeArrays,\r\n            link: this.linkArrays,\r\n            time: this.timeArrays,\r\n            nodePair: this.nodePairArrays,\r\n            linkType: this.linkTypeArrays,\r\n            nodeType: this.nodeTypeArrays,\r\n            location: this.locationArrays\r\n        };\r\n\r\n        // rather than persist all of the state of windowGraph\r\n        // as well, we simply reinitialize from our persisted state.\r\n        // perhaps we need to serialize this as well.\r\n        // inits the WindowGraph for this dynamic graph, i.e.\r\n        // the all-aggregated graph.\r\n        this.createGraphObjects(true, true);\r\n\r\n\r\n        // init the selections which are currently null\r\n        // this.nodeArrays.selections=[];\r\n        // this.nodeArrays.selections.push([]);\r\n        // this.timeArrays.selections=[];\r\n        // this.timeArrays.selections.push([]);\r\n        // this.linkArrays.selections=[];\r\n        // this.linkArrays.selections.push([]);\r\n        // this.nodePairArrays.selections=[];\r\n        // this.nodePairArrays.selections.push([]);\r\n        this.createSelections(true);\r\n\r\n    }\r\n\r\n    saveDynamicGraph(dataMgr: DataManager): void {\r\n        // CACHEGRAPH : persist the entire state of the dynamic graph\r\n        dataMgr.saveToStorage(this.name, this.gran_min_NAME, this.gran_min);\r\n        dataMgr.saveToStorage(this.name, this.gran_max_NAME, this.gran_max);\r\n        dataMgr.saveToStorage(this.name, this.directed_NAME, this.directed);\r\n        dataMgr.saveToStorage(this.name, this.minWeight_NAME, this.minWeight);\r\n        dataMgr.saveToStorage(this.name, this.maxWeight_NAME, this.maxWeight);\r\n\r\n        dataMgr.saveToStorage(this.name, this.matrix_NAME, this.matrix);\r\n        dataMgr.saveToStorage(this.name, this.nodeArrays_NAME, this.nodeArrays, this.standardArrayReplacer);\r\n        // when we tried to persist the entire linkArrays, javascript threw an\r\n        // exception, so for now we will simply try to save out the parts.\r\n        dataMgr.saveToStorage(this.name, this.linkArrays_NAME, this.linkArrays, this.standardArrayReplacer);\r\n        // dataMgr.saveToStorage(this.name, this.linkArrays_NAME+\"source\", this.linkArrays.source, this.standardReplacer);\r\n        // dataMgr.saveToStorage(this.name, this.linkArrays_NAME+\"target\", this.linkArrays.target, this.standardReplacer);\r\n        // dataMgr.saveToStorage(this.name, this.linkArrays_NAME+\"linkType\", this.linkArrays.linkType, this.standardReplacer);\r\n        // dataMgr.saveToStorage(this.name, this.linkArrays_NAME+\"directed\", this.linkArrays.directed, this.standardReplacer);\r\n        // dataMgr.saveToStorage(this.name, this.linkArrays_NAME+\"nodePair\", this.linkArrays.nodePair, this.standardReplacer);\r\n        // dataMgr.saveToStorage(this.name, this.linkArrays_NAME+\"presence\", this.linkArrays.presence, this.standardReplacer);\r\n        // dataMgr.saveToStorage(this.name, this.linkArrays_NAME+\"weights\", this.linkArrays.weights, this.standardReplacer);\r\n        // dataMgr.saveToStorage(this.name, this.linkArrays_NAME+\"filter\", this.linkArrays.filter, this.standardReplacer);\r\n        // dataMgr.saveToStorage(this.name, this.linkArrays_NAME+\"attributes\", this.linkArrays.attributes, this.standardReplacer);\r\n\r\n        dataMgr.saveToStorage(this.name, this.nodePairArrays_NAME, this.nodePairArrays, this.standardArrayReplacer);\r\n        dataMgr.saveToStorage(this.name, this.timeArrays_NAME, this.timeArrays, this.standardArrayReplacer);\r\n        dataMgr.saveToStorage(this.name, this.linkTypeArrays_NAME, this.linkTypeArrays, this.standardArrayReplacer);\r\n        dataMgr.saveToStorage(this.name, this.nodeTypeArrays_NAME, this.nodeTypeArrays, this.standardArrayReplacer);\r\n        dataMgr.saveToStorage(this.name, this.locationArrays_NAME, this.locationArrays, this.standardArrayReplacer);\r\n    }\r\n\r\n    // Removes this graph from the cache.\r\n    delete(dataMgr: DataManager) {\r\n        dataMgr.removeFromStorage(this.name, this.gran_min_NAME);\r\n        dataMgr.removeFromStorage(this.name, this.gran_max_NAME);\r\n        dataMgr.removeFromStorage(this.name, this.directed_NAME);\r\n        dataMgr.removeFromStorage(this.name, this.minWeight_NAME);\r\n        dataMgr.removeFromStorage(this.name, this.maxWeight_NAME);\r\n\r\n        dataMgr.removeFromStorage(this.name, this.matrix_NAME);\r\n        dataMgr.removeFromStorage(this.name, this.nodeArrays_NAME);\r\n        // when we tried to persist the entire linkArrays, javascript threw an\r\n        // exception, so for now we will simply try to save out the parts.\r\n        dataMgr.removeFromStorage(this.name, this.linkArrays_NAME);\r\n        // dataMgr.saveToStorage(this.name, this.linkArrays_NAME+\"source\", this.linkArrays.source, this.standardReplacer);\r\n        // dataMgr.saveToStorage(this.name, this.linkArrays_NAME+\"target\", this.linkArrays.target, this.standardReplacer);\r\n        // dataMgr.saveToStorage(this.name, this.linkArrays_NAME+\"linkType\", this.linkArrays.linkType, this.standardReplacer);\r\n        // dataMgr.saveToStorage(this.name, this.linkArrays_NAME+\"directed\", this.linkArrays.directed, this.standardReplacer);\r\n        // dataMgr.saveToStorage(this.name, this.linkArrays_NAME+\"nodePair\", this.linkArrays.nodePair, this.standardReplacer);\r\n        // dataMgr.saveToStorage(this.name, this.linkArrays_NAME+\"presence\", this.linkArrays.presence, this.standardReplacer);\r\n        // dataMgr.saveToStorage(this.name, this.linkArrays_NAME+\"weights\", this.linkArrays.weights, this.standardReplacer);\r\n        // dataMgr.saveToStorage(this.name, this.linkArrays_NAME+\"filter\", this.linkArrays.filter, this.standardReplacer);\r\n        // dataMgr.saveToStorage(this.name, this.linkArrays_NAME+\"attributes\", this.linkArrays.attributes, this.standardReplacer);\r\n\r\n        dataMgr.removeFromStorage(this.name, this.nodePairArrays_NAME);\r\n        dataMgr.removeFromStorage(this.name, this.timeArrays_NAME);\r\n        dataMgr.removeFromStorage(this.name, this.linkTypeArrays_NAME);\r\n        dataMgr.removeFromStorage(this.name, this.nodeTypeArrays_NAME);\r\n        dataMgr.removeFromStorage(this.name, this.locationArrays_NAME);\r\n\r\n    }\r\n\r\n    debugCompareTo(other: DynamicGraph): boolean {\r\n        var result: boolean = true;\r\n\r\n        if (this.name != other.name) {\r\n            console.log(\"name different\");\r\n            result = false;\r\n        }\r\n        // CACHEGRAPH compare every aspect of this one to the other one\r\n        if (this.gran_min != other.gran_min) {\r\n            console.log(\"gran_min different\", this.gran_min, other.gran_min);\r\n            result = false;\r\n        }\r\n        if (this.gran_max != other.gran_max) {\r\n            console.log(\"gran_max different\", this.gran_max, other.gran_max);\r\n            result = false;\r\n        }\r\n\r\n        if (this.directed != other.directed) {\r\n            console.log(\"directed different\", this.directed, other.directed);\r\n            result = false;\r\n        }\r\n\r\n        if (this._nodes.length != other._nodes.length\r\n            || !compareTypesDeep(this._nodes, other._nodes, 2)) {\r\n            console.log(\"nodes different\");\r\n            result = false;\r\n        }\r\n        if (this._links.length != other._links.length\r\n            || !compareTypesDeep(this._links, other._links, 2)) {\r\n            console.log(\"links different\");\r\n            result = false;\r\n        }\r\n        if (this._nodePairs.length != other._nodePairs.length\r\n            || !compareTypesDeep(this._nodePairs, other._nodePairs, 2)) {\r\n            console.log(\"nodePairs different\");\r\n            result = false;\r\n        }\r\n        if (this._locations.length != other._locations.length\r\n            || !compareTypesDeep(this._locations, other._locations, 2)) {\r\n            console.log(\"locations different\");\r\n            result = false;\r\n        }\r\n        if (this._times.length != other._times.length\r\n            || !compareTypesDeep(this._times, other._times, 2)) {\r\n            console.log(\"times different\");\r\n            result = false;\r\n        }\r\n\r\n        if ((this.nodeOrders && this.nodeOrders.length != other.nodeOrders.length)\r\n            || !compareTypesDeep(this.nodeOrders, other.nodeOrders, 2)) {\r\n            console.log(\"nodeOrders different\", this.nodeOrders, other.nodeOrders);\r\n            result = false;\r\n        }\r\n\r\n        if (this.matrix.length != other.matrix.length\r\n            || !compareTypesDeep(this.matrix, other.matrix, 2)) {\r\n            console.log(\"matrix different\", this.matrix, other.matrix);\r\n            result = false;\r\n        }\r\n\r\n        if (this.nodeArrays.length != other.nodeArrays.length\r\n            || !compareTypesDeep(this.nodeArrays, other.nodeArrays, 2)) {\r\n            console.log(\"nodeArrays different\", this.nodeArrays, other.nodeArrays);\r\n            result = false;\r\n        }\r\n\r\n        if (this.linkArrays.length != other.linkArrays.length\r\n            || !compareTypesDeep(this.linkArrays, other.linkArrays, 2)) {\r\n            console.log(\"linkArrays different\", this.linkArrays, other.linkArrays);\r\n            result = false;\r\n        }\r\n\r\n        if (this.nodePairArrays.length != other.nodePairArrays.length\r\n            || !compareTypesDeep(this.nodePairArrays, other.nodePairArrays, 2)) {\r\n            console.log(\"nodePairArrays different\", this.nodePairArrays, other.nodePairArrays);\r\n            result = false;\r\n        }\r\n\r\n        if (this.timeArrays.length != other.timeArrays.length\r\n            || !compareTypesDeep(this.timeArrays, other.timeArrays, 2)) {\r\n            console.log(\"timeArrays different\", this.timeArrays, other.timeArrays);\r\n            result = false;\r\n        }\r\n\r\n        if (this.linkTypeArrays.length != other.linkTypeArrays.length\r\n            || !compareTypesDeep(this.linkTypeArrays, other.linkTypeArrays, 2)) {\r\n            console.log(\"linkTypeArrays different\", this.linkTypeArrays, other.linkTypeArrays);\r\n            result = false;\r\n        }\r\n\r\n        if (this.nodeTypeArrays.length != other.nodeTypeArrays.length\r\n            || !compareTypesDeep(this.nodeTypeArrays, other.nodeTypeArrays, 2)) {\r\n            console.log(\"nodeTypeArrays different\", this.nodeTypeArrays, other.nodeTypeArrays);\r\n            result = false;\r\n        }\r\n\r\n        if (this.locationArrays.length != other.locationArrays.length\r\n            || !compareTypesDeep(this.locationArrays, other.locationArrays, 2)) {\r\n            console.log(\"locationArrays different\", this.locationArrays, other.locationArrays);\r\n            result = false;\r\n        }\r\n\r\n        if (this.defaultLinkSelection.elementIds.length != other.defaultLinkSelection.elementIds.length\r\n            || !compareTypesDeep(this.defaultLinkSelection, other.defaultLinkSelection, 2)) {\r\n            console.log(\"defaultLinkSelection different\", this.defaultLinkSelection, other.defaultLinkSelection);\r\n            result = false;\r\n        }\r\n\r\n        if (this.defaultNodeSelection.elementIds.length != other.defaultNodeSelection.elementIds.length\r\n            || !compareTypesDeep(this.defaultNodeSelection, other.defaultNodeSelection, 2)) {\r\n            console.log(\"defaultNodeSelection different\", this.defaultNodeSelection, other.defaultNodeSelection);\r\n            result = false;\r\n        }\r\n\r\n        if (this.selections.length != other.selections.length\r\n            || !compareTypesDeep(this.selections, other.selections, 2)) {\r\n            console.log(\"selections different\", this.selections, other.selections);\r\n            result = false;\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    // creates this graph and fills node, link and time arrays from\r\n    // data tables.\r\n    initDynamicGraph(data: DataSet): void {\r\n\r\n\r\n        // must agree with version in main.ts\r\n        var TIME_FORMAT: string = 'YYYY-MM-DD hh:mm:ss';\r\n\r\n        this.clearSelections();\r\n        console.log('[dynamicgraph.ts] Create dynamic graph for ', data.name, data)\r\n\r\n        //this.data = data;s\r\n        this.name = data.name;\r\n        this.directed = data.directed;\r\n\r\n        // fill node, link arrays and time\r\n\r\n        // CREATE TIME OBJECT for all events\r\n        this.gran_min = 0;\r\n        this.gran_max = 0;\r\n\r\n        if (isValidIndex(data.linkSchema.time)) {\r\n            var timeLabels: number[] = [];\r\n            var timeLabel: string;\r\n            var unixTimes: number[] = [];\r\n            var unixTime: number;\r\n\r\n            // get unix times for all times\r\n            console.log(\"GEtting unix times for all times - linktable\")\r\n            console.log(data.linkTable)\r\n            for (var i = 0; i < data.linkTable.length; i++) {\r\n                timeLabel = data.linkTable[i][data.linkSchema.time];\r\n                console.log(data.linkTable[i])\r\n                unixTime = parseInt(moment.utc(timeLabel, TIME_FORMAT).format('x'));\r\n                if (unixTime == undefined)\r\n                    continue;\r\n\r\n                if (unixTimes.indexOf(unixTime) == -1) {\r\n                    unixTimes.push(unixTime);\r\n                }\r\n            }\r\n            // obtain granularity\r\n            unixTimes.sort(sortNumber)\r\n\r\n            var diff = 99999999999999;\r\n            for (var i = 0; i < unixTimes.length - 2; i++) {\r\n                diff = Math.min(diff, unixTimes[i + 1] - unixTimes[i]);\r\n            }\r\n\r\n            var diff_min = diff;\r\n            if (diff >= 1000) this.gran_min = 1;\r\n            if (diff >= 1000 * 60) this.gran_min = 2;\r\n            if (diff >= 1000 * 60 * 60) this.gran_min = 3;\r\n            if (diff >= 1000 * 60 * 60 * 24) this.gran_min = 4;\r\n            if (diff >= 1000 * 60 * 60 * 24 * 7) this.gran_min = 5;\r\n            if (diff >= 1000 * 60 * 60 * 24 * 30) this.gran_min = 6;\r\n            if (diff >= 1000 * 60 * 60 * 24 * 30 * 12) this.gran_min = 7;\r\n            if (diff >= 1000 * 60 * 60 * 24 * 30 * 12 * 10) this.gran_min = 8;\r\n            if (diff >= 1000 * 60 * 60 * 24 * 30 * 12 * 100) this.gran_min = 9;\r\n            if (diff >= 1000 * 60 * 60 * 24 * 30 * 12 * 1000) this.gran_min = 10;\r\n\r\n            diff = unixTimes[unixTimes.length - 1] - unixTimes[0];\r\n            this.gran_max = 0;\r\n            if (diff >= 1000) this.gran_max = 1;\r\n            if (diff >= 1000 * 60) this.gran_max = 2;\r\n            if (diff >= 1000 * 60 * 60) this.gran_max = 3;\r\n            if (diff >= 1000 * 60 * 60 * 24) this.gran_max = 4;\r\n            if (diff >= 1000 * 60 * 60 * 24 * 7) this.gran_max = 5;\r\n            if (diff >= 1000 * 60 * 60 * 24 * 30) this.gran_max = 6;\r\n            if (diff >= 1000 * 60 * 60 * 24 * 30 * 12) this.gran_max = 7;\r\n            if (diff >= 1000 * 60 * 60 * 24 * 30 * 12 * 10) this.gran_max = 8;\r\n            if (diff >= 1000 * 60 * 60 * 24 * 30 * 12 * 100) this.gran_max = 9;\r\n            if (diff >= 1000 * 60 * 60 * 24 * 30 * 12 * 1000) this.gran_max = 10;\r\n\r\n            console.log('[Dynamic Graph] Minimal granularity', GRANULARITY[this.gran_min]);\r\n            console.log('[Dynamic Graph] Maximal granularity', GRANULARITY[this.gran_max]);\r\n\r\n            // create one time object for every time point of gran_min, between start and end time.\r\n            // [bb] deprecated\r\n            // var start = moment(unixTimes[0] + '', 'x').startOf(GRANULARITY[this.gran_min]);\r\n            // var end = moment(unixTimes[unixTimes.length - 1] + '', 'x').startOf(GRANULARITY[this.gran_min]);\r\n            // var numTimes = Math.ceil(Math.abs(start.diff(end, GRANULARITY[this.gran_min] + 's')));\r\n\r\n            // var curr_t = start;\r\n            // this._times = [];\r\n            for (var i = 0; i < unixTimes.length; i++) {\r\n                this.timeArrays.id.push(i);\r\n                this.timeArrays.momentTime.push(moment.utc(unixTimes[i]));\r\n                this.timeArrays.label.push(this.timeArrays.momentTime[i].format(TIME_FORMAT));\r\n                this.timeArrays.unixTime.push(unixTimes[i]);\r\n                this.timeArrays.selections.push([]);\r\n                this.timeArrays.filter.push(false)\r\n                this.timeArrays.links.push([]);\r\n\r\n                // create time objects\r\n                this._times.push(new Time(i, this));\r\n                // curr_t = start.add(1, GRANULARITY[this.gran_min] + 's');\r\n            }\r\n\r\n            // Now, all existing times with events and potentially\r\n            // attributes associated, have been created.\r\n            // Below, we create a simple array of moment.moments\r\n            // for any possible time unit for every aggregation level.\r\n            // In fact, those structures are created on-demand, i.e.\r\n            // the first time they are needed.\r\n            // Here, we only create the meta-structure\r\n            for (var g = 0; g <= GRANULARITY.length; g++) {\r\n                this.timeObjects.push([]) // AQUIIIII\r\n            }\r\n        }\r\n\r\n        // if no valid have been found:\r\n        if (this.timeArrays.length == 0) {\r\n            // null time object that represents one time step for the entire graph, i.e. a static graph\r\n            this.timeArrays.id.push(0);\r\n            this.timeArrays.momentTime.push(moment.utc(0));\r\n            this.timeArrays.unixTime.push(0);\r\n            this.timeArrays.selections.push([]);\r\n            this.timeArrays.filter.push(false)\r\n            this.timeArrays.links.push([])\r\n            this._times.push(new Time(0, this));\r\n        }\r\n\r\n        // from here on, there is at least one time object present.\r\n\r\n\r\n        // CREATE LOCATIONS\r\n        var id_loc;\r\n        var location: Location;\r\n\r\n        // if there is a location table, then there needs to be locationSchema\r\n        console.assert(!data.locationTable || isValidIndex(data.locationSchema.id));\r\n\r\n        if (data.locationTable) {\r\n            for (var i = 0; i < data.locationTable.length; i++) {\r\n                this.locationArrays.id.push(data.locationTable[i][data.locationSchema.id]);\r\n                this.locationArrays.label.push(data.locationTable[i][data.locationSchema.label]);\r\n                this.locationArrays.longitude.push(data.locationTable[i][data.locationSchema.longitude]);\r\n                this.locationArrays.latitude.push(data.locationTable[i][data.locationSchema.latitude]);\r\n                this.locationArrays.x.push(data.locationTable[i][data.locationSchema.x]);\r\n                this.locationArrays.y.push(data.locationTable[i][data.locationSchema.y]);\r\n                this.locationArrays.z.push(data.locationTable[i][data.locationSchema.z]);\r\n                this.locationArrays.radius.push(data.locationTable[i][data.locationSchema.radius]);\r\n            }\r\n        }\r\n        if ('id' in this.locationArrays)\r\n            console.log('locations', this.locationArrays.id.length);\r\n\r\n\r\n        // CREATE NODES\r\n        var row: any[];\r\n        var nodeId_data; // node id in data set\r\n        var nodeId_table; // node id in table\r\n        var attribute: any;\r\n        var time: Time;\r\n        console.assert(data.nodeTable.length == 0 || isValidIndex(data.nodeSchema.id),\r\n            'either there is no nodeTable data, or we have a schema for the nodetable');\r\n\r\n        var nodeUserProperties = []\r\n        // Get user-properties on links, if exist\r\n        for (var prop in data.nodeSchema) {\r\n            if (data.nodeSchema.hasOwnProperty(prop)\r\n                && prop != 'id'\r\n                && prop != 'label'\r\n                && prop != 'time'\r\n                && prop != 'name'\r\n                && prop != 'nodeType'\r\n                && prop != 'location'\r\n                && prop != 'constructor') {\r\n                nodeUserProperties.push(prop);\r\n                // create property\r\n                (this.nodeArrays as any)[prop] = []\r\n            }\r\n        }\r\n\r\n        for (var i = 0; i < data.nodeTable.length; i++) {\r\n            row = data.nodeTable[i];\r\n\r\n            // check if id already exists\r\n            nodeId_data = row[data.nodeSchema.id];\r\n            nodeId_table = this.nodeArrays.id.indexOf(nodeId_data);\r\n            if (nodeId_table == -1) {\r\n                nodeId_table = this.nodeArrays.id.length;\r\n                this.nodeArrays.id.push(nodeId_data);\r\n                this.nodeArrays.nodeType.push('');\r\n                this.nodeArrays.outLinks.push(new ArrayTimeSeries<number>());\r\n                this.nodeArrays.inLinks.push(new ArrayTimeSeries<number>());\r\n                this.nodeArrays.links.push(new ArrayTimeSeries<number>());      // both, in and out\r\n                this.nodeArrays.outNeighbors.push(new ArrayTimeSeries<number>());\r\n                this.nodeArrays.inNeighbors.push(new ArrayTimeSeries<number>());\r\n                this.nodeArrays.neighbors.push(new ArrayTimeSeries<number>());\r\n                this.nodeArrays.selections.push([]);\r\n                this.nodeArrays.filter.push(false);\r\n                this.nodeArrays.locations.push(new ScalarTimeSeries<number>());\r\n                this.nodeArrays.attributes.push(new Object());\r\n                this.nodeArrays.color.push('')\r\n                this.nodeArrays.shape.push('')\r\n                if (isValidIndex(data.nodeSchema.label)) {\r\n                    this.nodeArrays.label.push(row[data.nodeSchema.label]);\r\n                } else {\r\n                    this.nodeArrays.label.push(row[data.nodeSchema.id]);\r\n                }\r\n            }\r\n\r\n            // get time\r\n            // if (isValidIndex(data.nodeSchema.time)) {\r\n\r\n            if (isValidIndex(data.nodeSchema.time)) {\r\n                timeLabel = row[data.nodeSchema.time];\r\n                console.log(\"params\")\r\n                console.log(timeLabel)\r\n                console.log(TIME_FORMAT)\r\n                console.log(moment.utc(timeLabel, TIME_FORMAT))\r\n                console.log(moment.utc(timeLabel, TIME_FORMAT).format('x'))\r\n                var timeIdForUnixTime = this.getTimeIdForUnixTime(parseInt(moment.utc(timeLabel, TIME_FORMAT).format('x')))\r\n                if (timeLabel == undefined || timeIdForUnixTime == undefined) {//} || timeStamp.indexOf('null')) {\r\n                    time = this._times[0];\r\n                } else {\r\n                    time = this._times[timeIdForUnixTime];\r\n                }\r\n            } else {\r\n                time = this._times[0];\r\n            }\r\n            if (time == undefined)\r\n                time = this._times[0];\r\n\r\n            // check locations\r\n            if (isValidIndex(data.nodeSchema.location)) {\r\n                var locId = row[data.nodeSchema.location];\r\n                if (locId == null || locId == undefined)\r\n                    continue;\r\n                this.nodeArrays.locations[nodeId_data].set(time, locId);\r\n            }\r\n\r\n            // check shapes\r\n            if (isValidIndex(data.nodeSchema.shape)) {\r\n                var shape = row[data.nodeSchema.shape];\r\n                this.nodeArrays.shape.push(shape);\r\n            }\r\n\r\n            // gather node type\r\n            if (isValidIndex(data.nodeSchema.nodeType)) {\r\n                typeName = data.nodeTable[i][data.nodeSchema.nodeType]\r\n                typeId = this.nodeTypeArrays.name.indexOf(typeName)\r\n                if (typeId < 0) {\r\n                    typeId = this.nodeTypeArrays.length;\r\n                    this.nodeTypeArrays.id.push(typeId)\r\n                    this.nodeTypeArrays.name.push(typeName)\r\n                }\r\n                this.nodeArrays.nodeType[nodeId_table] = typeName;\r\n                data.nodeTable[i][data.nodeSchema.nodeType] = typeId;\r\n            }\r\n\r\n            // gather user-properties:\r\n            for (var p = 0; p < nodeUserProperties.length; p++) {\r\n                prop = nodeUserProperties[p];\r\n                (this.nodeArrays as any)[prop].push(row[(data.nodeSchema as any)[prop]]);\r\n            }\r\n\r\n\r\n            // see if temporal information is available\r\n            // if(data.nodeSchema.time && data.nodeSchema.time > -1){\r\n            //     for(var field in data.nodeSchema){\r\n            //         if (field != undefined\r\n            //             && data.nodeSchema.hasOwnProperty(field)\r\n            //             && data.Â©nodeSchema[field] > -1\r\n            //             && field != 'label'\r\n            //             && field != 'time'\r\n            //             && field != 'locations'\r\n            //             && field != 'id'\r\n            //             ){\r\n            //                 if(this.nodeArrays.attributes[nodeId_table][field] == undefined){\r\n            //                     this.nodeArrays.attributes[nodeId_table][field] = new ScalarTimeSeries();\r\n            //                 }\r\n            //                 timeLabel = data.nodeTable[i][data.nodeSchema.time];\r\n            //                 if(timeLabel == undefined)\r\n            //                     continue;\r\n            //                 timeStamp = parseInt(moment(timeLabel, networkcube.TIME_FORMAT).format('x'));\r\n            //                 time = this.times[this.getTimeIdForTimeStamp(timeStamp)];\r\n            //                 this.nodeArrays[field][nodeId_table].set(time, row[data.nodeSchema[field]]);\r\n\r\n            //             // //in case of locations:\r\n            //             // if(field == 'location'){\r\n            //             //     if(typeof row[data.nodeSchema[field]] == 'number'){\r\n            //             //         id_loc = row[data.nodeSchema[field]];\r\n            //             //     }\r\n            //             // }\r\n            //          }\r\n            //     }\r\n            // }else{\r\n            //     // no time information available on nodes\r\n            //     for(var field in data.nodeSchema){\r\n            //         if (field != undefined\r\n            //             && data.nodeSchema.hasOwnProperty(field)\r\n            //             && data.nodeSchema[field] > -1\r\n            //             && field != 'label'\r\n            //             && field != 'time'\r\n            //             && field != 'id'\r\n            //             && field != 'locations'\r\n            //             )\r\n            //         {\r\n            //             // check for non temporal information\r\n            //             if(this.nodeArrays.attributes[nodeId_table][field] == undefined){\r\n            //                 this.nodeArrays.attributes[nodeId_table][field] = new ScalarTimeSeries();\r\n            //             }\r\n            //             // eternal attributes are assigned no time.\r\n            //             this.nodeArrays[field][nodeId_table].set(undefined, row[data.nodeSchema[field]]);\r\n            //         }\r\n            //     }\r\n            // }\r\n        }\r\n\r\n        // create matrix and initialize with -1, i.e. nodes are not connected.\r\n        if ('id' in this.nodeArrays) {\r\n            for (var i = 0; i < this.nodeArrays.id.length; i++) {\r\n                this.matrix.push(array(undefined, this.nodeArrays.id.length));\r\n            }\r\n        }\r\n\r\n\r\n        // CREATE LINKS\r\n\r\n        var s: number, t: number;\r\n        var id: number;\r\n        var timeId: number;\r\n        var nodePairId: number;\r\n        var linkId: number;\r\n        var typeName: string;\r\n        var typeId: number;\r\n\r\n        var linkUserProperties = []\r\n        // Get user-properties on links, if exist\r\n        for (var prop in data.linkSchema) {\r\n            if (data.linkSchema.hasOwnProperty(prop)\r\n                && prop != 'id'\r\n                && prop != 'linkType'\r\n                && prop != 'time'\r\n                && prop != 'name'\r\n                && prop != 'source'\r\n                && prop != 'target'\r\n                && prop != 'weight'\r\n                && prop != 'directed') {\r\n                linkUserProperties.push(prop);\r\n                // create property\r\n                (this.linkArrays as any)[prop] = []\r\n            }\r\n        }\r\n        console.log('linkUserProperties', linkUserProperties)\r\n\r\n\r\n        console.assert(data.linkTable.length == 0 || (\r\n            isValidIndex(data.linkSchema.id)\r\n            && isValidIndex(data.linkSchema.source)\r\n            && isValidIndex(data.linkSchema.target)),\r\n            'either there are no links, or the linkschema is defined');\r\n\r\n        for (var i = 0; i < data.linkTable.length; i++) {\r\n            row = data.linkTable[i];\r\n            linkId = row[data.linkSchema.id];\r\n            this.linkArrays.directed.push(false); // this is default and can be overwritten in the following.\r\n\r\n            // check if linkId, i.e. link exists\r\n            if (this.linkArrays.id.indexOf(linkId) == -1) {\r\n                // init new link\r\n                this.linkArrays.id[linkId] = linkId;\r\n                this.linkArrays.source[linkId] = row[data.linkSchema.source];\r\n                this.linkArrays.target[linkId] = row[data.linkSchema.target];\r\n                this.linkArrays.linkType[linkId] = row[data.linkSchema.linkType];\r\n                this.linkArrays.directed[linkId] = row[data.linkSchema.directed];\r\n                this.linkArrays.weights[linkId] = new ScalarTimeSeries<any>();\r\n                this.linkArrays.presence[linkId] = [];\r\n                this.linkArrays.selections.push([]);\r\n                this.linkArrays.nodePair.push(undefined);\r\n                this.linkArrays.filter.push(false);\r\n            }\r\n\r\n            // set time information\r\n            if (isValidIndex(data.linkSchema.time)) {\r\n                timeLabel = data.linkTable[i][data.linkSchema.time];\r\n                unixTime = parseInt(moment.utc(timeLabel, TIME_FORMAT).format('x'));\r\n                var timeIdForUnixTime = this.getTimeIdForUnixTime(unixTime);\r\n                if (timeIdForUnixTime != undefined) {\r\n                    timeId = timeIdForUnixTime;\r\n                }\r\n                else {\r\n                    timeId = 0;\r\n                }\r\n            } else {\r\n                timeId = 0;\r\n            }\r\n\r\n            time = this._times[timeId];\r\n            this.linkArrays.presence[linkId].push(timeId);\r\n\r\n            // set weight if applies\r\n            if (isValidIndex(data.linkSchema.weight) && data.linkTable[i][data.linkSchema.weight] != undefined) {\r\n                this.linkArrays.weights[linkId].set(time, data.linkTable[i][data.linkSchema.weight])\r\n                this.minWeight = Math.min(this.minWeight, data.linkTable[i][data.linkSchema.weight])\r\n                this.maxWeight = Math.max(this.maxWeight, data.linkTable[i][data.linkSchema.weight])\r\n            } else {\r\n                // set one = presence\r\n                this.minWeight = 0\r\n                this.maxWeight = 1\r\n                this.linkArrays.weights[linkId].set(time, 1)\r\n            }\r\n\r\n            // add graph specific information\r\n            s = this.nodeArrays.id.indexOf(row[data.linkSchema.source]);\r\n            t = this.nodeArrays.id.indexOf(row[data.linkSchema.target]);\r\n            this.nodeArrays.neighbors[s].add(time, t);\r\n            this.nodeArrays.neighbors[t].add(time, s);\r\n\r\n            this.nodeArrays.links[s].add(time, linkId);\r\n            this.nodeArrays.links[t].add(time, linkId);\r\n\r\n            // for directed links, fill the in/out arrays\r\n            if (this.linkArrays.directed[i]) {\r\n                this.nodeArrays.outNeighbors[s].add(time, t);\r\n                this.nodeArrays.inNeighbors[t].add(time, s);\r\n\r\n                this.nodeArrays.outLinks[s].add(time, linkId);\r\n                this.nodeArrays.inLinks[t].add(time, linkId);\r\n            }\r\n\r\n            //link pairs\r\n            // a node pair is stored in a matrix structure for easy access.\r\n            // For every direction (s,t) and (t,s), an individual link pair\r\n            // exists. If an underlying link is undirected, it is referenced\r\n            // in both node pairs.\r\n            nodePairId = this.matrix[s][t];\r\n            if (!isValidIndex(nodePairId)) {\r\n                nodePairId = this.nodePairArrays.length;\r\n                this.matrix[s][t] = nodePairId;\r\n                this.nodePairArrays.id.push(nodePairId);\r\n                this.nodePairArrays.source.push(s);\r\n                this.nodePairArrays.target.push(t);\r\n                this.nodePairArrays.links.push([]);\r\n                this.nodePairArrays.selections.push([]);\r\n                this.nodePairArrays.filter.push(false);\r\n            }\r\n            // add link only, if not already exist\r\n            if (this.nodePairArrays.links[nodePairId].indexOf(linkId) == -1) {\r\n                this.nodePairArrays.links[nodePairId].push(linkId);\r\n                this.linkArrays.nodePair[linkId] = nodePairId;\r\n            }\r\n\r\n            //May affect matrix view, but breaks nodelink directionality\r\n            // if (this.linkArrays.directed[i]) {\r\n            //     nodePairId = this.matrix[t][s];\r\n            //     if (!nodePairId) {\r\n            //         nodePairId = this.nodePairArrays.id.length;\r\n            //         this.matrix[t][s] = nodePairId;\r\n            //         this.nodePairArrays.id.push(nodePairId);\r\n            //         this.nodePairArrays.source.push(t);\r\n            //         this.nodePairArrays.target.push(s);\r\n            //         this.nodePairArrays.links.push(doubleArray(this._times.length));\r\n            //     }\r\n            //     // add link only, if not already exist\r\n            //     if (this.nodePairArrays.links[nodePairId].indexOf(linkId) == -1) {\r\n            //         this.nodePairArrays.links[nodePairId].push(linkId);\r\n            //         this.linkArrays.nodePair[linkId] = nodePairId;\r\n            //     }\r\n            // }\r\n\r\n            // gather link types\r\n            if (isValidIndex(data.linkSchema.linkType)) {\r\n                typeName = data.linkTable[i][data.linkSchema.linkType]\r\n                typeId = this.linkTypeArrays.name.indexOf(typeName)\r\n                if (typeId < 0) {\r\n                    typeId = this.linkTypeArrays.length;\r\n                    this.linkTypeArrays.id.push(typeId)\r\n                    this.linkTypeArrays.name.push(typeName)\r\n                }\r\n                data.linkTable[i][data.linkSchema.linkType] = typeId;\r\n            }\r\n\r\n            // gather user-properties:\r\n            for (var p = 0; p < linkUserProperties.length; p++) {\r\n                prop = linkUserProperties[p];\r\n                (this.linkArrays as any)[prop].push(row[(data.linkSchema as any)[prop]]);\r\n            }\r\n        }\r\n\r\n        // For every time, store a pointer to all its links:\r\n        // var allLinks = links().toArray();\r\n        // var allTimes = this.g.times().toArray();\r\n        for (var i = 0; i < this.linkArrays.length; i++) {\r\n            for (var j = 0; j < this.timeArrays.length; j++) {\r\n                if(this.linkArrays.weights[i]) {\r\n                    if (this.linkArrays.weights[i].toArray().hasOwnProperty(this.timeArrays.id[j].toString())) {\r\n                        this.timeArrays.links[j].push(this.linkArrays.id[i]);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        //Build a color mapping\r\n        const colorSet = new Set(['#e4549b', '#a33a36', '#bd6221', '#dfba47', '#b5b867', '#479b7f', '#335b8e', '#78387d']);\r\n        var colorMappings: { [color: string]: string; } = {};\r\n        this.nodeArrays.color.forEach(function (color: any) {\r\n            if (!colorMappings[color]) {\r\n                let colorSetAsArray = Array.from(colorSet)\r\n                var generatedColor = colorSetAsArray[Math.floor(Math.random() * colorSetAsArray.length)]\r\n                colorMappings[color] = generatedColor;\r\n                colorSet.delete(generatedColor);\r\n            }\r\n        });\r\n\r\n        //Add color values to nodeArray colors\r\n        for(var i=0; i<this.nodeArrays.color.length; i++) {\r\n            this.nodeArrays.color[i] = this.nodeArrays.color[i], colorMappings[this.nodeArrays.color[i]];\r\n        }\r\n\r\n        //Build a shape mapping\r\n        const shapeSet = new Set(['cross', 'diamond', 'square', 'triangle-down', 'triangle-up']);\r\n        var shapeMappings: { [shape: string]: string; } = {};\r\n        this.nodeArrays.shape.forEach(function (shape: any) {\r\n            if (!shapeMappings[shape]) {\r\n                let shapeSetAsArray = Array.from(shapeSet)\r\n                var generatedShape = shapeSetAsArray[Math.floor(Math.random() * shapeSetAsArray.length)]\r\n                shapeMappings[shape] = generatedShape;\r\n                shapeSet.delete(generatedShape);\r\n            }\r\n        });\r\n\r\n        //Add shapes to nodeArray shapes\r\n        for(var i=0; i<this.nodeArrays.shape.length; i++) {\r\n            this.nodeArrays.shape[i] = this.nodeArrays.shape[i], shapeMappings[this.nodeArrays.shape[i]];\r\n        }\r\n        console.log(\" TEST \")\r\n        console.log(this)\r\n\r\n\r\n        // create color map for link types\r\n        var linkTypeCount: number = this.linkTypeArrays.length;\r\n\r\n        console.log('[Dynamic Graph] Dynamic Graph created: ', this.nodeArrays.length);\r\n        console.log('[Dynamic Graph]    - Nodes: ', this.nodeArrays.length);\r\n        console.log('[Dynamic Graph]    - Edges: ', this.linkArrays.length);\r\n        console.log('[Dynamic Graph]    - Times: ', this.timeArrays.length);\r\n        console.log('[Dynamic Graph]    - Link types: ', this.linkTypeArrays.length);\r\n        console.log('[Dynamic Graph]    - Node Pairs: ', this.nodePairArrays.length);\r\n\r\n\r\n        console.log('>>>this.nodeArrays[\"neighbors\"][0]', this.nodeArrays['neighbors'][0])\r\n\r\n        // inits the WindowGraph for this dynamic graph, i.e.\r\n        // the all-aggregated graph.\r\n        this.createGraphObjects(true, true); //false, false);\r\n\r\n        this.createSelections(false);\r\n    }\r\n\r\n    createSelections(shouldCreateArrays: boolean): void {\r\n        // CREATE SELECTIONS\r\n        if (shouldCreateArrays) {\r\n            if (!('nodeArrays' in this && this.nodeArrays)) {\r\n                this.nodeArrays = new NodeArray();\r\n                this.linkArrays = new LinkArray();\r\n                this.timeArrays = new TimeArray();\r\n                this.nodePairArrays = new NodePairArray();\r\n            }\r\n            this.nodeArrays.selections = new Array(this.nodeArrays.length);\r\n            for (var i = 0; i < this.nodeArrays.selections.length; i++) {\r\n                this.nodeArrays.selections[i] = [];\r\n            }\r\n\r\n            this.linkArrays.selections = new Array(this.linkArrays.length);\r\n            for (var i = 0; i < this.linkArrays.selections.length; i++) {\r\n                this.linkArrays.selections[i] = [];\r\n            }\r\n\r\n            this.timeArrays.selections = new Array(this.timeArrays.length);\r\n            for (var i = 0; i < this.timeArrays.selections.length; i++) {\r\n                this.timeArrays.selections[i] = [];\r\n            }\r\n\r\n            this.nodePairArrays.selections = new Array(this.nodePairArrays.length);\r\n            for (var i = 0; i < this.nodePairArrays.selections.length; i++) {\r\n                this.nodePairArrays.selections[i] = [];\r\n            }\r\n        }\r\n\r\n        // create default selections for each type\r\n        this.defaultNodeSelection = this.createSelection('node');\r\n        this.defaultNodeSelection.name = 'Unselected';\r\n        for (var i = 0; i < this._nodes.length; i++) {\r\n            this.defaultNodeSelection.elementIds.push(i);\r\n            this.addToAttributeArraysSelection(this.defaultNodeSelection, 'node', this._nodes[i].id());\r\n        }\r\n        this.defaultNodeSelection.color = '#000000';\r\n        this.defaultNodeSelection.showColor = false;\r\n        this.defaultNodeSelection.priority = 10000;\r\n        this.selectionColor_pointer--;\r\n\r\n\r\n        this.defaultLinkSelection = this.createSelection('link');\r\n        this.defaultLinkSelection.name = 'Unselected';\r\n        for (var i = 0; i < this._links.length; i++) {\r\n            this.defaultLinkSelection.elementIds.push(i);\r\n            this.addToAttributeArraysSelection(this.defaultLinkSelection, 'link', this._links[i].id());\r\n        }\r\n        this.defaultLinkSelection.color = '#000000';\r\n        this.defaultLinkSelection.showColor = false;\r\n        this.defaultLinkSelection.priority = 10000;\r\n        this.selectionColor_pointer--;\r\n\r\n        // create selections for node types\r\n        var types: string[] = []\r\n        var type, index;\r\n        var selection: Selection;\r\n        var nodeSelections: Selection[] = [];\r\n\r\n        for (var i = 0; i < this.nodeArrays.nodeType.length; i++) {\r\n            type = this.nodeArrays.nodeType[i];\r\n            if (type == undefined || type.length == 0 || type == 'undefined')\r\n                continue;\r\n            index = types.indexOf(type);\r\n            if (index == -1) {\r\n                selection = this.createSelection('node');\r\n                selection.name = type;\r\n                nodeSelections.push(selection)\r\n                types.push(type);\r\n            } else {\r\n                selection = nodeSelections[index];\r\n            }\r\n            this.addElementToSelection(selection, this._nodes[i]);\r\n            // this.addToSelection(selection, this._nodes[i].id(), 'node');\r\n        }\r\n        if (nodeSelections.length == 1) {\r\n            console.log('nodeSelections[0]:', nodeSelections[0])\r\n            nodeSelections[0].color = '#444';\r\n        }\r\n\r\n        // create selections for link type\r\n        types = [];\r\n        var linkSelections: Selection[] = [];\r\n        for (var i = 0; i < this.linkArrays.linkType.length; i++) {\r\n            type = this.linkArrays.linkType[i];\r\n            if (!type || type == 'undefined')\r\n                continue;\r\n            index = types.indexOf(type);\r\n            if (index == -1) {\r\n                selection = this.createSelection('link');\r\n                selection.name = type;\r\n                linkSelections.push(selection)\r\n                types.push(type);\r\n            } else {\r\n                selection = linkSelections[index];\r\n            }\r\n            this.addElementToSelection(selection, this._links[i]);\r\n            // this.addToSelection(selection, this._links[i].id(), 'link');\r\n        }\r\n        if (linkSelections.length == 1)\r\n            linkSelections[0].color = '#444';\r\n\r\n\r\n        // create selections for node type\r\n        // types = [];\r\n        // var nodeSelections: Selection[] = [];\r\n        // for (var i = 0; i < this.nodeArrays.nodeType.length; i++) {\r\n        //     type = this.nodeArrays.nodeType[i];\r\n        //     if (!type || type == 'undefined')\r\n        //         continue;\r\n        //     index = types.indexOf(type);\r\n        //     if (index == -1) {\r\n        //         selection = this.createSelection('node');\r\n        //         selection.name = type;\r\n        //         nodeSelections.push(selection)\r\n        //         types.push(type);\r\n        //     } else {\r\n        //         selection = nodeSelections[index];\r\n        //     }\r\n        //     this.addElementToSelection(selection, this._nodes[i]);\r\n        //     // this.addToSelection(selection, this._links[i].id(), 'link');\r\n        // }\r\n\r\n        this.currentSelection_id = 0;\r\n\r\n    }\r\n\r\n\r\n\r\n    // GRAPH API //////////////////\r\n\r\n    /**\r\n     *\r\n     * Returns a window graph for the passed time point\r\n     * or period\r\n     * @param  {any}    start First time point of this graph\r\n     * @param  {any}    end   Last time point of this graph.\r\n     * @return {[type]}       [description]\r\n     */\r\n    // getGraph(start: Time, end?: Time): WindowGraph {\r\n    //     var g: WindowGraph = new WindowGraph();\r\n    //     return this.createGraph(g, start, end);\r\n    // }\r\n\r\n    // Creates a new graph with all nodes and edges from start to end.\r\n    // CACHEGRAPH : this code needs to be leveraged to initialize all of the fields from\r\n    // windowGraph that are now part of this class\r\n    private createGraphObjects(shouldCreateTimes: boolean, shouldCreateLinkTypes: any): void {\r\n\r\n        // measure time:\r\n        console.log('[DynamicNetwork:createGraph()] >>> ')\r\n        var d = Date.now();\r\n\r\n        // POPULATE WINDOW GRAPH\r\n\r\n        // populate locations\r\n        if (this.locationArrays && 'id' in this.locationArrays) {\r\n            for (var i = 0; i < this.locationArrays.id.length; i++) {\r\n                this._locations.push(new Location(this.locationArrays.id[i], this));\r\n            }\r\n        }\r\n        else {\r\n            this.locationArrays = new LocationArray();\r\n        }\r\n\r\n        // Populate nodes\r\n        var nodes: Node[] = [];\r\n        var locations;\r\n        if ('nodeArrays' in this && this.nodeArrays) {\r\n            for (var i = 0; i < this.nodeArrays.id.length; i++) {\r\n                nodes.push(new Node(i, this));\r\n            }\r\n        }\r\n\r\n        // Populate links\r\n        var links: Link[] = [];\r\n        var link: Link;\r\n        var source: Node, target: Node;\r\n        if ('linkArrays' in this && this.linkArrays) {\r\n            for (var i = 0; i < this.linkArrays.source.length; i++) {\r\n\r\n                link = new Link(i, this);\r\n                links.push(link);\r\n\r\n            }\r\n        }\r\n\r\n        // Populate node pairs\r\n        var s: number, t: number;\r\n        var pairLinks: number[];\r\n        var pair: NodePair;\r\n        var pairLinkId: number;\r\n        var thisGraphNodePairIds: number[] = [];\r\n        if ('nodePairArrays' in this && this.nodePairArrays) {\r\n            for (var i = 0; i < this.nodePairArrays.length; i++) {\r\n                pairLinks = this.nodePairArrays.links[i];\r\n                this._nodePairs.push(new NodePair(i, this));\r\n                // for (var j = 0; j < pairLinks.length; j++) {\r\n                //     pairLinkId = pairLinks[j];\r\n                //     pair = undefined;\r\n                //     for (var k = 0; k < nodePairs.length; k++) {\r\n                //         if (nodePairs[k].id == i) {\r\n                //             pair = nodePairs[k];\r\n                //             break;\r\n                //         }\r\n                //     }\r\n                //     if (!pair) {\r\n                //         pair = new NodePair(i, this);\r\n                //         nodePairs.push(pair)\r\n                //         thisGraphNodePairIds.push(i)\r\n                //         pair.source = nodes[this.pairAttr('source', i)];\r\n                //         pair.target = nodes[this.pairAttr('target', i)];\r\n                //     }\r\n\r\n                //     for (var k = 0; k < links.length; k++) {\r\n                //         if (links[k].id == pairLinkId) {\r\n                //             link = links[k];\r\n                //             break;\r\n                //         }\r\n                //     }\r\n\r\n                //     pair.links.push(link);\r\n                //     link.nodePair = pair;\r\n                // }\r\n            }\r\n        }\r\n\r\n        this._nodes = nodes;\r\n        this._links = links;\r\n        // this.nodePairs = nodePairs;\r\n\r\n        if (shouldCreateTimes) {// && 'timesArrays' in this && this.timeArrays) {\r\n            this._times = [];\r\n            for (var i = 0; i < this.timeArrays.length; i++)\r\n                this._times.push(new Time(i, this));\r\n        }\r\n\r\n        // if (shouldCreateLinkTypes) {\r\n        //     var linkTypeCount: number = this.linkTypeArrays.length;\r\n        //     var colorScale;\r\n        //     if (linkTypeCount <= 10) {\r\n        //         colorScale = d3.scale.category10();\r\n        //     } else {\r\n        //         colorScale = d3.scale.category20();\r\n        //     }\r\n        //     for (var i = 0; i < this.linkTypeArrays.name.length; i++) {\r\n        //         this.linkTypes.push(new LinkType(\r\n        //             this.linkTypeArrays.id[i],\r\n        //             this.linkTypeArrays.name[i],\r\n        //             this.linkTypeArrays.color[i]\r\n        //         ));\r\n        //     }\r\n        // }\r\n\r\n        console.log('[DynamicNetwork:getGraph()] <<< ', Date.now() - d, 'msec')\r\n    }\r\n\r\n    // all attribute accessor method\r\n    nodeAttr(attr: string, id: number): any {\r\n        return this.attr(attr, id, 'node');\r\n    }\r\n    linkAttr(attr: string, id: number): any {\r\n        return this.attr(attr, id, 'link');\r\n    }\r\n    pairAttr(attr: string, id: number): any {\r\n        return this.attr(attr, id, 'nodePair');\r\n    }\r\n    timeAttr(attr: string, id: number): any {\r\n        return this.attr(attr, id, 'time');\r\n    }\r\n\r\n    get startTime(): Time { return this._times[0]; }\r\n    get endTime(): Time { return this._times[this._times.length - 1]; }\r\n\r\n    // /// SELECTIONS\r\n    // // selections store ids of objects only.\r\n\r\n\r\n\r\n    highlight(action: string, idCompound?: IDCompound): void {\r\n\r\n        if (action == 'reset') {\r\n            // reset all\r\n            this.highlightArrays.nodeIds = [];\r\n            this.highlightArrays.linkIds = [];\r\n            this.highlightArrays.nodePairIds = [];\r\n            this.highlightArrays.timeIds = [];\r\n            return;\r\n        }\r\n        if (!idCompound) {\r\n            console.error('[DynamicGraph] highlight: idCompound not set!')\r\n            return;\r\n        }\r\n\r\n        if (action == 'set') {\r\n            this.highlight('reset');\r\n            this.highlight('add', idCompound);\r\n            return;\r\n        }\r\n\r\n\r\n        // if(action == 'add'){\r\n        //     for(var i=0 ; i<elementIds.length ; i++){\r\n        //         if(this.highlightArrays[type].indexOf(elementIds[i]) == -1)\r\n        //             this.highlightArrays[type].push(elementIds[i]);\r\n        //     }\r\n        // }else\r\n        // if(action == 'remove'){\r\n        //     for(var i=0 ; i<elementIds.length ; i++){\r\n        //         if(this.highlightArrays[type].indexOf(elementIds[i]) > -1)\r\n        //              this.highlightArrays[type].splice(this.highlightArrays[type].indexOf(elementIds[i]),1)\r\n        //     }\r\n        // }\r\n        if (action == 'add') {\r\n            for (var type in idCompound) {\r\n                for (var i = 0; i < (idCompound as any)[type].length; i++) {\r\n                    (this.highlightArrays as any)[type].push((idCompound as any)[type][i]);\r\n                }\r\n            }\r\n        } else\r\n            if (action == 'remove') {\r\n                var index: number;\r\n                for (var type in idCompound) {\r\n                    for (var i = 0; i < (idCompound as any)[type].length; i++) {\r\n                        index = (this.highlightArrays as any)[type].indexOf((idCompound as any)[type][i]);\r\n                        if (index >= 0)\r\n                            (this.highlightArrays as any)[type].splice(index, 1);\r\n                    }\r\n                }\r\n            }\r\n    }\r\n\r\n\r\n    // SELECT\r\n    selection(action: string, idCompound: IDCompound, selectionId?: number) {\r\n\r\n        if (selectionId == undefined)\r\n            selectionId = this.currentSelection_id;\r\n\r\n        var selection: any = this.getSelection(selectionId);\r\n        if (!selection) {\r\n            console.error('[DynamicGraph] Selection with ', selectionId, 'not found in ', this.selections);\r\n            return; // WITH RETURN ?\r\n        }\r\n\r\n        var self: DynamicGraph = this;\r\n        if (action == 'set') {\r\n            var c: IDCompound = new IDCompound();\r\n            (c as any)[selection.acceptedType] = selection.elementIds;\r\n            this.selection('remove', c, selectionId);\r\n            this.selection('add', idCompound, selectionId);\r\n        } else if (action == 'add') {\r\n            idCompound.linkIds.forEach((v, i, arr) => self.addToSelectionByTypeAndId(selection, 'link', v));\r\n            idCompound.nodeIds.forEach((v, i, arr) => self.addToSelectionByTypeAndId(selection, 'node', v));\r\n            idCompound.timeIds.forEach((v, i, arr) => self.addToSelectionByTypeAndId(selection, 'time', v));\r\n            idCompound.nodePairIds.forEach((v, i, arr) => self.addToSelectionByTypeAndId(selection, 'nodePair', v));\r\n        } else if (action == 'remove') {\r\n            idCompound.linkIds.forEach((v, i, arr) => self.removeFromSelectionByTypeAndId(selection, 'link', v));\r\n            idCompound.nodeIds.forEach((v, i, arr) => self.removeFromSelectionByTypeAndId(selection, 'node', v));\r\n            idCompound.timeIds.forEach((v, i, arr) => self.removeFromSelectionByTypeAndId(selection, 'time', v));\r\n            idCompound.nodePairIds.forEach((v, i, arr) => self.removeFromSelectionByTypeAndId(selection, 'nodePair', v));\r\n        }\r\n    }\r\n\r\n\r\n\r\n    // SELFIX : delegate to dgraph\r\n    addToAttributeArraysSelection(selection: Selection, type: string, id: number) {\r\n        // check for priority of selections, then add where appropriate\r\n        var elementSelections = (this.attributeArrays as any)[type].selections[id];\r\n        for (var i = 0; i < elementSelections.length; i++) {\r\n            if (elementSelections[i].priority > selection.priority) {\r\n                (this.attributeArrays as any)[type].selections[id].splice(i, 0, selection);\r\n                return;\r\n            }\r\n        }\r\n        // if not already selected and if not higher priority than any other\r\n        // selection, append to the end.\r\n        (this.attributeArrays as any)[type].selections[id].push(selection);\r\n    }\r\n\r\n    // SELFIX : delegate to dgraph\r\n    removeFromAttributeArraysSelection(selection: Selection, type: string, id: number) {\r\n        var arr = (this.attributeArrays as any)[type].selections[id];\r\n        for (var i = 0; i < arr.length; i++) {\r\n            if (arr[i] == selection)\r\n                (this.attributeArrays as any)[type].selections[id].splice(i, 1);\r\n        }\r\n    }\r\n\r\n    addElementToSelection(selection: Selection, e: BasicElement) {\r\n        this.addToSelectionByTypeAndId(selection, e.type, e.id());\r\n    }\r\n\r\n    addToSelectionByTypeAndId(selection: Selection, type: string, id: number) {\r\n        if (type != selection.acceptedType) {\r\n            console.log('attempting to put object of the wrong type into a selection');\r\n            return; // don't proceed with selection;\r\n        }\r\n        selection.elementIds.push(id);\r\n        this.addToAttributeArraysSelection(selection, type, id);\r\n        // =======\r\n        //                 this.selection('add', idCompound, selectionId);\r\n        //             } else {\r\n        //                 if (action == 'add') {\r\n        //                     for (var field in idCompound) {\r\n        //                         for (var i = 0; i < idCompound[field].length; i++) {\r\n        //                             this.addToSelection(selection, idCompound[field][i], field)\r\n        //                         }\r\n        //                     }\r\n        //                 } else {\r\n        //                     if (action == 'remove') {\r\n        //                         for (var field in idCompound) {\r\n        //                             for (var i = 0; i < idCompound[field].length; i++) {\r\n        //                                 for (var j = 0; j < selection.elementIds.length; j++) {\r\n        //                                     if (selection.elementIds[j] == idCompound[field][i].id) {\r\n        //                                         this.removeFromSelection(selection, idCompound[field][i], field);\r\n        //                                     }\r\n        //                                 }\r\n        //                             }\r\n        //                         }\r\n        //                     }\r\n        //                 }\r\n        //             }\r\n        //         }\r\n        //         addToSelection(selection: Selection, id:number, elementType:string) {\r\n        //             selection.elementIds.push(id);\r\n\r\n        //             var e:BasicElement = this.get(elementType, id);\r\n        //             e.addToSelection(selection);\r\n        // >>>>>>> api\r\n        // remove from default selection\r\n        var i;\r\n        if (type == 'node') {\r\n            i = this.defaultNodeSelection.elementIds.indexOf(id);\r\n            if (i > -1) {\r\n                this.removeFromAttributeArraysSelection(this.defaultNodeSelection, type, id);\r\n                this.defaultNodeSelection.elementIds.splice(i, 1);\r\n            }\r\n        } else\r\n            if (type == 'link') {\r\n                i = this.defaultLinkSelection.elementIds.indexOf(id);\r\n                if (i > -1) {\r\n                    this.removeFromAttributeArraysSelection(this.defaultLinkSelection, type, id);\r\n                    this.defaultLinkSelection.elementIds.splice(i, 1);\r\n                }\r\n            }\r\n\r\n    }\r\n    // <<<<<<< HEAD\r\n\r\n    removeElementFromSelection(selection: Selection, e: BasicElement) {\r\n        this.removeFromSelectionByTypeAndId(selection, e.type, e.id());\r\n    }\r\n\r\n    removeFromSelectionByTypeAndId(selection: Selection, type: string, id: number) {\r\n        // selection.elements.push(compound[field][i])\r\n        // e.addToSelection(selection);\r\n        // =======\r\n        //         removeFromSelection(selection: Selection, id:number, elementType:string) {\r\n        // >>>>>>> api\r\n        var i = selection.elementIds.indexOf(id)\r\n        if (i == -1)\r\n            return;\r\n\r\n        selection.elementIds.splice(i, 1);\r\n        // <<<<<<< HEAD\r\n        this.removeFromAttributeArraysSelection(selection, type, id);\r\n        // =======\r\n        //             var e:BasicElement = this.get(elementType, id);\r\n        //             e.removeFromSelection(selection);\r\n        // >>>>>>> api\r\n\r\n        // add to default selection\r\n        if (this.getSelectionsByTypeAndId(type, id).length == 0) {\r\n            if (type == 'node') {\r\n                this.defaultNodeSelection.elementIds.push(id);\r\n                this.addToAttributeArraysSelection(this.defaultNodeSelection, type, id);\r\n            } else\r\n                if (type == 'link') {\r\n                    this.defaultLinkSelection.elementIds.push(id);\r\n                    this.addToAttributeArraysSelection(this.defaultLinkSelection, type, id);\r\n                }\r\n        }\r\n    }\r\n\r\n    getSelectionsByTypeAndId(type: string, id: number): Selection[] {\r\n        return (this.attributeArrays as any)[type].selections[id];\r\n    }\r\n\r\n\r\n    filterSelection(selectionId: number, filter: boolean) {\r\n        var selection: any = this.getSelection(selectionId);\r\n        if (selection != undefined) {\r\n            selection.filter = filter;\r\n        }\r\n    }\r\n\r\n    isFiltered(id: number, type: string): boolean {\r\n        return (this.attributeArrays as any)[type + 's'].filter;\r\n    }\r\n\r\n    isHighlighted(id: number, type: string) {\r\n        return (this.highlightArrays as any)[type + 'Ids'].indexOf(id) > -1;\r\n    }\r\n\r\n    getHighlightedIds(type: string) {\r\n        return (this.highlightArrays as any)[type + 'Ids'];\r\n    }\r\n\r\n\r\n    setCurrentSelection(id: number) {\r\n        // [bbach] why should we ignore them?\r\n        // if (id < 2) // i.e. either default node or link selection..\r\n        //     return;  // ignore\r\n        console.log('[DynamicGraph] setCurrentSelectionId ', id)\r\n        this.currentSelection_id = id;\r\n    }\r\n    getCurrentSelection(): Selection | undefined { // before onoly Selection!\r\n        return this.getSelection(this.currentSelection_id);\r\n    }\r\n\r\n    addSelection(id: number, color: string, acceptedType: string, priority: number) {\r\n        var s: Selection = this.createSelection(acceptedType);\r\n        s.id = id;\r\n        s.color = color;\r\n        s.priority = priority;\r\n    }\r\n\r\n    // creates a selection for the passed type.\r\n    createSelection(type: string): Selection {\r\n        var s = new Selection(this.selections.length, type);\r\n        s.color = this.BOOKMARK_COLORS(this.selectionColor_pointer % 10);\r\n        this.selectionColor_pointer++;\r\n        this.selections.push(s);\r\n        return s;\r\n    }\r\n\r\n    deleteSelection(selectionId: number): void {\r\n        var s = this.getSelection(selectionId);\r\n\r\n        // remove all elements from this selection\r\n        // <<<<<<< HEAD\r\n        //             var compound: ElementCompound = new ElementCompound();\r\n        //             compound[s.acceptedType + 'Ids'] = s.elementIds.slice(0);\r\n        //             this.selection('remove', compound, s.id)\r\n        // =======\r\n\r\n        // remove\r\n        if (s != undefined) {\r\n            var idCompound: IDCompound = new IDCompound();\r\n            (idCompound as any)[s.acceptedType + 'Ids'] = s.elementIds.slice(0);\r\n            console.log('Delete selection->remove elemeents', s.elementIds.slice(0))\r\n            this.selection('remove', idCompound, s.id)\r\n            // >>>>>>> api\r\n\r\n            // delete selection\r\n            this.selections.splice(this.selections.indexOf(s), 1);\r\n        }\r\n    }\r\n\r\n    setSelectionColor(id: number, color: string) {\r\n        var s = this.getSelection(id);\r\n        if (!s) {\r\n            return;\r\n        }\r\n        s.color = color;\r\n    }\r\n    getSelections(type?: string) {\r\n        var selections: Selection[] = [];\r\n        if (type) {\r\n            for (var i = 0; i < this.selections.length; i++) {\r\n                if ((<Selection>this.selections[i]).acceptsType(type))\r\n                    selections.push(this.selections[i])\r\n            }\r\n            return selections;\r\n        } else {\r\n            return this.selections;\r\n        }\r\n    }\r\n    getSelection(id: number): Selection | undefined { // before only Selection return\r\n        for (var i = 0; i < this.selections.length; i++) {\r\n            if (id == this.selections[i].id)\r\n                return this.selections[i];\r\n        }\r\n        console.error('[DynamicGraph] No selection with id ', id, 'found!');\r\n        /* If not found ?? */\r\n        return undefined;\r\n    }\r\n\r\n    clearSelections() {\r\n        this.selections = [];\r\n    }\r\n\r\n\r\n\r\n    // internal utils\r\n    getTimeIdForUnixTime(unixTime: number): number | undefined { // before only number\r\n        var timeId: number;\r\n        console.log(\"unixTime: \")\r\n        console.log(unixTime)\r\n        for (timeId = 0; timeId < this.timeArrays.length; timeId++) {\r\n            if (unixTime == this.timeArrays.unixTime[timeId]) {\r\n                timeId;\r\n                return timeId;\r\n            }\r\n        }\r\n        console.error('Time object for unix time', unixTime, 'not found!')\r\n        return undefined;\r\n    }\r\n\r\n    // ORDERING\r\n    /* adds an specific node order (e.g. alphabetical) */\r\n\r\n\r\n    // go into dynamicgraph\r\n    addNodeOrdering(name: string, order: number[]) {\r\n        for (var i = 0; i < this.nodeOrders.length; i++) {\r\n            if (this.nodeOrders[i].name == name) {\r\n                console.error('Ordering', name, 'already exists');\r\n                return;\r\n            }\r\n        }\r\n        var o = new Ordering(name, order);\r\n        this.nodeOrders.push(o);\r\n    }\r\n    setNodeOrdering(name: string, order: number[]) {\r\n        for (var i = 0; i < this.nodeOrders.length; i++) {\r\n            if (this.nodeOrders[i].name == name) {\r\n                this.nodeOrders[i].order = order;\r\n                return;\r\n            }\r\n        }\r\n        console.error('Ordering', name, 'does not exist');\r\n    }\r\n    removeNodeOrdering(name: string, order: number[]) {\r\n        for (var i = 0; i < this.nodeOrders.length; i++) {\r\n            if (this.nodeOrders[i].name == name) {\r\n                this.nodeOrders.splice(i, 1);\r\n            }\r\n        }\r\n    }\r\n    getNodeOrder(name: string) {\r\n        for (var i = 0; i < this.nodeOrders.length; i++) {\r\n            if (this.nodeOrders[i].name == name) {\r\n                return this.nodeOrders[i];\r\n            }\r\n        }\r\n        console.error('Ordering', name, 'not found!');\r\n        return;\r\n    }\r\n\r\n\r\n    // returns elements\r\n    nodes(): NodeQuery {\r\n        return new NodeQuery(this.nodeArrays.id, this);\r\n    }\r\n    links(): LinkQuery {\r\n        return new LinkQuery(this.linkArrays.id, this);\r\n    }\r\n    times(): TimeQuery {\r\n        return new TimeQuery(this.timeArrays.id, this);\r\n    }\r\n    locations(): LocationQuery {\r\n        return new LocationQuery(this.locationArrays.id, this);\r\n    }\r\n    nodePairs(): NodePairQuery {\r\n        return new NodePairQuery(this.nodePairArrays.id, this);\r\n    }\r\n\r\n\r\n    linksBetween(n1: Node, n2: Node): LinkQuery {\r\n        var nodePairId = this.matrix[n1.id()][n2.id()];\r\n        if (nodePairId == undefined)\r\n            nodePairId = this.matrix[n2.id()][n1.id()];\r\n        if (nodePairId == undefined)\r\n            return new LinkQuery([], this);\r\n\r\n        /* UNDEFINED? */\r\n        var node_pair: any = this.nodePair(nodePairId);\r\n        if (node_pair != undefined)\r\n            return new LinkQuery(node_pair.links().toArray(), this);\r\n        else\r\n            return new LinkQuery([], this);\r\n    }\r\n\r\n\r\n    // generic accessor method. should not be used externally\r\n    get(type: string, id: number): BasicElement | undefined {\r\n        if (type.indexOf('nodePair') > -1)\r\n            return this.nodePair(id);\r\n        if (type.indexOf('node') > -1)\r\n            return this.node(id);\r\n        if (type.indexOf('link') > -1)\r\n            return this.link(id);\r\n        if (type.indexOf('time') > -1)\r\n            return this.time(id);\r\n        if (type.indexOf('locations') > -1)\r\n            return this.location(id);\r\n    }\r\n\r\n    getAll(type: string): GraphElementQuery {\r\n        if (type == 'nodes')\r\n            return this.nodes();\r\n        if (type == 'links')\r\n            return this.links();\r\n        if (type == 'times')\r\n            return this.times();\r\n        if (type == 'nodePairs')\r\n            return this.nodePairs();\r\n        // if (type == 'locations')\r\n        return this.locations();\r\n    }\r\n\r\n    // returns the node with ID\r\n    node(id: number) {\r\n        for (var i = 0; i < this._nodes.length; i++) {\r\n            if (this._nodes[i].id() == id)\r\n                return this._nodes[i];\r\n        }\r\n    }\r\n\r\n    link(id: number) {\r\n        for (var i = 0; i < this._links.length; i++) {\r\n            if (this._links[i].id() == id)\r\n                return this._links[i];\r\n        }\r\n    }\r\n    time(id: number) {\r\n        for (var i = 0; i < this._times.length; i++) {\r\n            if (this._times[i].id() == id)\r\n                return this._times[i];\r\n        }\r\n    }\r\n    location(id: number) {\r\n        for (var i = 0; i < this._locations.length; i++) {\r\n            if (this._locations[i].id() == id)\r\n                return this._locations[i];\r\n        }\r\n    }\r\n    nodePair(id: number) {\r\n        for (var i = 0; i < this._nodePairs.length; i++) {\r\n            if (this._nodePairs[i].id() == id)\r\n                return this._nodePairs[i];\r\n        }\r\n    }\r\n\r\n    getMinGranularity(): number { return this.gran_min; }\r\n    getMaxGranularity(): number { return this.gran_max; }\r\n}\r\n\r\n// A time series with one scalar value for every time point\r\n\r\nexport class AttributeArray {\r\n    id: number[] = [];\r\n    get length(): number {\r\n        return this.id.length;\r\n    }\r\n}\r\n\r\nexport class NodeArray extends AttributeArray {\r\n    id: number[] = [];\r\n    label: string[] = [];\r\n    // nodeType: ScalarTimeSeries<string>[] = [];\r\n    outLinks: ArrayTimeSeries<number>[] = [];  // contains link ids only, since every GRAPH has its own EDGE object instance\r\n    inLinks: ArrayTimeSeries<number>[] = [];    // contains link ids only, since every GRAPH has its own EDGE object instance\r\n    links: ArrayTimeSeries<number>[] = [];\r\n    outNeighbors: ArrayTimeSeries<number>[] = [];   // contains node ids only, since every GRAPH has its own NODE object instance\r\n    inNeighbors: ArrayTimeSeries<number>[] = [];   // contains node ids only, since every GRAPH has its own NODE object instance\r\n    neighbors: ArrayTimeSeries<number>[] = [];\r\n    selections: Selection[][] = [];\r\n    attributes: Object[] = []; // arbitrary attributes (key -> value)\r\n    locations: ScalarTimeSeries<number>[] = []\r\n    filter: boolean[] = [];\r\n    nodeType: string[] = [];\r\n    color: string[] = [];\r\n    shape: string[] = [];\r\n}\r\n\r\nexport class LinkArray extends AttributeArray {\r\n    source: number[] = [];\r\n    target: number[] = [];\r\n    linkType: string[] = [];\r\n    directed: boolean[] = [];\r\n    nodePair: any[] = []; // before number but it don't accept undefined\r\n    // array of all time ids (temporally ordered) when this link is present\r\n    presence: number[][] = [];\r\n    // array of weights per time this link is present. This is a generic field\r\n    // that can be used for weights, e.g.\r\n    weights: ScalarTimeSeries<any>[] = [];\r\n    selections: Selection[][] = [];\r\n    filter: boolean[] = [];\r\n    attributes: Object = new Object; // arbitrary attributes (key -> value)\r\n}\r\n\r\nexport class NodePairArray extends AttributeArray {\r\n    source: number[] = [];\r\n    target: number[] = [];\r\n    links: number[][] = [];\r\n    selections: Selection[][] = [];\r\n    filter: boolean[] = [];\r\n}\r\n\r\nexport class TimeArray extends AttributeArray {\r\n    id: number[] = [];\r\n    momentTime: moment.Moment[] = [];         // moment object\r\n    label: string[] = []\r\n    unixTime: number[] = [];         // unix time object\r\n    selections: Selection[][] = [];\r\n    filter: boolean[] = [];\r\n    links: number[][] = []; // all links at that time\r\n}\r\n\r\nexport class LinkTypeArray extends AttributeArray {\r\n    name: string[] = [];\r\n    count: string[] = [];\r\n    color: string[] = [];\r\n    filter: boolean[] = [];\r\n}\r\n\r\nexport class NodeTypeArray extends AttributeArray {\r\n    name: string[] = [];\r\n    count: string[] = [];\r\n    color: string[] = [];\r\n    filter: boolean[] = [];\r\n}\r\n\r\nexport class LocationArray extends AttributeArray {\r\n    id: number[] = [];\r\n    label: string[] = [];\r\n    longitude: number[] = [];\r\n    latitude: number[] = [];\r\n    x: number[] = [];\r\n    y: number[] = [];\r\n    z: number[] = [];\r\n    radius: number[] = [];\r\n}\r\n\r\nexport class NodeType implements LegendElement {\r\n    id: number;\r\n    name: string;\r\n    color: string;\r\n    constructor(id: number, name: string, color: string) {\r\n        this.id = id;\r\n        this.name = name;\r\n        this.color = color;\r\n    }\r\n}\r\n\r\nexport class Ordering {\r\n    name: string;\r\n    order: number[] = [];\r\n    constructor(name: string, order: number[]) {\r\n        this.name = name;\r\n        this.order = order;\r\n    }\r\n}\r\n\r\n/* MOVED FROM QUERIES TO DYNAMICGRAPH */\r\n\r\n//// QUERIES\r\n\r\nexport class Query {\r\n    _elements: number[] = [];\r\n\r\n    constructor(elements?: number[]) {\r\n        if (elements) {\r\n            for (var i = 0; i < elements.length; i++) {\r\n                if (elements[i] != undefined)\r\n                    this._elements.push(elements[i]);\r\n            }\r\n        }\r\n    }\r\n    // contains(element: number): boolean {\r\n    //     return this._elements.indexOf(element) > -1;\r\n    // }\r\n\r\n    addUnique(element: number): void {\r\n        if (this._elements.indexOf(element) == -1)\r\n            this._elements.push(element);\r\n    }\r\n    add(element: number): void {\r\n        this._elements.push(element);\r\n    }\r\n    addAll(elements: number[]): void {\r\n        for (var i = 0; i < elements.length; i++) {\r\n            if (elements[i] != undefined)\r\n                this._elements.push(elements[i]);\r\n        }\r\n    }\r\n    addAllUnique(elements: number[]): void {\r\n        for (var i = 0; i < elements.length; i++) {\r\n            this.addUnique(elements[i]);\r\n        }\r\n    }\r\n\r\n    /** @returns numbr of elements in this query. Same as size(). */\r\n    get length(): number {\r\n        return this._elements.length\r\n    };\r\n\r\n    /** @returns numbr of elements in this query. Same as length getter. */\r\n    size(): number { return this._elements.length };\r\n\r\n    /** @returns all ids in this query. */\r\n    ids(): number[] {\r\n        return this._elements;\r\n    }\r\n    removeDuplicates(): Query {\r\n        var elements = this._elements.slice(0)\r\n        this._elements = [];\r\n        for (var i = 0; i < elements.length; i++) {\r\n            if (this._elements.indexOf(elements[i]) == -1)\r\n                this._elements.push(elements[i])\r\n        }\r\n        return this;\r\n    }\r\n    generic_intersection(q: Query): Query {\r\n        var intersection = [];\r\n        for (var i = 0; i < this._elements.length; i++) {\r\n            for (var j = 0; j < q._elements.length; j++) {\r\n                if (this._elements[i] == q._elements[j]) {\r\n                    intersection.push(this._elements[i])\r\n                }\r\n            }\r\n        }\r\n        return new Query(intersection);\r\n    }\r\n\r\n\r\n}\r\n\r\nexport class GraphElementQuery extends Query {\r\n    g: DynamicGraph;\r\n    elementType: string;\r\n\r\n    constructor(elements: any[], g: DynamicGraph, elementType: string) {\r\n        super(elements);\r\n        this.g = g;\r\n        this.elementType = elementType;\r\n    }\r\n\r\n    /** @returns a query that contains only the elements matching\r\n     * the filter critera;\r\n     * @param attribute - name of attribute that is used on filter\r\n     * @param filter - function evaluating if the attribute's value is valid.\r\n      */\r\n    generic_filter(filter: Function): any[] {\r\n        var arr: any[] = [];\r\n        for (var i = 0; i < this._elements.length; i++) {\r\n            try {\r\n                if (filter(this.g.get(this.elementType, this._elements[i]))) {\r\n                    arr.push(this._elements[i])\r\n                }\r\n            } catch (ex) {\r\n            }\r\n        }\r\n        return arr;\r\n    }\r\n    /** @returns a query with selected elements, i.e. elements that are in at least\r\n     * one selection.\r\n     */\r\n    generic_selected(): any[] {\r\n        var arr: any[] = [];\r\n        for (var i = 0; i < this._elements.length; i++) {\r\n            var element = this.g.get(this.elementType, this._elements[i]);\r\n            if (element != undefined && element.isSelected()) {\r\n                arr.push(this._elements[i])\r\n            }\r\n        }\r\n        return arr;\r\n    }\r\n    /** @returns a query with visible elements.\r\n     */\r\n    generic_visible(): any[] {\r\n        var arr: any[] = [];\r\n        for (var i = 0; i < this._elements.length; i++) {\r\n            var element = this.g.get(this.elementType, this._elements[i]);\r\n            if (element != undefined && element.isVisible()) {\r\n                arr.push(this._elements[i])\r\n            }\r\n        }\r\n        return arr;\r\n    }\r\n    /** @returns a query with highighted elements.\r\n     */\r\n    generic_highlighted(): any[] {\r\n        var arr: any[] = [];\r\n        for (var i = 0; i < this._elements.length; i++) {\r\n            var element = this.g.get(this.elementType, this._elements[i]);\r\n            if (element != undefined && element.isHighlighted()) {\r\n                arr.push(this._elements[i]);\r\n            }\r\n        }\r\n        return arr;\r\n    }\r\n    /** @returns a query with only the elements present in the specified time step\r\n     * or period.\r\n     */\r\n    generic_presentIn(start: Time, end?: Time): any[] {\r\n        var arr: any[] = [];\r\n        for (var i = 0; i < this._elements.length; i++) {\r\n            var element = this.g.get(this.elementType, this._elements[i]);\r\n            if (element != undefined && element.presentIn(start, end)) {\r\n                arr.push(this._elements[i]);\r\n            }\r\n        }\r\n        return arr;\r\n    }\r\n    /** @returns this query with elements sorted */\r\n    generic_sort(attrName: string, asc?: boolean): GraphElementQuery {\r\n        if (this._elements.length == 0) {\r\n            return this;\r\n        }\r\n        var array = this._elements.slice(0);\r\n\r\n        // ITS POSSIBLE AN UNDEFINED VALUE??\r\n        array.sort((e1, e2) => {\r\n            var e1_get = this.g.get(this.elementType, e1);\r\n            var e2_get = this.g.get(this.elementType, e2);\r\n            if (e1_get != undefined && e2_get != undefined) {\r\n                return attributeSort(\r\n                    e1_get,\r\n                    e2_get,\r\n                    attrName,\r\n                    asc);\r\n            }\r\n            else if (e1_get == undefined && e2_get == undefined) {\r\n                return 0;\r\n            }\r\n            return e1_get == undefined ? 1 : -1;\r\n        });\r\n        this._elements = array;\r\n        return this;\r\n    }\r\n    generic_removeDuplicates(): GraphElementQuery {\r\n        var uniqueElements = [];\r\n        for (var i = 0; i < this._elements.length; i++) {\r\n            // for(var j=i+1 ; j <this._elements.length ; j++){\r\n            //     if(this._elements[i]==this._elements[j])\r\n            //         this._elements.slice(j,1);\r\n            // }\r\n            if (uniqueElements.indexOf(this._elements[i]) == -1)\r\n                uniqueElements.push(this._elements[i])\r\n        }\r\n        this._elements = uniqueElements;\r\n        return this;\r\n    }\r\n\r\n\r\n    // sortByFunction(sortFunction:(a:any,b:any)=>number){\r\n    //     if(this._elements.length == 0){\r\n    //         console.error('This query has no elements')\r\n    //         return new Query<any>();\r\n    //     }\r\n    //     var array = this._elements.slice(0);\r\n    //     array.sort(sortFunction);\r\n    //     var result:GraphElementQuery<T> = new GraphElementQuery<T>();\r\n    //     for(var i=0 ; i<array.length ; i++){\r\n    //         result.add(array[i]);\r\n    //     }\r\n    //     return result;\r\n    // }\r\n}\r\n\r\n/** Basic class for every object in networkcube with an ID.\r\n * A BasicElement is a wrapper to the DynamicGraph and that\r\n * represents any object, i.e. node, link, node pair, time, location.\r\n*/\r\n\r\nexport class BasicElement {\r\n    _id: number;\r\n    type: string;\r\n    g: DynamicGraph;\r\n\r\n    // CONSTRUCTOR\r\n\r\n    constructor(id: number, type: string, dynamicGraph: DynamicGraph) {\r\n        this._id = id;\r\n        this.type = type;\r\n        this.g = dynamicGraph;\r\n    }\r\n\r\n\r\n    // GETTER\r\n\r\n    /** @returns the object's id */\r\n    id(): number {\r\n        return this._id;\r\n    }\r\n\r\n    /** Generic method to return an attribute value for this element\r\n     * @param attr: attribute name on this object.\r\n     * @returns the attribute's value. */\r\n    attr(attr: string): any {\r\n        return this.g.attr(attr, this._id, this.type);\r\n    }\r\n\r\n\r\n\r\n    // SELECTIONS\r\n\r\n    /** @returns all selections this object is part of. */\r\n    getSelections(): Selection[] {\r\n        return (this.g.attributeArrays as any)[this.type].selections[this._id];\r\n    }\r\n\r\n    /** Adds this object to a selection\r\n     * @param selection - the Selection object\r\n     */\r\n    addToSelection(b: Selection): void {\r\n        (this.g.attributeArrays as any)[this.type].selections[this._id].push(b);\r\n    }\r\n\r\n    /** Removes this object from a selection.\r\n     * @param selection - the Selection objects\r\n     */\r\n    removeFromSelection(b: Selection): void {\r\n        var arr: Selection[] = (this.g.attributeArrays as any)[this.type].selections[this._id];\r\n        for (var i = 0; i < arr.length; i++) {\r\n            if (arr[i] == b)\r\n                (this.g.attributeArrays as any)[this.type].selections[this._id].splice(i, 1);\r\n        }\r\n    }\r\n\r\n    inSelection(s: Selection): boolean {\r\n        return this.getSelections().indexOf(s) > -1;\r\n    }\r\n\r\n\r\n    // DISPLAY STATES\r\n\r\n    /** @returns true if this object is selected.\r\n     * @param selection - (optional) if specified returns true if this object\r\n     * is in the passed selection.\r\n     */\r\n    isSelected(selection?: Selection): boolean {\r\n        if (!selection)\r\n            return this.getSelections().length > 0;\r\n\r\n        var selections = (this.g.attributeArrays as any)[this.type].selections[this._id];\r\n        for (var i = 0; i < selections.length; i++) { // start with 1 to avoid default selection.\r\n            if (selections[i] == this.g.defaultNodeSelection || selections[i] == this.g.defaultLinkSelection) {\r\n                continue;\r\n            }\r\n            if (selections[i] == selection)\r\n                return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /** @returns true if this object is highlighted */\r\n    isHighlighted(): boolean {\r\n        return this.g.isHighlighted(this._id, this.type);\r\n    }\r\n\r\n    /** @returns true if this object is filtered, i.e. removed from display. */\r\n    isFiltered(): boolean {\r\n        return this.g.isFiltered(this._id, this.type);\r\n    }\r\n\r\n    /** @returns true if this object is visible. */\r\n    isVisible(): boolean {\r\n        var selections = this.getSelections();\r\n        if (selections.length == 0)\r\n            return true;\r\n        for (var i = 0; i < selections.length; i++) {\r\n            if (selections[i].filter)\r\n                return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n\r\n    // OTHER QUERIES\r\n\r\n    /** @returns true if this object is present in the graph\r\n     * in a specific time or a time period.\r\n     * @param start -  start time. If only this parameter is passed to the\r\n     * function, method returns if this object is present in this time step.\r\n     * @param end - end time. If this parameter is specified, returns if this\r\n     * object is present between start and end.\r\n     */\r\n    presentIn(start: Time, end?: Time): boolean {\r\n        var presence: number[] = this.attr('presence');\r\n        if (!end)\r\n            end = start;\r\n        for (var i = start._id; i <= end._id; i++) {\r\n            if (presence.indexOf(i) > -1)\r\n                return true;\r\n        }\r\n        return false;\r\n    }\r\n}\r\n\r\n/** A time series with a scalar value per time step.\r\n * This class nestes an object that holds information for time\r\n * steps in the format key->value. I.e. the value for the\r\n * time step with ID 3 is accessed by this.3   */\r\nexport class ScalarTimeSeries<T>{\r\n    private serie: any = {};\r\n\r\n    /** @returns a ScalarTimeSeries for the specified period. */\r\n    period(t1: Time, t2: Time): ScalarTimeSeries<T> {\r\n        var t1id = t1.id();\r\n        var t2id = t2.id();\r\n        var s = new ScalarTimeSeries<T>();\r\n        for (var prop in this.serie) {\r\n            if (parseInt(prop) >= t1id\r\n                && parseInt(prop) <= t2id) {\r\n                s.serie[prop] = this.serie[prop];\r\n            }\r\n        }\r\n        return s;\r\n    }\r\n\r\n    /** Sets a value for a specified time point. */\r\n    set(t: Time, element: T) {\r\n        this.serie[t.id()] = element\r\n    }\r\n    /** @returns the value for a specified time point. */\r\n    get(t: Time): any { // before T!!\r\n        if (this.serie[t.id()] == undefined)\r\n            return ; // this is avoid!!\r\n        return this.serie[t.id()];\r\n    }\r\n\r\n    size(): number {\r\n        return this.toArray().length;\r\n    }\r\n\r\n    getSerie(): Object[]{\r\n        return this.serie;\r\n    }\r\n\r\n    /** Returns all values as array.\r\n     * @param removeDuplicates\r\n     * @returns array with values;\r\n     */\r\n    toArray(removeDuplicates?: boolean): T[] {\r\n        if (removeDuplicates == undefined)\r\n            removeDuplicates = false;\r\n        var a: T[] = [];\r\n        if (removeDuplicates) {\r\n            for (var prop in this.serie) {\r\n                a.push(this.serie[prop])\r\n            }\r\n        } else {\r\n            for (var prop in this.serie) {\r\n                if (a.indexOf(this.serie[prop]) == -1)\r\n                    a.push(this.serie[prop])\r\n            }\r\n        }\r\n        return a;\r\n    }\r\n}\r\n\r\n\r\n/** A time series with an array per time step.\r\n* This class nestes an object that holds information for time\r\n* steps in the format key->value. I.e. the value for the\r\n* time step with ID 3 is accessed by this.3   */\r\nexport class ArrayTimeSeries<T>{\r\n    serie: Object = {};\r\n\r\n    period(t1: Time, t2: Time): ArrayTimeSeries<T> {\r\n        var t1id = t1.id();\r\n        var t2id = t1.id();\r\n        var s = new ArrayTimeSeries<T>();\r\n        for (var prop in this.serie) {\r\n            if (parseInt(prop) >= t1id\r\n                && parseInt(prop) <= t1id) {\r\n                (s.serie as any)[prop] = (this.serie as any)[prop];\r\n            }\r\n        }\r\n        return s;\r\n    }\r\n\r\n    add(t: Time, element: T) {\r\n        if (t == undefined) {\r\n            return;\r\n        }\r\n\r\n        if (!(this.serie as any)[t._id])\r\n            (this.serie as any)[t._id] = [];\r\n        (this.serie as any)[t._id].push(element);\r\n    }\r\n    get(t: Time): T[] {\r\n        return (this.serie as any)[t._id];\r\n    }\r\n\r\n    toArray(): T[][] {\r\n        var a: T[][] = [];\r\n        for (var prop in this.serie) {\r\n            a.push((this.serie as any)[prop]);\r\n        }\r\n        return a;\r\n    }\r\n\r\n    toFlatArray(removeDuplicates?: boolean): T[] {\r\n        if (removeDuplicates == undefined)\r\n            removeDuplicates = false;\r\n        var a: T[] = [];\r\n        for (var prop in this.serie) {\r\n            for (var i = 0; i < (this.serie as any)[prop].length; i++) {\r\n                if (!removeDuplicates || (removeDuplicates && a.indexOf((this.serie as any)[prop]) == -1)) {\r\n                    a.push((this.serie as any)[prop][i]);\r\n                }\r\n            }\r\n        }\r\n        return a;\r\n    }\r\n\r\n}\r\n\r\nexport class TimeQuery extends GraphElementQuery {\r\n    //elementType = 'time';\r\n\r\n    constructor(elements: any[], g: DynamicGraph) {\r\n        super(elements, g, 'time');\r\n        //this.elementType = 'time';\r\n        if (elements.length > 0 && elements[0] instanceof Time) {\r\n            this._elements = []\r\n            for (var i = 0; i < elements.length; i++) {\r\n                this._elements.push(elements[i].id());\r\n            }\r\n        }\r\n        if (elements.length > 0 && typeof elements[0] == 'number') {\r\n            this._elements = []\r\n            for (var i = 0; i < elements.length; i++) {\r\n                this._elements.push(elements[i]);\r\n            }\r\n        }\r\n    }\r\n\r\n    contains(t: Time): boolean {\r\n        return this._elements.indexOf(t.id()) > -1;\r\n    }\r\n\r\n    highlighted(): TimeQuery {\r\n        return new TimeQuery(super.generic_highlighted(), this.g);\r\n    }\r\n    visible(): TimeQuery {\r\n        return new TimeQuery(super.generic_visible(), this.g);\r\n    }\r\n    selected(): TimeQuery {\r\n        return new TimeQuery(super.generic_selected(), this.g);\r\n    }\r\n    filter(filter: Function): TimeQuery {\r\n        return new TimeQuery(super.generic_filter(filter), this.g);\r\n    }\r\n    presentIn(t1: Time, t2: Time): TimeQuery {\r\n        return new TimeQuery(super.generic_presentIn(t1, t2), this.g);\r\n    }\r\n    sort(attributeName: string): TimeQuery {\r\n        return <TimeQuery>super.generic_sort(attributeName);\r\n    }\r\n\r\n    links(): LinkQuery {\r\n        var links: number[] = [];\r\n        // var allLinks = this.g.links().toArray();\r\n        // var allTimes = this.g.times().toArray();\r\n        // for(var i=0 ; i<allLinks.length ; i++){\r\n        // for(var j=0 ; j<allTimes.length ; j++){\r\n        //     if(allLinks[i].presentIn(allTimes[j])){\r\n        //         links.push(allLinks[i].id());\r\n        //         break\r\n        //     }\r\n        // }\r\n        // }\r\n        for (var i = 0; i < this._elements.length; i++) {\r\n            links = links.concat(this.g.attr('links', this._elements[i], 'time'));\r\n        }\r\n        return new LinkQuery(links, this.g);\r\n    }\r\n\r\n    // returns the i-th element in this query\r\n    get(i: number): Time { return this.g._times[this._elements[i]] }\r\n\r\n    last(): Time { return this.g._times[this._elements[this._elements.length - 1]] }\r\n\r\n    // return array of times\r\n    toArray(): Time[] {\r\n        var a: Time[] = [];\r\n        var allTimes = this.g._times;\r\n        for (var i = 0; i < this._elements.length; i++) {\r\n            a.push(allTimes[this._elements[i]]);\r\n        }\r\n        return a;\r\n    }\r\n    createAttribute(attrName: string, f: Function): TimeQuery {\r\n        // create and init new attribute array if necessary\r\n        if ((this.g.timeArrays as any)[attrName] == undefined) {\r\n            (this.g.timeArrays as any)[attrName] = []\r\n            for (var i = 0; i < this.g._times.length; i++) {\r\n                (this.g.timeArrays as any)[attrName].push();\r\n            }\r\n        }\r\n        for (var i = 0; i < this._elements.length; i++) {\r\n            (this.g.timeArrays as any)[attrName][this._elements[i]] = f(this.g._times[this._elements[i]]);\r\n        }\r\n        return this;\r\n    }\r\n    unixTimes(): number[] {\r\n        var unixTimes: number[] = [];\r\n        for (var i = 0; i < this._elements.length; i++) {\r\n            var time = this.g.time(this._elements[i]); // UNDEFINED ??\r\n            if (time != undefined) {\r\n                unixTimes.push(time.unixTime());\r\n            }\r\n        }\r\n        return unixTimes;\r\n    }\r\n\r\n    intersection(q: TimeQuery): TimeQuery {\r\n        return new TimeQuery(this.generic_intersection(q)._elements, this.g);\r\n    }\r\n    forEach(f: Function): TimeQuery {\r\n        for (var i = 0; i < this._elements.length; i++) {\r\n            f(this.g.time(this._elements[i]), i);\r\n        }\r\n        return this;\r\n    }\r\n\r\n\r\n}\r\n\r\n\r\n/**\r\n* Represents a Time object\r\n*/\r\nexport class Time extends BasicElement {\r\n\r\n    constructor(id: number, dynamicGraph: DynamicGraph) {\r\n        super(id, 'time', dynamicGraph)\r\n    }\r\n\r\n    // SPECIFIC ATTRIBUTE QUERIES\r\n\r\n    /** @returns the moment object associated to this time object. */\r\n    time(): moment.Moment { return this.attr('momentTime'); }\r\n    moment(): moment.Moment { return this.attr('momentTime'); }\r\n\r\n    label(): String { return this.attr('label') }\r\n\r\n    /** @returns the unix time for this time object. */\r\n    unixTime(): number { return this.attr('unixTime'); }\r\n\r\n    /** @returns a string label for this object. */\r\n    // label(): String { return this.attr('label') + ''; }\r\n\r\n    links(): LinkQuery {\r\n        // var links:number[] = [];\r\n        // for(var i=0 ; i<allLinks.length ; i++){\r\n        //     if(allLinks[i].presentIn(this))\r\n        //         links.push(allLinks[i].id());\r\n        // }\r\n        return new LinkQuery(this.attr('links'), this.g);\r\n    }\r\n\r\n    // wrapper to moment.js\r\n    year() { return this.time().year(); }\r\n    month() { return this.time().month(); }\r\n    week() { return this.time().week(); }\r\n    day() { return this.time().day(); }\r\n    hour() { return this.time().hour(); }\r\n    minute() { return this.time().minute(); }\r\n    second() { return this.time().second(); }\r\n    millisecond() { return this.time().millisecond(); }\r\n\r\n    format(format: string): string {\r\n        return this.time().format(format)\r\n    }\r\n}\r\n\r\nexport class LocationQuery extends GraphElementQuery {\r\n    // elementType = 'location';\r\n\r\n    constructor(elements: any[], g: DynamicGraph) {\r\n        super(elements, g, 'location');\r\n        // this.elementType = 'location';\r\n        if (elements.length > 0 && elements[0] instanceof Location) {\r\n            this._elements = []\r\n            for (var i = 0; i < elements.length; i++) {\r\n                this._elements = elements[i].id();\r\n            }\r\n        }\r\n        if (elements.length > 0 && typeof elements[0] == 'number') {\r\n            this._elements = []\r\n            for (var i = 0; i < elements.length; i++) {\r\n                this._elements.push(elements[i]);\r\n            }\r\n        }\r\n    }\r\n\r\n    contains(l: Location): boolean {\r\n        return this._elements.indexOf(l.id()) > -1;\r\n    }\r\n\r\n    highlighted(): LocationQuery {\r\n        return new LocationQuery(super.generic_highlighted(), this.g);\r\n    }\r\n    visible(): LocationQuery {\r\n        return new LocationQuery(super.generic_visible(), this.g);\r\n    }\r\n    selected(): LocationQuery {\r\n        return new LocationQuery(super.generic_selected(), this.g);\r\n    }\r\n    filter(filter: Function): LocationQuery {\r\n        return new LocationQuery(super.generic_filter(filter), this.g);\r\n    }\r\n    presentIn(t1: Time, t2: Time): LocationQuery {\r\n        return new LocationQuery(super.generic_presentIn(t1, t2), this.g);\r\n    }\r\n    sort(attributeName: string): LocationQuery {\r\n        return <LocationQuery>super.generic_sort(attributeName);\r\n    }\r\n\r\n    // returns the i-th element in this query\r\n    get(i: number): Location { return this.g._locations[this._elements[i]] }\r\n\r\n    last(): Location { return this.g._locations[this._elements[this._elements.length - 1]] }\r\n\r\n    // return array of locations\r\n    toArray(): Location[] {\r\n        var a: Location[] = [];\r\n        for (var i = 0; i < this._elements.length; i++) {\r\n            a.push(this.g._locations[this._elements[i]]);\r\n        }\r\n        return a;\r\n    }\r\n    createAttribute(attrName: string, f: Function): LocationQuery {\r\n        // create and init new attribute array if necessary\r\n        if ((this.g.locationArrays as any)[attrName] == undefined) {\r\n            (this.g.locationArrays as any)[attrName] = []\r\n            for (var i = 0; i < this.g._locations.length; i++) {\r\n                (this.g.locationArrays as any)[attrName].push();\r\n            }\r\n        }\r\n        for (var i = 0; i < this._elements.length; i++) {\r\n            (this.g.locationArrays as any)[attrName][this._elements[i]] = f(this.g._locations[this._elements[i]]);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    intersection(q: LocationQuery): LocationQuery {\r\n        return new LocationQuery(this.generic_intersection(q)._elements, this.g);\r\n    }\r\n    removeDuplicates(): LocationQuery {\r\n        return new LocationQuery(this.generic_removeDuplicates()._elements, this.g);\r\n    }\r\n    forEach(f: Function): LocationQuery {\r\n        for (var i = 0; i < this._elements.length; i++) {\r\n            f(this.g.location(this._elements[i]), i);\r\n        }\r\n        return this;\r\n    }\r\n\r\n}\r\n\r\n/**\r\n * Represents a simple array of numbers that can be used to calculate\r\n * max, mean, min values etc..\r\n */\r\nexport class NumberQuery extends Query {\r\n\r\n\r\n    clone(): number[] {\r\n        return this._elements.slice(0);\r\n    }\r\n\r\n    min(): number {\r\n        this._elements = this.makeNumbers(this._elements);\r\n        var min: number = parseInt(this._elements[0]+'');\r\n        for (var i = 1; i < this._elements.length; i++) {\r\n            if (this._elements[i] != undefined)\r\n                min = Math.min(min, parseInt(this._elements[i]+''));\r\n        }\r\n        return min;\r\n    }\r\n    max(): number {\r\n        var max: number = parseInt(this._elements[0]+'');\r\n        for (var i = 1; i < this._elements.length; i++) {\r\n            if (this._elements[i] != undefined)\r\n                max = Math.max(max,  parseInt(this._elements[i]+''));\r\n        }\r\n        return max;\r\n    }\r\n    mean(): number {\r\n        this._elements = this.makeNumbers(this._elements);\r\n        var v = 0;\r\n        var count = 0;\r\n        for (var i = 0; i < this._elements.length; i++) {\r\n            if (typeof this._elements[i] == 'number') {\r\n                v += parseInt(this._elements[i]+'');\r\n                count++;\r\n            }\r\n        }\r\n        return v / count;\r\n    }\r\n    sum() {\r\n        var sum = 0;\r\n        for (var i = 0; i < this._elements.length; i++) {\r\n            if (typeof this._elements[i] == 'number') {\r\n                sum += parseInt(this._elements[i]+'');\r\n            }\r\n        }\r\n        return sum;\r\n    }\r\n\r\n    toArray(): number[] {\r\n        return this._elements.slice(0);\r\n    }\r\n\r\n    get(index: number): number {\r\n        return this._elements[index];\r\n    }\r\n\r\n    forEach(f: Function): NumberQuery {\r\n        for (var i = 0; i < this._elements.length; i++) {\r\n            f(this._elements[i], i);\r\n        }\r\n        return this;\r\n    }\r\n    \r\n    makeNumbers(elements:number[]): number[] \r\n    {\r\n        if(elements && elements.length > 0){\r\n            var first = elements[0]\r\n            if(typeof first == 'string'){\r\n                var numberElements:number[] = []\r\n                for (var i = 0; i < elements.length; i++){\r\n                    numberElements.push(parseFloat(elements[i]+''))\r\n                }\r\n                console.log('string array converted', numberElements)\r\n                return numberElements;\r\n            }\r\n        }\r\n\r\n        return elements;\r\n    }\r\n\r\n}\r\n\r\n\r\nexport class Location extends BasicElement {\r\n\r\n    constructor(id: number, graph: DynamicGraph) {\r\n        super(id, 'location', graph)\r\n    }\r\n\r\n    // SPECIFIC ATTRIBUTE QUERIES\r\n\r\n    label(): String { return this.attr('label') + ''; }\r\n    longitude(): number { return this.attr('longitude'); }\r\n    latitude(): number { return this.attr('latitude'); }\r\n    x(): number { return this.attr('x'); }\r\n    y(): number { return this.attr('y'); }\r\n    z(): number { return this.attr('z'); }\r\n    radius(): number { return this.attr('radius'); }\r\n\r\n}\r\n\r\nexport class NodePairQuery extends GraphElementQuery {\r\n    //elementType = 'nodePair';\r\n\r\n    constructor(elements: any[], g: DynamicGraph) {\r\n        super(elements, g, 'nodePair');\r\n        //this.elementType = 'nodePair';\r\n        if (elements.length > 0 && elements[0] instanceof NodePair) {\r\n            this._elements = []\r\n            for (var i = 0; i < elements.length; i++) {\r\n                this._elements.push(elements[i].id());\r\n            }\r\n        }\r\n        if (elements.length > 0 && typeof elements[0] == 'number') {\r\n            this._elements = []\r\n            for (var i = 0; i < elements.length; i++) {\r\n                this._elements.push(elements[i]);\r\n            }\r\n        }\r\n    }\r\n\r\n    contains(n: NodePair): boolean {\r\n        return this._elements.indexOf(n.id()) > -1;\r\n    }\r\n\r\n\r\n    highlighted(): NodePairQuery {\r\n        return new NodePairQuery(super.generic_highlighted(), this.g);\r\n    }\r\n    visible(): NodePairQuery {\r\n        return new NodePairQuery(super.generic_visible(), this.g);\r\n    }\r\n    selected(): NodePairQuery {\r\n        return new NodePairQuery(super.generic_selected(), this.g);\r\n    }\r\n    filter(filter: Function): NodePairQuery {\r\n        return new NodePairQuery(super.generic_filter(filter), this.g);\r\n    }\r\n    presentIn(t1: Time, t2: Time): NodePairQuery {\r\n        return new NodePairQuery(super.generic_presentIn(t1, t2), this.g);\r\n    }\r\n    sort(attributeName: string): NodePairQuery {\r\n        return <NodePairQuery>super.generic_sort(attributeName);\r\n    }\r\n\r\n    // returns the i-th element in this query\r\n    get(i: number): NodePair { return this.g._nodePairs[this._elements[i]] }\r\n\r\n    last(): Link { return this.g._links[this._elements[this._elements.length - 1]] }\r\n\r\n    // returns array of NodePair\r\n    toArray(): NodePair[] {\r\n        var a: NodePair[] = [];\r\n        for (var i = 0; i < this._elements.length; i++) {\r\n            a.push(this.g._nodePairs[this._elements[i]]);\r\n        }\r\n        return a;\r\n    }\r\n    createAttribute(attrName: string, f: Function): NodePairQuery {\r\n        // create and init new attribute array if necessary\r\n        if ((this.g.nodePairArrays as any)[attrName] == undefined) {\r\n            (this.g.nodePairArrays as any)[attrName] = []\r\n            for (var i = 0; i < this.g._nodePairs.length; i++) {\r\n                (this.g.nodePairArrays as any)[attrName].push();\r\n            }\r\n        }\r\n        for (var i = 0; i < this._elements.length; i++) {\r\n            (this.g.nodePairArrays as any)[attrName][this._elements[i]] = f(this.g._nodePairs[this._elements[i]]);\r\n        }\r\n        return this;\r\n    }\r\n    intersection(q: NodePairQuery): NodePairQuery {\r\n        return new NodePairQuery(this.generic_intersection(q)._elements, this.g);\r\n    }\r\n    removeDuplicates(): NodePairQuery {\r\n        return new NodePairQuery(this.generic_removeDuplicates()._elements, this.g);\r\n    }\r\n    forEach(f: Function): NodePairQuery {\r\n        for (var i = 0; i < this._elements.length; i++) {\r\n            f(this.g.nodePair(this._elements[i]), i);\r\n        }\r\n        return this;\r\n    }\r\n\r\n}\r\n\r\nexport class NodePair extends BasicElement {\r\n\r\n    constructor(id: number, graph: DynamicGraph) {\r\n        super(id, 'nodePair', graph)\r\n    }\r\n\r\n\r\n    // SPECIFIC ATTRIBUTE QUERIES\r\n\r\n    get source(): Node { return this.g._nodes[this.attr('source')]; }\r\n    get target(): Node { return this.g._nodes[this.attr('target')]; }\r\n    links(): LinkQuery { return new LinkQuery(this.attr('links'), this.g); }\r\n    nodeType(): string { return this.attr('nodeType'); }\r\n\r\n    presentIn(start: Time, end?: Time): boolean {\r\n        for (var i = 0; i < this.links.length; i++) {\r\n            if ((this.links as any)[i].presentIn(start, end))\r\n                return true;\r\n        }\r\n        return false;\r\n    }\r\n}\r\n\r\nexport class StringQuery {\r\n    _elements: string[];\r\n\r\n    constructor(elements?: string[]) {\r\n        if (elements)\r\n            this._elements = elements.slice(0);\r\n        else\r\n            this._elements = []; // INIT WHEN ELEMENTS DOESN'T EXIST\r\n    }\r\n    contains(element: string): boolean {\r\n        return this._elements.indexOf(element) > -1;\r\n    }\r\n\r\n    addUnique(element: string): void {\r\n        if (this._elements.indexOf(element) == -1)\r\n            this._elements.push(element);\r\n    }\r\n    add(element: string): void {\r\n        this._elements.push(element);\r\n    }\r\n    addAll(elements: string[]): void {\r\n        for (var i = 0; i < elements.length; i++) {\r\n            if (elements[i] != undefined)\r\n                this._elements.push(elements[i]);\r\n        }\r\n    }\r\n    addAllUnique(elements: string[]): void {\r\n        for (var i = 0; i < elements.length; i++) {\r\n            this.addUnique(elements[i]);\r\n        }\r\n    }\r\n\r\n    get length(): number { return this._elements.length };\r\n    size(): number { return this._elements.length };\r\n\r\n    toArray(): string[] {\r\n        return this._elements.slice(0);\r\n    }\r\n    forEach(f: Function): StringQuery {\r\n        for (var i = 0; i < this._elements.length; i++) {\r\n            f(this._elements[i], i);\r\n        }\r\n        return this;\r\n    }\r\n\r\n}\r\n\r\nfunction getBulkAttributes(attrName: string, ids: number[], type: string, g: DynamicGraph, t1?: Time, t2?: Time): any[] {\r\n    var a: any[] = [];\r\n    var temp: any[];\r\n    for (var i = 0; i < ids.length; i++) {\r\n        if (t2 != undefined && t1 != undefined) {\r\n            temp = (<ScalarTimeSeries<number>>g.attr(attrName, ids[i], type)).period(t1, t2).toArray();\r\n        } else\r\n            if (t1 != undefined) {\r\n                temp = [(<ScalarTimeSeries<number>>g.attr(attrName, ids[i], type)).get(t1)];\r\n            } else {\r\n                temp = (<ScalarTimeSeries<number>>g.attr(attrName, ids[i], type)).toArray();\r\n            }\r\n        for (var j = 0; j < temp.length; j++) {\r\n            if (temp[j] instanceof Array) {\r\n                a = a.concat(temp[j]);\r\n            } else {\r\n                if (a.indexOf(temp[j]) == -1)\r\n                    a.push(temp[j]);\r\n            }\r\n        }\r\n    }\r\n    return a;\r\n}\r\n\r\nexport class NodeQuery extends GraphElementQuery {\r\n    // elementType = 'node';\r\n\r\n    constructor(elements: any[], g: DynamicGraph) {\r\n        super(elements, g, 'node');\r\n        if (elements.length > 0 && elements[0] instanceof Node) {\r\n            this._elements = []\r\n            for (var i = 0; i < elements.length; i++) {\r\n                this._elements.push(elements[i].id());\r\n            }\r\n        } else\r\n            if (elements.length > 0 && typeof elements[0] == 'number') {\r\n                this._elements = []\r\n                for (var i = 0; i < elements.length; i++) {\r\n                    this._elements.push(elements[i]);\r\n                }\r\n            }\r\n        // this.elementType = 'node';\r\n    }\r\n\r\n    contains(n: Node): boolean {\r\n        return this._elements.indexOf(n.id()) > -1;\r\n    }\r\n\r\n\r\n    // WRAPPERS TO GENERIC FUNCTIONS IN GRAPH_ELEMENT_QUERY\r\n    highlighted(): NodeQuery {\r\n        return new NodeQuery(super.generic_highlighted(), this.g);\r\n    }\r\n    visible(): NodeQuery {\r\n        return new NodeQuery(super.generic_visible(), this.g);\r\n    }\r\n    selected(): NodeQuery {\r\n        return new NodeQuery(super.generic_selected(), this.g);\r\n    }\r\n    filter(filter: Function): NodeQuery {\r\n        return new NodeQuery(super.generic_filter(filter), this.g);\r\n    }\r\n    presentIn(t1: Time, t2: Time): NodeQuery {\r\n        return new NodeQuery(super.generic_presentIn(t1, t2), this.g);\r\n    }\r\n    sort(attributeName: string, asc?: boolean): NodeQuery {\r\n        return <NodeQuery>super.generic_sort(attributeName, asc);\r\n    }\r\n\r\n    // proper functions\r\n\r\n    label(): StringQuery {\r\n        var q: StringQuery = new StringQuery();\r\n        for (var i = 0; i < this._elements.length; i++) {\r\n            q.add('' + this.g.attr('label', this._elements[i], 'node'))\r\n        }\r\n        return q;\r\n    }\r\n    neighbors(t1?: Time, t2?: Time): NodeQuery {\r\n        return new NodeQuery(getBulkAttributes('neighbors', this._elements, 'node', this.g, t1, t2), this.g);\r\n    }\r\n    links(t1?: Time, t2?: Time): LinkQuery {\r\n        return new LinkQuery(getBulkAttributes('links', this._elements, 'node', this.g, t1, t2), this.g);\r\n    }\r\n    locations(t1?: Time, t2?: Time): LocationQuery {\r\n        return new LocationQuery(getBulkAttributes('locations', this._elements, 'node', this.g, t1, t2), this.g);\r\n    }\r\n    nodeTypes(): StringQuery {\r\n        var q: StringQuery = new StringQuery();\r\n        for (var i = 0; i < this._elements.length; i++) {\r\n            q.add(this.g.attr('nodeType', this._elements[i], 'node'))\r\n        }\r\n        return q;\r\n    }\r\n\r\n    // returns the i-th element in this query\r\n    get(i: number): Node { return this.g._nodes[this._elements[i]] }\r\n\r\n    last(): Node { return this.g._nodes[this._elements[this._elements.length - 1]] }\r\n\r\n    // returns array of nodes\r\n    toArray(): Node[] {\r\n        var a: Node[] = [];\r\n        for (var i = 0; i < this._elements.length; i++) {\r\n            a.push(this.g._nodes[this._elements[i]]);\r\n        }\r\n        return a;\r\n    }\r\n    createAttribute(attrName: string, f: Function): NodeQuery {\r\n        // create and init news attribute array if necessary\r\n        if ((this.g.nodeArrays as any)[attrName] == undefined) {\r\n            (this.g.nodeArrays as any)[attrName] = []\r\n            for (var i = 0; i < this.g._nodes.length; i++) {\r\n                (this.g.nodeArrays as any)[attrName].push();\r\n            }\r\n        }\r\n        for (var i = 0; i < this._elements.length; i++) {\r\n            (this.g.nodeArrays as any)[attrName][this._elements[i]] = f(this.g._nodes[this._elements[i]]);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    intersection(q: NodeQuery): NodeQuery {\r\n        return new NodeQuery(this.generic_intersection(q)._elements, this.g);\r\n    }\r\n    removeDuplicates(): NodeQuery {\r\n        return new NodeQuery(this.generic_removeDuplicates()._elements, this.g);\r\n    }\r\n\r\n    forEach(f: Function): NodeQuery {\r\n        for (var i = 0; i < this._elements.length; i++) {\r\n            f(this.g.node(this._elements[i]), i);\r\n        }\r\n        return this;\r\n    }\r\n\r\n}\r\n\r\n\r\n/**\r\n * Represents a node object\r\n */\r\nexport class Node extends BasicElement {\r\n\r\n    constructor(id: number, graph: DynamicGraph) {\r\n        super(id, 'node', graph)\r\n    }\r\n\r\n\r\n    // SPECIFIC ATTRIBUTE QUERIES\r\n\r\n    /** @returns this node's label, specified by the user.\r\n     * If no string value was delivered by the user, returns the ID as string.\r\n     */\r\n    label(): string { return '' + this.attr('label'); }\r\n\r\n    shape(): string { return '' + this.attr('shape');}\r\n\r\n    color(): string { return '' + this.attr('color');}\r\n\r\n    nodeType(): string { return this.attr('nodeType') }\r\n\r\n    /** Returns this nodes neighbors in a NodeQuery. No duplicates.\r\n     * If no parameter is supplied, returns *all* neighbors of this\r\n     * node over all time steps.\r\n     * @param t1 - start time. If only this parameter is specified, returns\r\n     * neighbors in this time step only.\r\n     * @param t2 - end time. If this parameter is specified, returns\r\n     * neighbors between t1 and t2.\r\n    */\r\n    neighbors(t1?: Time, t2?: Time): NodeQuery {\r\n        if (t2 != undefined && t1 != undefined) {\r\n            return new NodeQuery((<ArrayTimeSeries<number>>this.attr('neighbors')).period(t1, t2).toFlatArray(true), this.g);\r\n        }\r\n        if (t1 != undefined) {\r\n            return new NodeQuery((<ArrayTimeSeries<number>>this.attr('neighbors')).get(t1), this.g);\r\n        }\r\n        return new NodeQuery((<ArrayTimeSeries<number>>this.attr('neighbors')).toFlatArray(), this.g);\r\n    }\r\n    inNeighbors(t1?: Time, t2?: Time): NodeQuery {\r\n        if (t2 != undefined && t1 != undefined) {\r\n            return new NodeQuery((<ArrayTimeSeries<number>>this.attr('inNeighbors')).period(t1, t2).toFlatArray(true), this.g);\r\n        }\r\n        if (t1 != undefined) {\r\n            return new NodeQuery((<ArrayTimeSeries<number>>this.attr('inNeighbors')).get(t1), this.g);\r\n        }\r\n        return new NodeQuery((<ArrayTimeSeries<number>>this.attr('inNeighbors')).toFlatArray(true), this.g);\r\n    }\r\n    outNeighbors(t1?: Time, t2?: Time): NodeQuery {\r\n        if (t2 != undefined && t1 != undefined) {\r\n            return new NodeQuery((<ArrayTimeSeries<number>>this.attr('outNeighbors')).period(t1, t2).toFlatArray(true), this.g);\r\n        }\r\n        if (t1 != undefined) {\r\n            return new NodeQuery((<ArrayTimeSeries<number>>this.attr('outNeighbors')).get(t1), this.g);\r\n        }\r\n        return new NodeQuery((<ArrayTimeSeries<number>>this.attr('outNeighbors')).toFlatArray(), this.g);\r\n    }\r\n    links(t1?: Time, t2?: Time): LinkQuery {\r\n        if (t2 != undefined && t1 != undefined) {\r\n            return new LinkQuery((<ArrayTimeSeries<number>>this.attr('links')).period(t1, t2).toFlatArray(true), this.g);\r\n        }\r\n        if (t1 != undefined) {\r\n            return new LinkQuery((<ArrayTimeSeries<number>>this.attr('links')).get(t1), this.g);\r\n        }\r\n        return new LinkQuery((<ArrayTimeSeries<number>>this.attr('links')).toFlatArray(true), this.g);\r\n    }\r\n    inLinks(t1?: Time, t2?: Time): LinkQuery {\r\n        if (t2 != undefined && t1 != undefined) {\r\n            return new LinkQuery((<ArrayTimeSeries<number>>this.attr('inLinks')).period(t1, t2).toFlatArray(true), this.g);\r\n        }\r\n        if (t1 != undefined) {\r\n            return new LinkQuery((<ArrayTimeSeries<number>>this.attr('inLinks')).get(t1), this.g);\r\n        }\r\n        return new LinkQuery((<ArrayTimeSeries<number>>this.attr('inLinks')).toFlatArray(true), this.g);\r\n    }\r\n    outLinks(t1?: Time, t2?: Time): LinkQuery {\r\n        if (t2 != undefined && t1 != undefined) {\r\n            return new LinkQuery((<ArrayTimeSeries<number>>this.attr('outLinks')).period(t1, t2).toFlatArray(true), this.g);\r\n        }\r\n        if (t1 != undefined) {\r\n            return new LinkQuery((<ArrayTimeSeries<number>>this.attr('outLinks')).get(t1), this.g);\r\n        }\r\n        return new LinkQuery((<ArrayTimeSeries<number>>this.attr('outLinks')).toFlatArray(true), this.g);\r\n    }\r\n    locations(t1?: Time, t2?: Time): LocationQuery {\r\n        if (t2 != undefined && t1 != undefined) {\r\n            return new LocationQuery((<ScalarTimeSeries<number>>this.attr('locations')).period(t1, t2).toArray(), this.g);\r\n        }\r\n        if (t1 != undefined) {\r\n            return new LocationQuery([(<ScalarTimeSeries<number>>this.attr('locations')).get(t1)], this.g);\r\n        }\r\n        return new LocationQuery((<ScalarTimeSeries<number>>this.attr('locations')).toArray(), this.g);\r\n    }\r\n    locationSerie(t1?: Time, t2?: Time): ScalarTimeSeries<Location> {\r\n        var serie: ScalarTimeSeries<number>;\r\n        if (t2 != undefined && t1 != undefined)\r\n            serie = (<ScalarTimeSeries<number>>this.attr('locations')).period(t1, t2);\r\n            // return this.attr('locations').period(t1, t2);\r\n        else if (t1 != undefined)\r\n            serie = (<ScalarTimeSeries<number>>(this.attr('locations')).get(t1));\r\n            // return this.attr('locations').get(t1);\r\n        else\r\n            serie = (<ScalarTimeSeries<number>>this.attr('locations'));\r\n            // return this.attr('locations');\r\n\r\n        var serie2 = serie.getSerie();\r\n        // replace numbers by locations\r\n        var serie3 = new ScalarTimeSeries<Location>();\r\n        for (var t in serie2) {\r\n            var time = this.g.time(parseInt(t));\r\n            var location = this.g.location((serie2 as any)[t]);\r\n            if (time != undefined && location != undefined) {\r\n                serie3.set(time, location);\r\n            }\r\n        }\r\n        return serie3;\r\n    }\r\n\r\n\r\n    linksBetween(n: Node): LinkQuery {\r\n        var links = this.links().toArray();\r\n        var finalLinks = []\r\n        var l\r\n        for (var i = 0; i < links.length; i++) {\r\n            l = links[i]\r\n            if (l.source == n || l.target == n)\r\n                finalLinks.push(l)\r\n        }\r\n        return new LinkQuery(finalLinks, this.g);\r\n\r\n    }\r\n\r\n\r\n    // TODO\r\n    // presentIn(start: Time, end?: Time): boolean {\r\n    //     // TODO, consider present times for nodes.\r\n    //     return true;\r\n    // }\r\n}\r\n\r\n\r\nexport class LinkQuery extends GraphElementQuery {\r\n    //elementType = 'link';\r\n\r\n    constructor(elements: any[], g: DynamicGraph) {\r\n        super(elements, g, 'link');\r\n        if (elements.length > 0 && elements[0] instanceof Link) {\r\n            this._elements = []\r\n            for (var i = 0; i < elements.length; i++) {\r\n                this._elements.push(elements[i].id());\r\n            }\r\n        }\r\n        if (elements.length > 0 && typeof elements[0] == 'number') {\r\n            this._elements = []\r\n            for (var i = 0; i < elements.length; i++) {\r\n                this._elements.push(elements[i]);\r\n            }\r\n        }\r\n    }\r\n\r\n    contains(l: Link): boolean {\r\n        return this._elements.indexOf(l.id()) > -1;\r\n    }\r\n\r\n    highlighted(): LinkQuery {\r\n        return new LinkQuery(super.generic_highlighted(), this.g);\r\n    }\r\n    visible(): LinkQuery {\r\n        return new LinkQuery(super.generic_visible(), this.g);\r\n    }\r\n    selected(): LinkQuery {\r\n        return new LinkQuery(super.generic_selected(), this.g);\r\n    }\r\n    filter(filter: Function): LinkQuery {\r\n        return new LinkQuery(super.generic_filter(filter), this.g);\r\n    }\r\n    presentIn(t1: Time, t2?: Time): LinkQuery {\r\n        return new LinkQuery(super.generic_presentIn(t1, t2), this.g);\r\n    }\r\n    sort(attributeName: string): LinkQuery {\r\n        return <LinkQuery>super.generic_sort(attributeName);\r\n    }\r\n\r\n    // returns the i-th element in this query\r\n    get(i: number): Link { return this.g._links[this._elements[i]] }\r\n\r\n    last(): Link { return this.g._links[this._elements[this._elements.length - 1]] }\r\n\r\n    // returns array of links\r\n    toArray(): Link[] {\r\n        var a: Link[] = [];\r\n        for (var i = 0; i < this._elements.length; i++) {\r\n            a.push(this.g._links[this._elements[i]]);\r\n        }\r\n        return a;\r\n    }\r\n\r\n    weights(start?: Time, end?: Time): NumberQuery {\r\n        var s: NumberQuery = new NumberQuery();\r\n        for (var i = 0; i < this._elements.length; i++) {\r\n            var gLink = this.g.link(i);\r\n            if (gLink != undefined)\r\n                s.addAll(gLink.weights(start, end).toArray());\r\n            // ELSE ???\r\n        }\r\n        return s;\r\n    }\r\n\r\n    createAttribute(attrName: string, f: Function): LinkQuery {\r\n        // create and init new attribute array if necessary\r\n        if ((this.g.linkArrays as any)[attrName] == undefined) {\r\n            (this.g.linkArrays as any)[attrName] = []\r\n            for (var i = 0; i < this.g._links.length; i++) {\r\n                (this.g.linkArrays as any)[attrName].push();\r\n            }\r\n        }\r\n        for (var i = 0; i < this._elements.length; i++) {\r\n            (this.g.linkArrays as any)[attrName][this._elements[i]] = f(this.g._links[this._elements[i]]);\r\n        }\r\n        return this;\r\n    }\r\n    linkTypes(): String[] {\r\n        var linkTypes: String[] = [];\r\n        var s;\r\n        for (var i = 0; i < this._elements.length; i++) {\r\n            var gLink = this.g.link(this._elements[i]);\r\n            if (gLink != undefined) {\r\n                s = gLink.linkType();\r\n                if (linkTypes.indexOf(s) == -1)\r\n                    linkTypes.push(s);\r\n            }\r\n            // ELSE ??\r\n        }\r\n        return linkTypes;\r\n    }\r\n\r\n    sources(): NodeQuery {\r\n        var nodes: number[] = []\r\n        var link;\r\n        for (var i = 0; i < this._elements.length; i++) {\r\n            link = this.g.link(this._elements[i]);\r\n            if (link != undefined) { // UNDEFINED??\r\n                if (nodes.indexOf(link.source.id()) == -1) // ID??\r\n                    nodes.push(link.source.id());\r\n            }\r\n        }\r\n        return new NodeQuery(nodes, this.g);\r\n    }\r\n\r\n    targets(): NodeQuery {\r\n        var nodes: number[] = []\r\n        var link;\r\n        for (var i = 0; i < this._elements.length; i++) {\r\n            link = this.g.link(this._elements[i]);\r\n            if (link != undefined) { // UNDEFINED??\r\n                if (nodes.indexOf(link.target.id()) == -1) // ID??\r\n                    nodes.push(link.target.id());\r\n            }\r\n        }\r\n        return new NodeQuery(nodes, this.g);\r\n    }\r\n\r\n    intersection(q: LinkQuery): LinkQuery {\r\n        return new LinkQuery(this.generic_intersection(q)._elements, this.g);\r\n    }\r\n    removeDuplicates(): LinkQuery {\r\n        return new LinkQuery(this.generic_removeDuplicates()._elements, this.g);\r\n    }\r\n    forEach(f: Function): LinkQuery {\r\n        for (var i = 0; i < this._elements.length; i++) {\r\n            f(this.g.link(this._elements[i]), i);\r\n        }\r\n        return this;\r\n    }\r\n\r\n}\r\n\r\n/**\r\n  * Represents a link object on a WindowGraph\r\n  */\r\nexport class Link extends BasicElement {\r\n\r\n    targetNPO: any = undefined;\r\n    sourceNPO: any = undefined;\r\n    constructor(id: number, graph: DynamicGraph) {\r\n        super(id, 'link', graph)\r\n    }\r\n\r\n    // SPECIFIC ATTRIBUTE QUERIES\r\n\r\n    linkType(): string { return this.attr('linkType'); }\r\n    get source(): Node { return this.g._nodes[this.attr('source')]; }\r\n    get target(): Node { return this.g._nodes[this.attr('target')]; }\r\n    nodePair(): NodePair { return this.g._nodePairs[this.attr('nodePair')]; }\r\n    directed(): boolean { return this.attr('directed'); }\r\n\r\n    other(n: Node): Node {\r\n        return this.source == n ? this.target : this.source;\r\n    }\r\n\r\n    /** Returns this link's weights over time as NumberQuery\r\n    * If no time parameter is supplied, returns *all* weights of this\r\n     * link over all time steps.\r\n     * @param t1 - start time. If only this parameter is specified, returns\r\n     * only the value for t1.\r\n     * @param t2 - end time. If this parameter is specified, returns\r\n     * weights between t1 and t2.\r\n    */\r\n    weights(start?: Time, end?: Time): NumberQuery {\r\n        if (start == undefined)\r\n            return new NumberQuery((<ScalarTimeSeries<number>>this.attr('weights')).toArray());\r\n        if (end == undefined)\r\n            return new NumberQuery([(<ScalarTimeSeries<number>>this.attr('weights')).get(start)]);\r\n        return new NumberQuery((<ScalarTimeSeries<number>>this.attr('weights')).period(start, end).toArray());\r\n    }\r\n\r\n    presentIn(start: Time, end?: Time): boolean {\r\n        var presence: number[] = this.weights(start, end).toArray();\r\n        return presence.length > 0;\r\n    }\r\n    /** Returns all times in which this link's weight != 0  */\r\n    times(): TimeQuery {\r\n        // var weights:ScalarTimeSeries<number> = <ScalarTimeSeries<number>>this.attr('weights');\r\n        // var times = []\r\n        // var allTimes = this.g.times().toArray();\r\n        // for(var t in weights.serie){\r\n        //     times.push(allTimes[parseInt(t)]);\r\n        // }\r\n        return new TimeQuery(this.attr('presence'), this.g);\r\n    }\r\n\r\n\r\n}\r\n\r\nexport class LinkType implements LegendElement {\r\n    id: number;\r\n    name: string;\r\n    color: string;\r\n    constructor(id: number, name: string, color: string) {\r\n        this.id = id;\r\n        this.name = name;\r\n        this.color = color;\r\n    }\r\n}\r\n\r\n/* Moved from utils to dynamicgraph to eliminate circular dependency */\r\n/* used by dynamicgraph, but not used none of utils*/\r\n\r\nexport function attributeSort(a: BasicElement, b: BasicElement, attributeName: string, asc?: boolean): number {\r\n    var value = a.attr(attributeName);\r\n    var result;\r\n    if (typeof value == 'string') {\r\n        result = a.attr(attributeName).localeCompare(b.attr(attributeName));\r\n    }\r\n    else if (typeof value == 'number') {\r\n        result = b.attr(attributeName) - a.attr(attributeName);\r\n    } else {\r\n        result = 0;\r\n    }\r\n\r\n    if (asc == false) {\r\n        result = -result;\r\n    }\r\n    return result;\r\n}\r\n\r\n/* moved from utils to dynamicgraph */\r\nexport class IDCompound {\r\n    nodeIds: number[] = [];\r\n    linkIds: number[] = [];\r\n    timeIds: number[] = [];\r\n    nodePairIds: number[] = [];\r\n    locationIds: number[] = [];\r\n}\r\n\r\nexport interface LegendElement {\r\n    name: string;\r\n    color: string;\r\n}\r\n\r\n/******** MOVED FROM UTILS TO DYNAMICGRAPH *********/\r\n\r\nexport function copyPropsShallow(source: any, target: any): any {\r\n    for (var p in source) {\r\n        if (source.hasOwnProperty(p))\r\n            target[p] = source[p];\r\n    }\r\n    return target;\r\n}\r\n\r\nexport function copyTimeseriesPropsShallow(source: any, target: any): any {\r\n    for (var q in source) {\r\n        if (source.hasOwnProperty(q)) {\r\n            for (var p in source[q]) {\r\n                if (source[q].hasOwnProperty(p)) {\r\n                    target[q][p] = source[q][p];\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return target;\r\n}\r\n\r\nexport function copyTimeSeries<TElement>(arr: any[], ctorFunc: () => TElement): TElement[] {\r\n    var arrayClone: TElement[] = [];\r\n    for (var elem in arr) {\r\n        arrayClone.push(copyTimeseriesPropsShallow(arr[elem], ctorFunc()));\r\n    }\r\n    return arrayClone;\r\n}\r\n\r\nexport function compareTypesDeep(a: any, b: any, depth: number): boolean {\r\n    var result = true;\r\n    if (a == null || b == null)\r\n        return a == b;\r\n    if (typeof a != typeof b)\r\n        return false;\r\n    else if (typeof a != 'object')\r\n        return true;\r\n    else if (a.constructor !== b.constructor)\r\n        return false;\r\n    else {\r\n        if (depth > 0) {\r\n            for (var key in a) {\r\n                if (key in b\r\n                    && a.hasOwnProperty(key)\r\n                    && b.hasOwnProperty(key)\r\n                    && !compareTypesDeep(a[key], b[key], depth - 1)) {\r\n                    console.log(\"compareFailed for key\", key, a[key], b[key]);\r\n                    result = false;\r\n                }\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n}\r\n\r\nexport function sortNumber(a: any, b: any) {\r\n    return a - b;\r\n}\r\n\r\nexport function array(value: any, size: number): any[] {\r\n    var array: any[] = []\r\n    while (size--) array[size] = value;\r\n    return array;\r\n}\r\n\r\nexport function doubleArray(size1: number, size2?: number, value?: any): any[] {\r\n    var array: any[] = []\r\n    if (value == undefined)\r\n        value = []\r\n    var a: any[] = [];\r\n\r\n    if (size2) {\r\n        while (size2--) a[size2] = value;\r\n    }\r\n    while (size1--) array[size1] = a.slice(0);\r\n\r\n    return array;\r\n}\r\n\r\n/********* MOVED FROM DATAMANAGER TO DYNAMICGRAPH **********/\r\n\r\nexport interface DataManagerOptions {\r\n    keepOnlyOneSession: boolean;\r\n}\r\n\r\nexport class DataManager {\r\n\r\n    constructor(options?: DataManagerOptions) {\r\n        if (options) {\r\n            // initialize stuff differently here\r\n            if (options.keepOnlyOneSession)\r\n                this.setOptions(options);\r\n        } else {\r\n            this.keepOnlyOneSession = false;\r\n        }\r\n    }\r\n\r\n    setOptions(options: DataManagerOptions): void {\r\n        this.keepOnlyOneSession = options.keepOnlyOneSession;\r\n    }\r\n    // current dynamic graph of the visualization.\r\n    // The first time the getGraph() function is called\r\n    // that graph object is created and populated.\r\n    // The second time, it's just retrieved.\r\n    dynamicGraph?: DynamicGraph;\r\n\r\n    keepOnlyOneSession: boolean = false;\r\n    session: string = '';\r\n\r\n    sessionDataPrefix: string = \"ncubesession\";\r\n    // sessionDataPrefix: string = \"\";\r\n\r\n    clearSessionData(session: string): void {\r\n        var searchPrefix = this.sessionDataPrefix + this.SEP + session;\r\n        // var searchPrefix = session;\r\n        var keysToClear: string[] = [];\r\n        for (var i = 0; i < localStorage.length; i++) {\r\n            var key = localStorage.key(i);\r\n            if (!key) continue;\r\n            if (key.indexOf(searchPrefix) == 0)\r\n                keysToClear.push(key);\r\n            // these are the old keys that we used to store before we\r\n            // added support for multiple sessions\r\n            else if (key.indexOf('connectoscope1') == 0)\r\n                keysToClear.push(key);\r\n        }\r\n        for (var i = 0; i < keysToClear.length; i++) {\r\n            var k = keysToClear[i];\r\n            localStorage.removeItem(k);\r\n        }\r\n    }\r\n\r\n    clearAllSessionData(): void {\r\n        this.clearSessionData('');\r\n    }\r\n\r\n    isSessionCached(session: string, dataSetName: string): boolean {\r\n        var prefix = this.sessionDataPrefix + this.SEP + session + this.SEP + dataSetName;\r\n        //var firstSessionKey: string = null;\r\n        for (var i = 0; i < localStorage.length; i++) {\r\n            var key = localStorage.key(i);\r\n            if (key && key.indexOf(prefix) == 0) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Import a data set into networkcube's local storage.\r\n     * @param  {string}  session - current session id\r\n     * @param  {DataSet} data    - a networkcube.DataSet\r\n     */\r\n    importData(session: string, data: DataSet) {\r\n        this.session = session;\r\n\r\n        // check if all data (tables + schemas) are there\r\n        if (!data.nodeTable && !data.linkTable) {\r\n            console.log('Empty tables. No data imported.')\r\n            return;\r\n        }\r\n\r\n        if (!data.nodeTable) {\r\n            console.log('[n3] Node table missing!')\r\n        }\r\n        if (!data.linkTable) {\r\n            console.log('[n3] Link table missing!')\r\n        }\r\n        if (!data.nodeSchema) {\r\n            console.log('[n3] Node schema missing!')\r\n        }\r\n        if (!data.linkSchema) {\r\n            console.log('[n3] Link schema missing!')\r\n        }\r\n\r\n        // format data\r\n        for (var i = 0; i < data.nodeTable.length; i++) {\r\n            for (var j = 0; j < data.nodeTable[i].length; j++) {\r\n                if (typeof data.nodeTable[i][j] == 'string')\r\n                    data.nodeTable[i][j] = data.nodeTable[i][j].trim();\r\n            }\r\n        }\r\n        for (var i = 0; i < data.linkTable.length; i++) {\r\n            for (var j = 0; j < data.linkTable[i].length; j++) {\r\n                if (typeof data.linkTable[i][j] == 'string')\r\n                    data.linkTable[i][j] = data.linkTable[i][j].trim();\r\n            }\r\n        }\r\n\r\n        // this.saveToStorage(data.name, this.NODE_TABLE, data.nodeTable);\r\n        // this.saveToStorage(data.name, this.NODE_SCHEMA, data.nodeSchema);\r\n        // this.saveToStorage(data.name, this.LINK_SCHEMA, data.linkSchema);\r\n        // this.saveToStorage(data.name, this.LINK_TABLE, data.linkTable);\r\n        // // if(data.locationTable){\r\n        // this.saveToStorage(data.name, this.LOCATION_TABLE, data.locationTable);\r\n        // this.saveToStorage(data.name, this.LOCATION_SCHEMA, data.locationSchema);\r\n        // }\r\n\r\n        // In order to initialize the dynamic graph, our schema must be sufficiently well-defined\r\n        if (this.isSchemaWellDefined(data)) {\r\n            console.log('data is well-schematized, caching dynamicGraph');\r\n            // in order to ensure that we have enough quota, we only keep one session\r\n            // cached at a time.\r\n            if (this.keepOnlyOneSession)\r\n                this.clearAllSessionData();\r\n\r\n            var graphForCaching: DynamicGraph = new DynamicGraph();\r\n            graphForCaching.initDynamicGraph(data);\r\n            // CACHEGRAPH store DynamicGraph in localstorage\r\n            graphForCaching.saveDynamicGraph(this);\r\n\r\n            // CACHEGRAPH : this code is strictly for diagnostics;\r\n            var doubleCheckSave = false;\r\n            if (doubleCheckSave) {\r\n                var testGraph: DynamicGraph = new DynamicGraph();\r\n                testGraph.loadDynamicGraph(this, data.name);\r\n                testGraph.debugCompareTo(graphForCaching);\r\n            }\r\n        } else {\r\n            console.log('data is not well-schematized, so not caching dynamicGraph');\r\n        }\r\n    }\r\n\r\n    // Strings used to access local storage\r\n    SEP: string = \"_\";\r\n    // NODE_TABLE: string = 'networkcube.nodetable';\r\n    // LINK_TABLE: string = 'networkcube.linktable';\r\n    // NODE_SCHEMA: string = 'networkcube.nodeschema';\r\n    // LINK_SCHEMA: string = 'networkcube.linkschema';\r\n    // LOCATION_TABLE: string = 'networkcube.locationtable';\r\n    // LOCATION_SCHEMA: string = 'networkcube.locationschema';\r\n    // GRAPH: string = 'networkcube.graph';\r\n\r\n    // storage primitives /////////////////////////////////////\r\n    //\r\n    saveToStorage<T>(dataName: string, valueName: string, value: T, replacer?: (key: string, value: any) => any) {\r\n        if (value == undefined) {\r\n            console.log('attempting to save undefined value. aborting', dataName, valueName);\r\n            return;\r\n        }\r\n        var stringifyResult = JSON.stringify(value, replacer);\r\n\r\n        var stringToSave;\r\n        if (stringifyResult.length > 1024 * 1024 * 4)\r\n            stringToSave = LZString.compress(stringifyResult);\r\n        else\r\n            stringToSave = stringifyResult;\r\n\r\n        localStorage[this.sessionDataPrefix + this.SEP\r\n            + this.session\r\n            + this.SEP + dataName\r\n            + this.SEP + valueName] = stringToSave;\r\n    }\r\n\r\n    getFromStorage<TResult>(\r\n        dataName: string,\r\n        valueName: string,\r\n        reviver?: (key: any, value: any, state: any) => any,\r\n        state?: any): TResult | undefined { // : TResult\r\n\r\n        console.assert(this.session != '');\r\n\r\n        var statefulReviver;\r\n        if (reviver)\r\n            statefulReviver = function (key: any, value: any): any {\r\n                return reviver(key, value, state);\r\n            };\r\n        else\r\n            statefulReviver = undefined;\r\n\r\n        var storedResult = localStorage[\r\n            this.sessionDataPrefix\r\n            + this.SEP + this.session\r\n            + this.SEP + dataName\r\n            + this.SEP + valueName];\r\n\r\n\r\n        if (storedResult && storedResult != \"undefined\") {\r\n            // we try to detect whether the string was compressed or not. Given that it is\r\n            // JSON, we would expect it to begin with either a quote, a bracket, or a curly-brace\r\n            var parseText;\r\n            if(storedResult == \"true\"){\r\n                parseText = true;\r\n            }\r\n            else if(storedResult == \"false\"){\r\n                parseText = false;\r\n            }\r\n            else if (\"\\\"'[{0123456789\".indexOf(storedResult[0]) >= 0)\r\n                parseText = storedResult;\r\n            else\r\n                parseText = LZString.decompress(storedResult);\r\n\r\n            return <TResult>JSON.parse(parseText, statefulReviver);\r\n        }\r\n        else {\r\n            return undefined;\r\n        }\r\n    }\r\n\r\n    removeFromStorage(dataName: string, valueName: string): void {\r\n        localStorage.removeItem(this.sessionDataPrefix\r\n            + this.SEP + this.session\r\n            + this.SEP + dataName\r\n            + this.SEP + valueName);\r\n    }\r\n    //\r\n    // end storage primitives //////////////////////////////\r\n\r\n\r\n    // GRAPH\r\n\r\n    getGraph(session: string, dataname: string): DynamicGraph {\r\n        this.session = session;\r\n        if (!this.dynamicGraph || this.dynamicGraph.name != dataname) {\r\n            this.dynamicGraph = new DynamicGraph();\r\n            this.dynamicGraph.loadDynamicGraph(this, dataname);\r\n        }\r\n        return this.dynamicGraph;\r\n    }\r\n\r\n\r\n    isSchemaWellDefined(data: DataSet): boolean {\r\n        console.log('isSchemaWellDefined');\r\n        if (data.locationTable && !isValidIndex(data.locationSchema.id))\r\n            return false;\r\n        if (data.nodeTable.length > 0 && !isValidIndex(data.nodeSchema.id))\r\n            return false;\r\n        if (data.linkTable.length > 0\r\n            && !(isValidIndex(data.linkSchema.id)\r\n                && isValidIndex(data.linkSchema.source)\r\n                && isValidIndex(data.linkSchema.target)))\r\n            return false;\r\n\r\n        return true;\r\n    }\r\n}","import {\r\n    Node,\r\n    Link,\r\n    Time,\r\n} from './dynamicgraph'\r\n\r\n////////////////\r\n//// MOTIFS ////\r\n////////////////\r\n\r\nexport class Motif {\r\n    nodes: Node[] = []\r\n    links: Link[] = []\r\n    times: Time[] = []\r\n\r\n    constructor(nodes: Node[], links: Link[]) {\r\n        this.nodes = nodes.slice(0)\r\n        this.links = links.slice(0);\r\n    }\r\n\r\n    print() {\r\n        console.log('nodes:', this.nodes.length, 'links:', this.links.length)\r\n    }\r\n}\r\n\r\nexport class MotifTemplate {\r\n    nodes: number[] = []\r\n    links: number[][] = []\r\n\r\n    constructor(nodes: number[], links: number[][]) {\r\n        this.nodes = nodes.slice(0)\r\n        this.links = links.slice(0);\r\n    }\r\n}\r\n\r\nexport class MotifSequence {\r\n    motifs: Motif[] = [];\r\n    push(m: Motif) {\r\n        this.motifs.push(m);\r\n    }\r\n}\r\n//}","/// <reference path=\"./lib/d3.d.ts\"/>\r\n\r\nimport {\r\n    BasicElement,\r\n    Time,\r\n    IDCompound,\r\n    DynamicGraph,\r\n    NodePair,\r\n    Node,\r\n    Link,\r\n    LinkType,\r\n    copyPropsShallow\r\n} from './dynamicgraph'\r\nimport * as moment from 'moment'\r\n\r\n/* moved from utils to queries */\r\n\r\nexport function getType(elements: any[]): string | undefined { // before was only string\r\n\r\n    var type: string = ''; // before only string, without init\r\n    if (elements.length == 0)\r\n        return;\r\n    if (elements[0] instanceof Node)\r\n        type = 'node';\r\n    else\r\n        if (elements[0] instanceof Link) {\r\n            type = 'link';\r\n        } else\r\n            if (elements[0] instanceof Time) {\r\n                type = 'time';\r\n            } else\r\n                if (elements[0] instanceof NodePair) {\r\n                    type = 'nodePair';\r\n                } else\r\n                    if (elements[0] instanceof LinkType) {\r\n                        type = 'linkType';\r\n                    } else\r\n                        if (typeof elements[0] == 'number') {\r\n                            type = 'number';\r\n                        }\r\n\r\n    return type;\r\n}\r\n\r\n/* moved from utils to queries */\r\n\r\nexport function makeElementCompound(elements: IDCompound, g: DynamicGraph): ElementCompound {\r\n    var result: ElementCompound = new ElementCompound;\r\n    if (elements != undefined) {\r\n        if (elements.nodeIds) {\r\n            result.nodes = <Node[]>elements.nodeIds.map((id, i) => g.node(id)); // ?? WITH OR WITHOUT ?? .filter((element) => { return (element != undefined) });\r\n        }\r\n        if (elements.linkIds) {\r\n            result.links = <Link[]>elements.linkIds.map((id, i) => g.link(id));\r\n        }\r\n        if (elements.timeIds) {\r\n            result.times = <Time[]>elements.timeIds.map((id, i) => g.time(id));\r\n        }\r\n        if (elements.nodePairIds) {\r\n            result.nodePairs = <NodePair[]>elements.nodePairIds.map((id, i) => g.nodePair(id));\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\n/* moved from utils to queries */\r\nexport class ElementCompound {\r\n    nodes: Node[] = [];\r\n    links: Link[] = [];\r\n    times: Time[] = [];\r\n    nodePairs: NodePair[] = [];\r\n    locations: Location[] = [];\r\n}\r\n\r\n\r\nexport function getPriorityColor(element: BasicElement): string | undefined { // before: return string\r\n\r\n    var j = 0\r\n    var selections = element.getSelections();\r\n    while (!selections[j].showColor) {\r\n        j++;\r\n        if (j == selections.length) {\r\n            j = -1;\r\n            return;\r\n        }\r\n    }\r\n    return element.getSelections()[j].color;\r\n}\r\n\r\n\r\nexport function sortByPriority(s1: any, s2: any) {\r\n    return s1.priority - s2.priority;\r\n}\r\n\r\n\r\nexport function getUrlVars(): Object {\r\n    var vars: Object = {};\r\n    var params = window.location.search.replace(\"?\", \"\").split('&');\r\n    var tmp: any;\r\n    var value: any;\r\n    params.forEach(function (item) {\r\n        tmp = item.split(\"=\");\r\n        value = decodeURIComponent(tmp[1]);\r\n        (vars as any)[tmp[0]] = value;\r\n    });\r\n    return vars;\r\n}\r\n\r\nexport function capitalizeFirstLetter(string: string): string {\r\n    return string.charAt(0).toUpperCase() + string.slice(1);\r\n}\r\n\r\nexport function isBefore(t1: Time, t2: Time): boolean {\r\n    return t1.time < t2.time;\r\n}\r\nexport function isAfter(t1: Time, t2: Time): boolean {\r\n    return t1.time > t2.time;\r\n}\r\n\r\n\r\nexport function hex2Rgb(hex: string): number[] {\r\n    return [hexToR(hex), hexToG(hex), hexToB(hex)]\r\n}\r\nfunction hexToR(h: any) { return parseInt((cutHex(h)).substring(0, 2), 16); }\r\nfunction hexToG(h: any) { return parseInt((cutHex(h)).substring(2, 4), 16); }\r\nfunction hexToB(h: any) { return parseInt((cutHex(h)).substring(4, 6), 16); }\r\nfunction cutHex(h: any) { return (h.charAt(0) == \"#\") ? h.substring(1, 7) : h; }\r\n\r\nexport function hex2web(v: string) {\r\n    v = v + '';\r\n    return v.replace('0x', '#');\r\n}\r\n\r\nexport function hex2RgbNormalized(hex: string): number[] {\r\n    return [hexToR(hex) / 255, hexToG(hex) / 255, hexToB(hex) / 255]\r\n}\r\n\r\n\r\nexport function areEqualShallow(a: any, b: any): boolean {\r\n    for (var key in a) {\r\n        if (!(key in b) || a[key] !== b[key]) {\r\n            return false;\r\n        }\r\n    }\r\n    for (var key in b) {\r\n        if (!(key in a) || a[key] !== b[key]) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n}\r\n\r\nexport function compareTypesShallow(a: any, b: any): boolean {\r\n    if (a == null || b == null)\r\n        return a == b;\r\n    if (typeof a != typeof b)\r\n        return false;\r\n    else if (typeof a != 'object')\r\n        return true;\r\n    else if (a.constructor !== b.constructor)\r\n        return false;\r\n    else {\r\n        return true;\r\n    }\r\n}\r\n\r\nexport function copyArray<TElement>(arr: any[], ctorFunc: () => TElement): TElement[] {\r\n    var arrayClone: TElement[] = [];\r\n    for (var elem in arr) {\r\n        arrayClone.push(copyPropsShallow(arr[elem], ctorFunc()));\r\n    }\r\n    return arrayClone;\r\n}\r\n\r\nexport class Box {\r\n    x1: number;\r\n    x2: number;\r\n    y1: number;\r\n    y2: number;\r\n\r\n    constructor(x1: number, y1: number, x2: number, y2: number) {\r\n\r\n        this.x1 = Math.min(x1, x2);\r\n        this.x2 = Math.max(x1, x2);\r\n        this.y1 = Math.min(y1, y2);\r\n        this.y2 = Math.max(y1, y2);\r\n    }\r\n\r\n    get width(): number {\r\n        return this.x2 - this.x1;\r\n    }\r\n    get height(): number {\r\n        return this.y2 - this.y1;\r\n    }\r\n    isPoint(): boolean {\r\n        return (this.width == 0) && (this.height == 0);\r\n    }\r\n}\r\n\r\nexport function inBox(x: any, y: any, box: Box): boolean {\r\n    return (x > box.x1\r\n        && x < box.x2\r\n        && y > box.y1\r\n        && y < box.y2)\r\n}\r\n\r\n\r\nexport function isSame(a: any[], b: any[]): boolean {\r\n    if (a.length != b.length)\r\n        return false;\r\n    var found = true;\r\n    for (var i = 0; i < a.length; i++) {\r\n        found = false;\r\n        for (var j = 0; j < b.length; j++) {\r\n            if (a[i] == b[j])\r\n                found = true;\r\n        }\r\n        if (!found)\r\n            return false;\r\n    }\r\n    return true;\r\n}\r\n\r\nexport function cloneCompound(compound: IDCompound): IDCompound {\r\n    var result: IDCompound = new IDCompound();\r\n    if (compound.nodeIds) {\r\n        result.nodeIds = [];\r\n        for (var i = 0; i < compound.nodeIds.length; i++) {\r\n            result.nodeIds.push(compound.nodeIds[i])\r\n        }\r\n    }\r\n    if (compound.linkIds) {\r\n        result.linkIds = [];\r\n        for (var i = 0; i < compound.linkIds.length; i++) {\r\n            result.linkIds.push(compound.linkIds[i])\r\n        }\r\n    }\r\n    if (compound.nodePairIds) {\r\n        result.nodePairIds = [];\r\n        for (var i = 0; i < compound.nodePairIds.length; i++) {\r\n            result.nodePairIds.push(compound.nodePairIds[i])\r\n        }\r\n    }\r\n    if (compound.timeIds) {\r\n        result.timeIds = [];\r\n        for (var i = 0; i < compound.timeIds.length; i++) {\r\n            result.timeIds.push(compound.timeIds[i])\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\nexport function makeIdCompound(elements: ElementCompound | undefined): IDCompound {\r\n    var result: IDCompound = new IDCompound;\r\n    if (elements != undefined) {\r\n        if (elements.nodes) {\r\n            result.nodeIds = elements.nodes.map((n: any, i: any) => n.id());\r\n        }\r\n        if (elements.links) {\r\n            result.linkIds = elements.links.map((n: any, i: any) => n.id());\r\n        }\r\n        if (elements.times) {\r\n            result.timeIds = elements.times.map((n: any, i: any) => n.id());\r\n        }\r\n        if (elements.nodePairs) {\r\n            result.nodePairIds = elements.nodePairs.map((n: any, i: any) => n.id());\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\nexport function formatAtGranularity(time: any, granualarity: number) {\r\n    switch (granualarity) {\r\n        case 0: return time.millisecond();\r\n        case 1: return time.second();\r\n        case 2: return time.minute();\r\n        case 3: return time.hour();\r\n        case 4: return time.day();\r\n        case 5: return time.week();\r\n        case 6: return time.month() + 1;\r\n        case 7: return time.year();\r\n    }\r\n}\r\n\r\nexport function arraysEqual(a: any, b: any) {\r\n    if (a === b) return true;\r\n    if (a == null || b == null) return false;\r\n    if (a.length != b.length) return false;\r\n\r\n    // If you don't care about the order of the elements inside\r\n    // the array, you should sort both arrays here.\r\n\r\n    for (var i = 0; i < a.length; ++i) {\r\n        if (a[i] !== b[i]) return false;\r\n    }\r\n    return true;\r\n}\r\n\r\nexport function encapsulate(array: any[], attrName?: string): Object[] {\r\n    if (attrName == undefined) {\r\n        attrName = 'element';\r\n    }\r\n    var a = []\r\n    var o: Object;\r\n    for (var i = 0; i < array.length; i++) {\r\n        o = {\r\n            index: i,\r\n        };\r\n        (o as any)[attrName] = array[i];\r\n        a.push(o);\r\n    }\r\n    return a;\r\n}\r\n\r\nexport function isPointInPolyArray(poly: number[][], pt: number[]) {\r\n    for (var c = false, i = -1, l = poly.length, j = l - 1; ++i < l; j = i) ((poly[i][1] <= pt[1] && pt[1] < poly[j][1]) || (poly[j][1] <= pt[1] && pt[1] < poly[i][1])) && (pt[0] < (poly[j][0] - poly[i][0]) * (pt[1] - poly[i][1]) / (poly[j][1] - poly[i][1]) + poly[i][0]) && (c = !c); return c;\r\n}\r\n\r\n\r\nexport function formatTimeAtGranularity(time: Time, granualarity: number) {\r\n    var momentTime = moment.utc(time.unixTime())\r\n    switch (granualarity) {\r\n        case 0: return momentTime.millisecond();\r\n        case 1: return momentTime.second();\r\n        case 2: return momentTime.minute();\r\n        case 3: return momentTime.hour();\r\n        case 4: return momentTime.day();\r\n        case 5: return momentTime.week();\r\n        case 6: return momentTime.month() + 1;\r\n        default: return momentTime.year();\r\n    }\r\n}\r\n\r\n\r\n////////////////////////////\r\n/// SCREENSHOT FUNCTIONS ///\r\n////////////////////////////\r\n\r\n\r\n///////////\r\n/// PNG ///\r\n///////////\r\n\r\n// Downloads the content of the openGL canvas to the \r\n// desktop.\r\nexport function downloadPNGFromCanvas(name: string) {\r\n    var blob = getBlobFromCanvas(document.getElementsByTagName('canvas')[0]);\r\n    var fileNameToSaveAs = name + '_' + new Date().toUTCString() + '.png';\r\n    var downloadLink = document.createElement(\"a\")\r\n    downloadLink.download = fileNameToSaveAs;\r\n    downloadLink.href = window.URL.createObjectURL(blob);\r\n    downloadLink.click();\r\n}\r\n\r\n// Returns a blob from the passed canvas.\r\nfunction getBlobFromCanvas(canvas: any): Blob {\r\n    var dataURL = canvas.toDataURL(\"image/png\")\r\n    return dataURItoBlob(dataURL);\r\n}\r\n\r\n\r\n\r\n\r\n///////////\r\n/// SVG ///\r\n///////////\r\n\r\n// downloads a screenshot on the desktop from the passed svg\r\nexport function downloadPNGfromSVG(name: string, svgId: string) {\r\n    var blob = getBlobFromSVG(name, svgId);\r\n}\r\n\r\n// creates an image blob from the passed svg and calls the \r\n// callback function with the blob as parameter\r\nexport function getBlobFromSVG(name: string, svgId: string, callback?: Function) {\r\n    var width = $('#' + svgId).width();\r\n    var height = $('#' + svgId).height();\r\n    if (callback != undefined) // UNDEFINED ?? \r\n        getBlobFromSVGString(name, getSVGString(d3.select('#' + svgId).node()), width, height, callback) // what happend if callback undefinied (example above)\r\n}\r\nexport function getBlobFromSVGNode(name: string, svgNode: any, callback: Function, backgroundColor?: string) {\r\n    var string = getSVGString(svgNode);\r\n    var width = svgNode.getAttribute('width')\r\n    var height = svgNode.getAttribute('height')\r\n    if (width == null) {\r\n        width = window.innerWidth + 1000;\r\n    }\r\n    if (height == null) {\r\n        height = window.innerHeight + 1000;\r\n    }\r\n    getBlobFromSVGString(name, string, width, height, callback, backgroundColor)\r\n}\r\nexport function getBlobFromSVGString(name: string, svgString: string, width: number, height: number, callback: Function, backgroundColor?: string) {\r\n    // get SVG string\r\n    // CREATE PNG\r\n    var format: any = format ? format : 'png';\r\n\r\n    // turn SVG in to PNG\r\n    var imgsrc: string = 'data:image/svg+xml;base64,' + btoa(unescape(encodeURIComponent(svgString))); // Convert SVG string to data URL\r\n\r\n    // Prepare canvas\r\n    var canvas: any = document.createElement(\"canvas\");\r\n    canvas.width = width;\r\n    canvas.height = height;\r\n\r\n    var context: any = canvas.getContext(\"2d\");\r\n    var image: any = new Image();\r\n    image.src = imgsrc;\r\n\r\n    image.onload = function () {\r\n        context.clearRect(0, 0, width, height);\r\n        if (backgroundColor) {\r\n            context.fillStyle = backgroundColor;\r\n            context.fillRect(0, 0, canvas.width, canvas.height);\r\n        }\r\n        context.drawImage(image, 0, 0, width, height);\r\n\r\n        canvas.toBlob(function (blob: any) {\r\n            callback(blob, name)\r\n        });\r\n    };\r\n\r\n}\r\n\r\nexport function getSVGString(svgNode: any) {\r\n    svgNode.setAttribute('xlink', 'http://www.w3.org/1999/xlink');\r\n    var cssStyleText = getCSSStyles(svgNode);\r\n    appendCSS(cssStyleText, svgNode);\r\n\r\n    var serializer = new XMLSerializer();\r\n    var svgString = serializer.serializeToString(svgNode);\r\n    svgString = svgString.replace(/(\\w+)?:?xlink=/g, 'xmlns:xlink='); // Fix root xlink without namespace\r\n    svgString = svgString.replace(/NS\\d+:href/g, 'xlink:href'); // Safari NS namespace fix\r\n\r\n    return svgString;\r\n\r\n    function getCSSStyles(parentElement: any) {\r\n        var selectorTextArr = [];\r\n\r\n        // Add Parent element Id and Classes to the list\r\n        selectorTextArr.push('#' + parentElement.id);\r\n        for (var c = 0; c < parentElement.classList.length; c++)\r\n            if (!contains('.' + parentElement.classList[c], selectorTextArr))\r\n                selectorTextArr.push('.' + parentElement.classList[c]);\r\n\r\n        // Add Children element Ids and Classes to the list\r\n        var nodes = parentElement.getElementsByTagName(\"*\");\r\n        for (var i = 0; i < nodes.length; i++) {\r\n            var id = nodes[i].id;\r\n            if (!contains('#' + id, selectorTextArr))\r\n                selectorTextArr.push('#' + id);\r\n\r\n            var classes = nodes[i].classList;\r\n            for (var c = 0; c < classes.length; c++)\r\n                if (!contains('.' + classes[c], selectorTextArr))\r\n                    selectorTextArr.push('.' + classes[c]);\r\n        }\r\n\r\n        // Extract CSS Rules\r\n        var extractedCSSText = \"\";\r\n        for (var i = 0; i < document.styleSheets.length; i++) {\r\n            var s = <CSSStyleSheet>document.styleSheets[i];\r\n\r\n            try {\r\n                if (!s.cssRules) continue;\r\n            } catch (e) {\r\n                if (e.name !== 'SecurityError') throw e; // for Firefox\r\n                continue;\r\n            }\r\n\r\n            var cssRules = s.cssRules;\r\n            for (var r = 0; r < cssRules.length; r++) {\r\n                var rule = <CSSStyleRule>cssRules[r];\r\n                if (contains(rule.selectorText, selectorTextArr))\r\n                    extractedCSSText += rule.cssText;\r\n            }\r\n        }\r\n\r\n\r\n        return extractedCSSText;\r\n\r\n        function contains(str: string, arr: any) {\r\n            return arr.indexOf(str) === -1 ? false : true;\r\n        }\r\n\r\n    }\r\n\r\n    function appendCSS(cssText: string, element: any) {\r\n        var styleElement = document.createElement(\"style\");\r\n        styleElement.setAttribute(\"type\", \"text/css\");\r\n        styleElement.innerHTML = cssText;\r\n        var refNode = element.hasChildNodes() ? element.children[0] : null;\r\n        element.insertBefore(styleElement, refNode);\r\n    }\r\n}\r\n\r\n\r\nexport function exportPNG(canvas: any, name: string) {\r\n    var dataURL: any = canvas.toDataURL('image/jpg', 1);\r\n    var blob: any = dataURItoBlob(dataURL);\r\n    // window.open(dataURL);\r\n\r\n    var fileNameToSaveAs: any = name + '_' + new Date().toUTCString() + '.png';\r\n    var downloadLink: any = document.createElement(\"a\")\r\n    downloadLink.download = fileNameToSaveAs;\r\n    downloadLink.href = (window as any).webkitURL.createObjectURL(blob);\r\n    downloadLink.click();\r\n}\r\n\r\n\r\n// returns a blob from a URL/URI\r\nfunction dataURItoBlob(dataURI: string): Blob {\r\n    // convert base64/URLEncoded data component to raw binary data held in a string\r\n    var byteString;\r\n    if (dataURI.split(',')[0].indexOf('base64') >= 0)\r\n        byteString = atob(dataURI.split(',')[1]);\r\n    else\r\n        byteString = unescape(dataURI.split(',')[1]);\r\n\r\n    // separate out the mime component\r\n    var mimeString = dataURI.split(',')[0].split(':')[1].split(';')[0];\r\n    console.log('mimeString', mimeString)\r\n\r\n    // write the bytes of the string to a typed array\r\n    var ia = new Uint8Array(byteString.length);\r\n    for (var i = 0; i < byteString.length; i++) {\r\n        ia[i] = byteString.charCodeAt(i);\r\n    }\r\n\r\n    return new Blob([ia], { type: mimeString });\r\n}\r\n\r\n\r\nvar msgBox;\r\nexport function showMessage(message: string, timeout: any) {\r\n    if ($('.messageBox'))\r\n        $('.messageBox').remove();\r\n\r\n    msgBox = $('<div id=\"div\" class=\"messageBox\" style=\"\\\r\n            width: 100%;\\\r\n            height: 100%;\\\r\n            background-color: #ffffff;\\\r\n            opacity: .9;\\\r\n            position: absolute;\\\r\n            top: 0px;\\\r\n            left: 0px;\"></div>');\r\n    msgBox.append('<div id=\"div\" style=\"\\\r\n            font-size: 20pt;\\\r\n            font-weight: bold;\\\r\n            font-family: \"Helvetica Neue\", Helvetica, sans-serif;\\\r\n            width: 500px;\\\r\n            padding-top: 300px;\\\r\n            text-align: center;\\\r\n            margin:auto;\">\\\r\n            <p>' + message + '</p></div>');\r\n    $('body').append(msgBox);\r\n    msgBox.click(function () {\r\n        $('.messageBox').remove();\r\n    })\r\n\r\n    if (timeout) {\r\n        // Automatically disappear\r\n        window.setTimeout(function () {\r\n            $('.messageBox').fadeOut(1000);\r\n        }, timeout);\r\n    }\r\n}\r\n\r\n\r\n","import { Node, Link, Time, DynamicGraph } from './dynamicgraph'\r\nimport * as reorder from 'reorder.js'\r\n\r\n/**\r\n* Calculates an ordering for the passed graph and time span\r\n* @param  {DynamicGraph} dgraph [description]\r\n* @param  {Time}         start  [description]\r\n* @param  {Time}         end    [description]\r\n* @return {[type]}              [description]\r\n*/\r\nexport function orderNodes(graph: DynamicGraph, config?: OrderingConfiguration): number[] {\r\n    var max: number = 0;\r\n    var similarityMatrix: number[][] = [];\r\n    var order: number[] = graph.nodes().ids();\r\n    var distance: any;\r\n    var nodes: Node[];\r\n    var links: Link[];\r\n    var start: Time;\r\n    var end: Time;\r\n\r\n    if (config != undefined) {\r\n        distance = config.distance ? config.distance : distance.manhattan;\r\n        nodes = config.nodes ? config.nodes : graph.nodes().toArray();\r\n        links = config.links ? config.links : graph.links().toArray();\r\n        start = config.start ? config.start : graph.startTime;\r\n        end = config.end ? config.end : graph.endTime;\r\n    }\r\n    else {\r\n        distance = distance.manhattan;\r\n        nodes = graph.nodes().toArray();\r\n        links = graph.links().toArray();\r\n        start = graph.startTime;\r\n        end = graph.endTime;\r\n    }\r\n\r\n    // init similarity matrix with all 0.\r\n    var arr: number[];\r\n    for (var i = 0; i < nodes.length; i++) {\r\n        arr = []\r\n        similarityMatrix.push(arr);\r\n        for (var j = 0; j < nodes.length; j++) {\r\n            similarityMatrix[i].push(0);\r\n        }\r\n    }\r\n    // fill matrix\r\n    var weight = 0;\r\n    var l: Link;\r\n    var s: number;\r\n    var t: number;\r\n    for (var i = 0; i < links.length; i++) {\r\n        weight = 0;\r\n        // check if nodes are in allowed nodes\r\n        s = nodes.indexOf(links[i].source)\r\n        t = nodes.indexOf(links[i].target)\r\n        if (s == -1 || t == -1)\r\n            continue;\r\n\r\n        // get weight in allowed time span                 \r\n        weight += links[i].weights(start, end).mean();\r\n        if (weight) {\r\n            similarityMatrix[s][t] = weight;\r\n            similarityMatrix[t][s] = weight;\r\n        } else {\r\n            console.log('weight', weight);\r\n        }\r\n    }\r\n\r\n    // Reorder\r\n    var leafOrder = reorder\r\n        .optimal_leaf_order()\r\n        .distance(distance)\r\n        .reorder(similarityMatrix);\r\n\r\n    leafOrder.forEach(function (lo: any, i: number) {\r\n        order[nodes[lo].id()] = i;\r\n    });\r\n\r\n    return order;\r\n}\r\n\r\n\r\n\r\nexport class OrderingConfiguration {\r\n    start: Time;\r\n    end: Time;\r\n    nodes: Node[] = [];\r\n    links: Link[] = [];\r\n    algorithm: string[] = [];\r\n    distance: string[] = [];\r\n\r\n    constructor(start: Time, end: Time) {\r\n        this.start = start,\r\n            this.end = end\r\n    }\r\n}\r\n","// import swiftSet from 'swiftset';\r\nimport { Motif, MotifTemplate } from './queries'\r\nimport { DynamicGraph, Link, Node } from './dynamicgraph'\r\nimport netClustering from 'netclustering'\r\n\r\nexport function findTemplate(nodes: Node[],\r\n    template: MotifTemplate,\r\n    config?: Object) {\r\n\r\n    var nodeCount = template.nodes.length;\r\n    var linkCount = template.links.length;\r\n    // test every node if it matches one of the nodes in the motif\r\n    var n;\r\n    var links\r\n    var candidateNodes = []\r\n    for (var i = 0; i < nodes.length; i++) {\r\n        links = nodes[i].links().toArray();\r\n        for (var j = 0; j < nodeCount; j++) {\r\n            for (var k = 0; k < linkCount; k++) {\r\n                if (template.links[k][0] == template.nodes[j])\r\n\r\n                    for (var l = 0; l < linkCount; l++) {\r\n                    }\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n}\r\n\r\n\r\nexport function findClusters(nodes: Node[], config?: Object) {\r\n    if (nodes.length == 0)\r\n        return []\r\n\r\n    var g: DynamicGraph = nodes[0].g\r\n    var links: any[] = nodes[0].g.links().toArray()\r\n    for (var i = 0; i < links.length; i++) {\r\n        links[i].value = links[i].weights().sum() // VALUE ???\r\n    }\r\n    var clusters = netClustering.cluster(nodes, links);\r\n\r\n    var motifs = []\r\n    var clusterArray = []\r\n    // replace ids with nodes\r\n\r\n    var clusterLinks: any[] = []\r\n    var cl;\r\n    var s, t\r\n    for (var c = 0; c < clusters.length; c++) {\r\n        clusterLinks = []\r\n        cl = clusters[c]\r\n        // exclude clusters with less than 4 nodes\r\n        if (cl.length < 4)\r\n            continue;\r\n\r\n        for (var j = 0; j < cl.length; j++) {\r\n            cl[j] = g.node(parseInt(cl[j]))\r\n        }\r\n        for (var i = 0; i < cl.length; i++) {\r\n            for (var j = i + 1; j < cl.length; j++) {\r\n                clusterLinks = clusterLinks.concat(cl[i].linksBetween(cl[j]).toArray())\r\n            }\r\n        }\r\n        motifs.push({ nodes: cl, links: clusterLinks })\r\n    }\r\n\r\n    return motifs;\r\n}\r\n\r\n/*\r\nexport function findCliques(nodes: Node[], config?: any) {\r\n    var cliques = [];\r\n    // var p=[];\r\n    var p = nodes.slice();\r\n    // for(var i = 0 ; i <nodes.length ; i++){\r\n    //     p.push(nodes[i].id());\r\n    // }\r\n    var r = [];\r\n    var x = [];\r\n\r\n    if (!config)\r\n        var config: any = {}\r\n\r\n    if (config.links == undefined)\r\n        config.links = nodes[0].g.links().toArray();\r\n\r\n    cliques = bronKerboschIterative(nodes, config);\r\n\r\n    // create motifs\r\n    var motifs = []\r\n    var cliqueLinks = []\r\n    for (var c = 0; c < cliques.length; c++) {\r\n        // do not consider triangles and dyads as cliques\r\n        if (cliques[c].length < 4)\r\n            continue;\r\n\r\n        cliqueLinks = []\r\n        for (var i = 0; i < cliques[c].length; i++) {\r\n            for (var j = i + 1; j < cliques[c].length; j++) {\r\n                cliqueLinks.push(cliques[c][i].linksBetween(cliques[c][j]).get(0))\r\n            }\r\n        }\r\n        motifs.push({ nodes: cliques[c], links: cliqueLinks })\r\n    }\r\n\r\n    return motifs;\r\n};\r\n*/\r\n\r\nfunction bronKerbosch(nodes: Node[], r: any[], p: any[], x: any[], cliques: any[], config: Object) {\r\n\r\n    if (p.length === 0 && x.length === 0) {\r\n        cliques.push(r);\r\n        return;\r\n    }\r\n\r\n    p.forEach(function (v) {\r\n        var tempR = r.splice(0);\r\n        tempR.push(v);\r\n        bronKerbosch(nodes, tempR, p.filter(function (temp) {\r\n            return v.neighbors().contains(temp);\r\n        }), x.filter(function (temp) {\r\n            return v.neighbors().contains(temp);\r\n        }), cliques, config);\r\n\r\n        p.splice(p.indexOf(v), 1);\r\n        if (x.indexOf(v) == -1)\r\n            x.push(v);\r\n    });\r\n}\r\n\r\n/*\r\nfunction bronKerboschIterative(nodes: Node[], config: Object): any[] {\r\n    var cliques: any[] = []\r\n\r\n    var stack: any[] = [];\r\n    var R: number = 0\r\n    var P: number = 1\r\n    var X: number = 2\r\n    stack.push([[], nodes, []])\r\n\r\n    var r: Node[];\r\n    var p: Node[];\r\n    var x: Node[];\r\n    var p2: Node[];\r\n    var x2: Node[];\r\n    var step: any[];\r\n    var newStep: any[];\r\n    var v: Node;\r\n    var count: number = 0;\r\n    while (stack.length > 0) {\r\n        count++;\r\n        step = stack.pop();\r\n        r = [].concat(step[R]);\r\n        p = [].concat(step[P]);\r\n        x = [].concat(step[X]);\r\n        if (p.length == 0\r\n            && x.length == 0) {\r\n            cliques.push(r.slice())\r\n        }\r\n        if (p.length > 0) {\r\n            v = p[0] // 'some vertex in P'\r\n\r\n            // P \\ v\r\n            p2 = p.slice()\r\n            p2.splice(p2.indexOf(v), 1)\r\n\r\n            // X u v                \r\n            x2 = x.slice()\r\n            if (x2.indexOf(v) == -1)\r\n                x2.push(v);\r\n\r\n            // R, P\\v, X u v                    \r\n            stack.push([r.slice(), p2, x2])\r\n\r\n            // R u v\r\n            if (r.indexOf(v) == -1)\r\n                r.push(v)\r\n\r\n            newStep = [r]\r\n\r\n            p = swiftSet.intersection(p2, v.neighbors().toArray())\r\n            p2 = []\r\n            for (var i = 0; i < p.length; i++) {\r\n                if (p2.indexOf(p[i]) == -1)\r\n                    p2.push(p[i])\r\n            }\r\n            newStep.push(p2)\r\n\r\n            x = swiftSet.intersection(x2, v.neighbors().toArray())\r\n            x2 = []\r\n            for (var i = 0; i < x.length; i++) {\r\n                if (x2.indexOf(x[i]) == -1)\r\n                    x2.push(x[i])\r\n            }\r\n            newStep.push(x2)\r\n\r\n            stack.push(newStep)\r\n        }\r\n    }\r\n\r\n\r\n    return cliques;\r\n}\r\n*/\r\n\r\nexport function findFullEgoNetwork(nodes: Node[], config?: Object): Motif[] {\r\n    var motifs: Motif[] = [];\r\n    var ns;\r\n    var ls;\r\n    var finalLinks;\r\n    var n;\r\n    for (var i = 0; i < nodes.length; i++) {\r\n        n = nodes[i];\r\n        finalLinks = [];\r\n        ns = n.neighbors().removeDuplicates()\r\n        ls = ns.links().removeDuplicates().toArray();\r\n        ns = ns.toArray().concat(n);\r\n        for (var j = 0; j < ls.length; j++) {\r\n            if (ls[j] == undefined)\r\n                continue;\r\n            if (ns.indexOf(ls[j].source) > -1 && ns.indexOf(ls[j].target) > -1) {\r\n                finalLinks.push(ls[j])\r\n            }\r\n        }\r\n        motifs.push(new Motif(ns, finalLinks))\r\n    }\r\n    return motifs;\r\n}\r\n\r\n/*\r\nexport function findStars(nodes: Node[], config?: any) {\r\n    if (!config)\r\n        var config: any = {}\r\n\r\n    if (config.minLinkCount == undefined)\r\n        config.minLinkCount = 5;\r\n\r\n    if (config.minNeighborCount == undefined) {\r\n        config.minNeighborCount = 5;\r\n        config.minLinkCount = 5;\r\n    }\r\n\r\n    if (config.links == undefined)\r\n        config.links = nodes[0].g.links().toArray();\r\n\r\n    var motifs: Motif[] = [];\r\n    var n: Node;\r\n    var lls: Link[]\r\n    var m: Motif;\r\n    var neighbors;\r\n    for (var i = 0; i < nodes.length; i++) {\r\n        n = nodes[i];\r\n        lls = n.links().toArray();\r\n        lls = swiftSet.intersection(lls, config.links);\r\n        if (lls.length <= config.minLinkCount)\r\n            continue\r\n\r\n        // count real neighbors\r\n        neighbors = []\r\n        for (var j = 0; j < lls.length; j++) {\r\n            if (neighbors.indexOf(lls[j].other(n)) == -1)\r\n                neighbors.push(lls[j].other(n))\r\n        }\r\n        if (neighbors.length <= config.minNeighborCount)\r\n            continue;\r\n\r\n        // create motif\r\n        m = new Motif([n], [])\r\n        for (var j = 0; j < lls.length; j++) {\r\n            m.links.push(lls[j])\r\n            m.nodes.push(lls[j].other(n))\r\n        }\r\n        motifs.push(m);\r\n    }\r\n    return motifs;\r\n}\r\n*/\r\n\r\n/*\r\n// returns triangles\r\nexport function findTriangles(nodes: Node[], config?: any): Motif[] {\r\n\r\n    if (!config)\r\n        var config: any = {}\r\n\r\n    if (config.links == undefined)\r\n        config.links = nodes[0].g.links().toArray();\r\n\r\n\r\n\r\n    var motifs: Motif[] = [];\r\n    var g: DynamicGraph = nodes[0].g;\r\n\r\n    var l: Link;\r\n    var s: Node, t: Node\r\n    var ns: Node[], nt: Node[];\r\n    var common: Node[]\r\n    var n: Node;\r\n    var ll1: Link[], ll2: Link[];\r\n    var found;\r\n    var m: Motif;\r\n    for (var i = 0; i < config.links.length; i++) {\r\n        s = config.links[i].source;\r\n        ns = s.neighbors().toArray();\r\n        ns = swiftSet.intersection(ns, nodes);\r\n        if (ns.length == 0)\r\n            continue;\r\n        t = config.links[i].target;\r\n        nt = t.neighbors().toArray();\r\n        nt = swiftSet.intersection(nt, nodes);\r\n        if (nt.length == 0)\r\n            continue;\r\n        common = swiftSet.intersection(ns, nt);\r\n        // remove s and t from common neighbors\r\n        common = swiftSet.difference(common, [s, t])\r\n        if (common.length == 0)\r\n            continue;\r\n\r\n        // create triangle motifs\r\n        for (var j = 0; j < common.length; j++) {\r\n            n = common[j];\r\n            ll1 = swiftSet.intersection(g.linksBetween(s, n).toArray(), config.links);\r\n            if (ll1.length == 0) continue;\r\n            ll2 = swiftSet.intersection(g.linksBetween(t, n).toArray(), config.links);\r\n            if (ll2.length == 0) continue;\r\n\r\n            ll1 = ll1.concat(ll2);\r\n            ll1.push(config.links[i]);\r\n            motifs.push(new Motif(\r\n                [s, t, n],\r\n                ll1\r\n            ))\r\n        }\r\n    }\r\n\r\n    return motifs;\r\n}\r\n*/\r\n\r\n\r\n\r\n\r\n//}\r\n","import {\r\n    getUrlVars\r\n} from './utils'\r\nimport { DataSet } from './datamanager'\r\nimport { DynamicGraph, DataManager, DataManagerOptions } from './dynamicgraph'\r\n\r\n/** A collection of Networkcube's  global function availeble\r\n * through networkcube.myFunc()\r\n * */\r\n\r\n// must agree with var of same name in DynamicGraph.initDynamicGraph()\r\nexport var TIME_FORMAT: string = 'YYYY-MM-DD hh:mm:ss';\r\n/**\r\n * Returns the networkcube standart time format\r\n * @return {[type]} [description]\r\n */\r\nexport function timeFormat() {\r\n    return TIME_FORMAT;\r\n}\r\n\r\n\r\n// GLOBAL VARIABLES\r\nvar dataManager: DataManager = new DataManager();\r\nvar session: string;\r\n\r\nexport function getSessionId() {\r\n    return session;\r\n}\r\n\r\nexport function setDataManagerOptions(options: DataManagerOptions): void {\r\n    dataManager.setOptions(options);\r\n}\r\n\r\nexport function isSessionCached(session: string, dataSetName: string) {\r\n    return dataManager.isSessionCached(session, dataSetName);\r\n}\r\n\r\n// DATA\r\n/**\r\n * Imports a data set into network cube.\r\n * @param  {string}  session [description]\r\n * @param  {DataSet} data    [description]\r\n * @return {[type]}          [description]\r\n */\r\nexport function importData(sessionName: string, data: DataSet) {\r\n    console.log('[n3] Import data', data.name);\r\n    session = sessionName;\r\n    dataManager.importData(sessionName, data);\r\n}\r\n\r\nexport function clearAllDataManagerSessionCaches() {\r\n    dataManager.clearAllSessionData();\r\n}\r\n\r\n\r\nexport function getDynamicGraph(dataName?: string, sessionName?: string): DynamicGraph {\r\n    var vars = getUrlVars();\r\n    if (!dataName)\r\n        dataName = (vars as any)['datasetName'];\r\n    if (!sessionName)\r\n        session = (vars as any)['session'];\r\n    else\r\n        session = sessionName;\r\n\r\n    return dataManager.getGraph(session, (dataName as string));\r\n}\r\n\r\n\r\n// VIEWS + VISUALIZATIONS\r\n\r\n\r\n// opens a new window and loads a visualization of type vistype,\r\n// // with the data set dataname\r\nexport function openVisualizationWindow(session: string, visUri: string, dataName: string) {\r\n    openView(session, visUri, dataName, false);\r\n}\r\n\r\n// opens a new tab and loads a visualization of type vistype,\r\n// // with the data set dataname\r\nexport function openVisualizationTab(session: string, visUri: string, dataName: string) {\r\n    openView(session, visUri, dataName, true);\r\n}\r\n\r\n// create a tab that shows one of the specified visualizations at a time\r\nexport function createTabVisualizations(parentId: string, visSpec: any[], session: string, dataName: string,\r\n    width: number,\r\n    height: number, visParams?: any) {\r\n\r\n    var parent = $('#' + parentId);\r\n\r\n    var tabDiv = $('<div></div>')\r\n    parent.append(tabDiv)\r\n\r\n    var visDiv = $('<div></div>')\r\n    parent.append(visDiv)\r\n\r\n\r\n    var ul = $('<ul class=\"networkcube-tabs\"\\\r\n                style=\"\\\r\n                    list-style-type: none;\\\r\n                    margin: 0;\\\r\n                    padding:2px;\\\r\n                    overflow: hidden;\\\r\n                    border: none;\\\r\n                    background-color: #f1f1f1;\"\\\r\n                ></ul>')\r\n    tabDiv.append(ul)\r\n\r\n    // create tabs and divs\r\n    for (var i = 0; i < visSpec.length; i++) {\r\n        visSpec[i].name = visSpec[i].name.replace(' ', '-')\r\n        ul.append($('<li style=\"float: left;\"><a style=\"\\\r\n                display: inline-block;\\\r\n                color: black;\\\r\n                margin-right: 8px;\\\r\n                margin-left: 8px;\\\r\n                padding: 5px;\\\r\n                text-align: left;\\\r\n                text-decoration: none;\\\r\n                transition: 0.3s;\\\r\n                font-weight: 800;\\\r\n                border: #fff 1px solid;\\\r\n                border-raduis: 5px;\\\r\n                font-size: 13px;\" href=\"#\" class=\"networkcube-tablinks\" onclick=\"networkcube.switchVisTab(event, \\''+ visSpec[i].name + '\\')\">' + visSpec[i].name + '</a></li>'))\r\n        visDiv.append($('<div id=\"networkcube-visTab-' + visSpec[i].name + '\" style=\"display:' + (i == 0 ? 'block' : 'none') + ';\" class=\"networkcube-visTabContent\"></div>'))\r\n        createVisualizationIFrame('networkcube-visTab-' + visSpec[i].name, visSpec[i].url, session, dataName, width, height, visParams)\r\n    }\r\n}\r\n\r\nexport function switchVisTab(evt: any, visName: string) {\r\n    // Declare all variables\r\n    var i, tabcontent, tablinks;\r\n\r\n    // Get all elements with class=\"tabcontent\" and hide them\r\n    tabcontent = document.getElementsByClassName(\"networkcube-visTabContent\") as HTMLCollectionOf<HTMLElement>;\r\n    for (i = 0; i < tabcontent.length; i++) {\r\n        tabcontent[i].style.display = \"none\";\r\n    }\r\n\r\n    // Get all elements with class=\"tablinks\" and remove the class \"active\"\r\n    tablinks = document.getElementsByClassName(\"networkcube-tablinks\");\r\n    for (i = 0; i < tablinks.length; i++) {\r\n        tablinks[i].className = tablinks[i].className.replace(\" active\", \"\");\r\n    }\r\n\r\n    // Show the current tab, and add an \"active\" class to the link that opened the tab\r\n    // ADD IF GETELEMENT IS NULL\r\n    var element =  document.getElementById('networkcube-visTab-' + visName);\r\n    if(element) {\r\n        element.style.display = \"block\";\r\n    }\r\n    evt.currentTarget.className += \" active\";\r\n}\r\n\r\n// returns an iframe that loads a visualization of type vistype,\r\n// with the data set dataname\r\nexport function createVisualizationIFrame(parentId: string, visUri: string, session: string, dataName: string,\r\n    width: number,\r\n    height: number, visParams?: any) {\r\n\r\n    $('#' + parentId)\r\n        .append('<iframe></iframe>')\r\n        .attr('width', width)\r\n        .attr('height', height)\r\n\r\n    var iframe = $('#' + parentId + '> iframe')\r\n\r\n    var visParamString = '';\r\n    for (var prop in visParams) {\r\n        visParamString += '&' + prop + '=' + visParams[prop];\r\n    }\r\n\r\n    if(!visUri.startsWith('http'))\r\n    {\r\n        if (window.location.port)\r\n            var server = location.protocol + '//' + window.location.hostname + ':' + window.location.port + '' + window.location.pathname;\r\n        else\r\n            var server = location.protocol + '//' + window.location.hostname + '' + window.location.pathname;\r\n        visUri = server + \"/node_modules/vistorian-\" + visUri + \"/web/index.html\";\r\n    }\r\n\r\n\r\n    iframe.attr('src', visUri + '?'\r\n        + 'session=' + session\r\n        + '&datasetName=' + dataName\r\n        + visParamString\r\n    );\r\n    if (width)\r\n        iframe.attr('width', width);\r\n    if (height)\r\n        iframe.attr('height', height)\r\n\r\n    if (visParams != undefined && visParams.hasOwnProperty('scrolling')) {\r\n        iframe.attr('scrolling', visParams.scrolling);\r\n    }\r\n\r\n    return iframe;\r\n}\r\n//\r\n// // Internal convenient function to open a window\r\nfunction openView(session: string, visUri: string, dataname: string, tab: boolean) \r\n{    \r\n    if(!visUri.startsWith('http'))\r\n    {\r\n        if (window.location.port)\r\n            var server = location.protocol + '//' + window.location.hostname + ':' + window.location.port + '' + window.location.pathname;\r\n        else\r\n            var server = location.protocol + '//' + window.location.hostname + '' + window.location.pathname;\r\n        visUri = server + \"/node_modules/vistorian-\" + visUri + \"/web/index.html\";\r\n    }\r\n\r\n    var url = visUri + '?session=' + session + '&datasetName=' + dataname;\r\n\r\n    if (tab)\r\n        window.open(url, '_blank');\r\n    else\r\n        window.open(url);\r\n}\r\n\r\nexport function getURLString(dataName: string) {\r\n    return '?session=' + session + '&datasetName=' + dataName;\r\n}\r\n\r\n/// UTILITY FUNCTIONS\r\nexport enum OrderType { Local, Global, Data };\r\n\r\nexport function isTrackingEnabled(): Boolean {\r\n    var value = localStorage.getItem(\"NETWORKCUBE_IS_TRACKING_ENABLED\");\r\n    return value == 'true' ? true : false;\r\n}\r\n\r\nexport function isTrackingSet(): Boolean {\r\n    var value = localStorage.getItem(\"NETWORKCUBE_IS_TRACKING_ENABLED\");\r\n    return value === null ? false : true;\r\n}\r\n\r\nexport function deleteData(dataSetName: string){\r\n    // deletes a network\r\n    getDynamicGraph(dataSetName).delete(dataManager);\r\n}\r\n","import {\r\n    DataSet, LinkSchema, NodeSchema\r\n} from './datamanager'\r\nimport {\r\n    DynamicGraph\r\n} from './dynamicgraph'\r\nimport * as moment from 'moment'\r\nimport * as main from './main'\r\n\r\nexport function loadDyson(url: string, callback: Function) \r\n{\r\n    d3.json(url, (data: any) => {\r\n        // create node table\r\n        var nodeTable = []\r\n        var nodeSchema = { id: 0, label: 1 }\r\n        var nodes = data.nodes;\r\n        for (var i = 0; i < nodes.length; i++) {\r\n            nodeTable.push([i, nodes[i].name]);\r\n        }\r\n        var linkTable = []\r\n        var linkSchema = { id: 0, source: 1, target: 2, weight: 3, time: 4 }\r\n        var times = data.times;\r\n        var m\r\n        for (var i = 0; i < times.length; i++) {\r\n            m = times[i].matrix;\r\n            for (var s = 0; s < m.length; s++) {\r\n                for (var t = 0; t < m.length; t++) {\r\n                    linkTable.push([s * m.length + t, s, t, m[s][t], i])\r\n                }\r\n            }\r\n        }\r\n        callback(new DataSet({\r\n            nodeTable: nodeTable,\r\n            linkTable: linkTable,\r\n            linkSchema: linkSchema,\r\n            nodeSchema: nodeSchema,\r\n            name: url\r\n        })\r\n        )\r\n    })\r\n\r\n}\r\n\r\n/** Loads a .csv file from the indicated url*/\r\n// does not check for locations\r\nexport function loadLinkTable(\r\n    url: string,\r\n    callBack: Function,\r\n    linkSchema: LinkSchema,\r\n    delimiter: string,\r\n    timeFormat?: string\r\n): void {\r\n\r\n    if (timeFormat == undefined)\r\n        timeFormat = 'x';\r\n\r\n\r\n    // Check if linkSchema is well defined: \r\n    if (linkSchema.source == undefined) {\r\n        console.error('[n3] Link Schema does not have -source- attribute. Import aborted.')\r\n        return\r\n    }\r\n    if (linkSchema.target == undefined) {\r\n        console.error('[n3] Link Schema does not have -target- attribute. Import aborted.')\r\n        return\r\n    }\r\n\r\n    $.get(url, (linkData) => {\r\n        var array = []\r\n        var rows = linkData.split('\\r\\n')\r\n        for(var i=1 ; i<rows.length ; i++){\r\n            array.push(rows[i].split(delimiter));\r\n        }\r\n        linkData = array;\r\n        // get references to tables\r\n        var nodeTable: any[] = [];\r\n\r\n        // var nodeIds: number[] = [];\r\n        var names: string[] = [];\r\n        var nodeTimes: number[][] = [];\r\n\r\n        var nodeSchema: NodeSchema = new NodeSchema(0);\r\n        nodeSchema.label = 1;\r\n        var id_source: number;\r\n        var id_target: number;\r\n        var name: string;\r\n\r\n        var linkTable: any[] = []\r\n        var newLinkSchema: LinkSchema = new LinkSchema(0, 1, 2);\r\n        // fill new link schema\r\n        var colCount = 3\r\n        for (var prop in linkSchema) {\r\n            if (prop != 'source' && prop != 'target')\r\n                (newLinkSchema as any)[prop] = colCount++;\r\n        }\r\n\r\n        // Create node table\r\n        // skip first row, as 1st row contains header information\r\n        linkData.shift();\r\n\r\n        var linkRow;\r\n        for (var i = 0; i < linkData.length; i++) {\r\n            if (linkData[i].length == 0 || linkData[i][0].length == 0) {\r\n                continue;\r\n            }\r\n            linkRow = new Array(colCount)\r\n            if (linkSchema.id == undefined)\r\n                linkRow[0] = linkTable.length;\r\n            else\r\n                linkRow[0] = linkData[i][linkSchema.id];\r\n\r\n            // remove whitespace in table entries\r\n\r\n            for (var j = 0; j < linkData[i].length; j++) {\r\n                linkData[i][j] = linkData[i][j].trim();\r\n            }\r\n\r\n            // sources\r\n            name = linkData[i][linkSchema.source];\r\n            if (names.indexOf(name) == -1) {\r\n                names.push(name);\r\n            }\r\n            id_source = names.indexOf(name);\r\n\r\n            // targets\r\n            name = linkData[i][linkSchema.target];\r\n            if (names.indexOf(name) == -1) {\r\n                names.push(name);\r\n            }\r\n            id_target = names.indexOf(name);\r\n\r\n            // replace node names by node indices\r\n            linkRow[newLinkSchema.source] = id_source\r\n            linkRow[newLinkSchema.target] = id_target\r\n\r\n            // format weight\r\n            if (linkSchema.weight != undefined) {\r\n                linkRow[newLinkSchema.weight] = Number(linkData[i][linkSchema.weight]);\r\n            }\r\n            // format time\r\n            if (linkSchema.time != undefined) {\r\n                linkRow[newLinkSchema.time] = moment.utc(linkData[i][linkSchema.time], timeFormat).format(main.timeFormat())\r\n            }\r\n            // copy remaining attributes (linkType, weight, etc..)\r\n            for (var prop in linkSchema) {\r\n                if (prop != 'source' && prop != 'target' && prop != 'time' && prop != 'weight') {\r\n                    linkRow[(newLinkSchema as any)[prop]] = linkData[i][(linkSchema as any)[prop]];\r\n                }\r\n            }\r\n            linkTable.push(linkRow)\r\n        }\r\n\r\n        // create node table from node name list\r\n        for (var i = 0; i < names.length; i++) {\r\n            nodeTable.push([i, names[i]])\r\n        }\r\n\r\n        var dataSet = new DataSet({\r\n            nodeTable: nodeTable,\r\n            linkTable: linkTable,\r\n            linkSchema: newLinkSchema,\r\n            nodeSchema: nodeSchema,\r\n            name: url\r\n        })\r\n        if (linkSchema.time != undefined) {\r\n            dataSet.timeFormat = main.timeFormat()\r\n        }\r\n\r\n        callBack(dataSet);\r\n\r\n    }, 'text')\r\n}\r\n\r\nexport function loadXML(url: string, callBack: Function): void {\r\n    var d: DataSet;\r\n    var url = url;\r\n    var dataset;\r\n    var callBack = callBack;\r\n\r\n    d3.xml(url, (data: any) => { // \"application/xml\",\r\n        var nodes = data.documentElement.getElementsByTagName(\"node\")\r\n        var nodeTable = [];\r\n        var nodeIds = []\r\n        var nodeSchema = { id: 0, label: 1, nodeType: 2 }\r\n        for (var i = 0; i < nodes.length; i++) {\r\n            nodeTable.push([nodeTable.length, nodes[i].getAttribute('name'), nodes[i].getAttribute('type')])\r\n            nodeIds.push(nodes[i].id)\r\n        }\r\n        var linkTable = [];\r\n        var line = [];\r\n        var link;\r\n        var linkSchema = new LinkSchema(0, 1, 2);\r\n        var links = data.documentElement.getElementsByTagName(\"edge\")\r\n        var s, t;\r\n        var sPrev, tPrev;\r\n        for (var i = 0; i < links.length; i++) {\r\n            s = nodeIds.indexOf(links[i].getAttribute('source'));\r\n            t = nodeIds.indexOf(links[i].getAttribute('through'));\r\n            if (sPrev == s && tPrev == t) {\r\n                continue;\r\n            }\r\n            sPrev = s;\r\n            tPrev = t;\r\n            linkTable.push([linkTable.length, s, t]);\r\n        }\r\n        callBack(new DataSet({\r\n            name: url.split('=')[0],\r\n            nodeTable: nodeTable,\r\n            linkTable: linkTable,\r\n            nodeSchema: nodeSchema,\r\n            linkSchema: linkSchema\r\n        }));\r\n    });\r\n}\r\n\r\n/** Loads a .json file from the indicated url. \r\n * The json must have a 'nodes/vertices' and a 'links/edge/connections/relations' array.\r\n*/\r\nexport function loadJson(url: string, callBack: Function, dataName?: string): void {\r\n    var d: DataSet;\r\n    var url = url;\r\n    var dataset;\r\n    var callBack = callBack;\r\n\r\n    d3.json(url, (data) => {\r\n        if (!data)\r\n            return;\r\n\r\n        // fill edge table\r\n        var links = data.links\r\n        if (!links)\r\n            links = data.edges;\r\n        if (!links)\r\n            links = data.connections;\r\n        if (!links)\r\n            links = data.relations;\r\n\r\n        var linkTable = [];\r\n        var line: any[] = [];\r\n        var link;\r\n        var linkSchema = { id: 0, source: 1, target: 2, weight: 3 };\r\n        var weight;\r\n        var linkUserProps = []\r\n        var prop;\r\n\r\n        // check for user-properties to complete schema\r\n        for (var i = 0; i < links.length; i++) {\r\n            link = links[i]\r\n            for (prop in link) {\r\n                if (link.hasOwnProperty(prop)\r\n                    && prop != 'id'\r\n                    && prop != 'linkType'\r\n                    && prop != 'time'\r\n                    && prop != 'name'\r\n                    && prop != 'source'\r\n                    && prop != 'target'\r\n                    && prop != 'weight'\r\n                    && prop != 'directed') {\r\n                    if ((linkSchema as any)[prop] == undefined) {\r\n                        linkUserProps.push(prop);\r\n                        (linkSchema as any)[prop] = 3 + linkUserProps.length;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        // collect data from links\r\n        for (var i = 0; i < links.length; i++) {\r\n            link = links[i]\r\n            weight = 1;\r\n            if (link.weight != undefined)\r\n                weight = link.weight;\r\n\r\n            line = [i, link.source, link.target, weight];\r\n            for (var p = 0; p < linkUserProps.length; p++) {\r\n                prop = linkUserProps[p];\r\n                if (link[prop] == undefined) {\r\n                    line.push(undefined)\r\n                } else {\r\n                    line.push(link[prop])\r\n                }\r\n            }\r\n            linkTable.push(line)\r\n        }\r\n\r\n        // fill node table\r\n        var nodes = data.nodes\r\n        if (!nodes)\r\n            nodes = data.vertices;\r\n\r\n        var node;\r\n        var nodeTable = [];\r\n        var locationTable: any[] = []; // location table in case there are locations\r\n        var locationSchema = { id: 0, longitude: 1, latitude: 2 }; // location table in case there are locations\r\n        var locationEntry = [];\r\n        var nodeSchema = { id: 0, label: 1 };\r\n        var nodeUserProperties = []\r\n        for (var i = 0; i < nodes.length; i++) {\r\n            node = nodes[i];\r\n            for (prop in node) {\r\n                if (node.hasOwnProperty(prop)\r\n                    && prop != 'id'\r\n                    && prop != 'label'\r\n                    && prop != 'time'\r\n                    && prop != 'name'\r\n                    && prop != 'nodeType'\r\n                    && prop != 'location'\r\n                    && prop != 'constructor') {\r\n                    if ((nodeSchema as any)[prop] == undefined) {\r\n                        nodeUserProperties.push(prop);\r\n                        (nodeSchema as any)[prop] = 1 + nodeUserProperties.length;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        for (var i = 0; i < nodes.length; i++) {\r\n            node = nodes[i]\r\n            line = [i];\r\n            if (node.name) {\r\n                line.push(node.name)\r\n            } else\r\n                if (node.label) {\r\n                    line.push(node.label)\r\n                } else {\r\n                    line.push('' + i)\r\n                }\r\n            // if(node.group){\r\n            //     line.push(node.group)\r\n            // }else{\r\n            //     line.push('0')\r\n            // }\r\n\r\n            // check for user-properties\r\n            for (var p = 0; p < nodeUserProperties.length; p++) {\r\n                prop = nodeUserProperties[p];\r\n                if (node[prop] == undefined) {\r\n                    line.push(undefined)\r\n                } else {\r\n                    line.push(node[prop])\r\n                }\r\n            }\r\n            nodeTable.push(line)\r\n        }\r\n\r\n        if (dataName == undefined)\r\n            dataName = url.split('=')[0];\r\n        callBack(new DataSet({\r\n            name: dataName,\r\n            nodeTable: nodeTable,\r\n            locationTable: locationTable,\r\n            linkTable: linkTable,\r\n            nodeSchema: nodeSchema,\r\n            locationSchema: locationSchema,\r\n            linkSchema: linkSchema\r\n        }));\r\n    })\r\n\r\n}\r\nexport function loadJsonList(url: string, callBack: Function): void {\r\n    var d: DataSet;\r\n    var url = url;\r\n    var dataset;\r\n    var callBack = callBack;\r\n\r\n    d3.json(url, (data) => {\r\n        if (!data)\r\n            return;\r\n\r\n        // fill node and link table\r\n        var linkTable = [];\r\n        var line = [];\r\n        var link;\r\n        var linkSchema = new LinkSchema(0, 1, 2);\r\n        var nodes = data;\r\n        var node;\r\n        var nodeTable = [];\r\n        var nodeSchema = new NodeSchema(0);\r\n        var nodeNames = []\r\n        for (var i = 0; i < nodes.length; i++) {\r\n            node = nodes[i]\r\n            line = [i];\r\n            if (node.name) {\r\n                line.push(node.name)\r\n                nodeSchema.label = 1;\r\n            }\r\n            if (node.label) {\r\n                line.push(node.name)\r\n                nodeSchema.label = 1;\r\n            }\r\n            nodeNames.push(node.name)\r\n            nodeTable.push(line)\r\n        }\r\n        // links\r\n        var s, t;\r\n        for (var i = 0; i < nodes.length; i++) {\r\n            for (var j = 0; j < nodes[i].imports.length; j++) {\r\n                s = nodeNames.indexOf(nodes[i].name);\r\n                t = nodeNames.indexOf(nodes[i].imports[j])\r\n                if (s == -1 || t == -1)\r\n                    console.error('---');\r\n                else\r\n                    linkTable.push([linkTable.length, s, t]);\r\n            }\r\n        }\r\n\r\n        callBack(new DataSet({\r\n            name: url.split('=')[0],\r\n            nodeTable: nodeTable,\r\n            linkTable: linkTable,\r\n            nodeSchema: nodeSchema,\r\n            linkSchema: linkSchema\r\n        }));\r\n    })\r\n\r\n}\r\n\r\n/** Loads a .graphML file from the indicated url*/\r\nfunction loadGraphML(url: string, callBack: Function): void {\r\n\r\n}\r\n\r\n/** Loads a .tables file from the indicated url.\r\n*/\r\nfunction loadTables(url: string, callBack: Function): void {\r\n}\r\n\r\nexport function loadNCube(url: string, callBack: Function): void {\r\n    var d: DataSet;\r\n    var url = url;\r\n    var dataset;\r\n    var callBack = callBack;\r\n\r\n    d3.json(url, (data) => {\r\n\r\n        var nodeTable: any[][] = [];\r\n        var linkTable: any[][] = [];\r\n\r\n        var nodeSchema: NodeSchema = new NodeSchema(0);\r\n        nodeSchema.id = 0;\r\n        nodeSchema.label = 1;\r\n        nodeSchema.nodeType = 2;\r\n\r\n        // create node table:\r\n        for (var i = 0; i < data.nodes.length; i++) {\r\n            console.log('data.nodes[i].name.substring(0,3)', data.nodes[i].name.substring(0, 3))\r\n            nodeTable.push(\r\n                [\r\n                    data.nodes[i].nodeId,\r\n                    data.nodes[i].name,\r\n                    data.nodes[i].name.substring(0, 3) // create node type for brain regions\r\n                ]\r\n            )\r\n        }\r\n\r\n        var linkSchema: LinkSchema = new LinkSchema(0, 1, 2);\r\n        linkSchema.id = 0;\r\n        linkSchema.source = 1;\r\n        linkSchema.target = 2;\r\n        linkSchema.time = 3;\r\n        linkSchema.weight = 4;\r\n\r\n        // create link table\r\n        // data.edges = data.edges.slice(0,20000);\r\n        for (var i = 0; i < data.edges.length; i++) {\r\n            linkTable.push(\r\n                [\r\n                    data.edges[i].edgeId,\r\n                    data.edges[i].sourceNodeId,\r\n                    data.edges[i].targetNodeId,\r\n                    moment.utc().add(data.edges[i].timeIndex, 'seconds').format('YYYY-MM-DD hh:mm:ss'),\r\n                    data.edges[i].weight\r\n                ]\r\n            )\r\n        }\r\n\r\n        callBack(new DataSet({\r\n            name: url.split('=')[0],\r\n            nodeTable: nodeTable,\r\n            linkTable: linkTable,\r\n            nodeSchema: nodeSchema,\r\n            linkSchema: linkSchema\r\n        }))\r\n    });\r\n}\r\n\r\nexport function loadPajek(url: string, callBack: Function): void {\r\n    var d: DataSet;\r\n    var url = url;\r\n    var dataset;\r\n    var callBack = callBack;\r\n\r\n    $.get(url, (data) => {\r\n        var lines = data.split('\\n')\r\n        var nodeTable = []\r\n        var nodeSchema = { id: 0, label: 1 }\r\n        var linkTable = []\r\n        var linkSchema = { id: 0, source: 1, target: 2, directed: 3 }\r\n        var parseType = ''\r\n        var line;\r\n        for (var i = 0; i < lines.length; i++) {\r\n            line = lines[i];\r\n\r\n            // define data type\r\n            if (line.indexOf('*Vertices') > -1) {\r\n                parseType = 'nodes';\r\n                continue;\r\n            } else\r\n                if (line.indexOf('*Arcs') > -1) {\r\n                    parseType = 'undirectedLinks';\r\n                    continue;\r\n                } else\r\n                    if (line.indexOf('*Edges') > -1) {\r\n                        parseType = 'directedLinks';\r\n                        continue;\r\n                    }\r\n\r\n            // prepare and clean line\r\n            line = line.trim();\r\n            line = line.split(' ')\r\n            for (var j = 0; j < line.length; j) {\r\n                if (line[j].length == 0) {\r\n                    line.splice(j, 1)\r\n                } else {\r\n                    j++;\r\n                }\r\n            }\r\n            if (line.length == 0)\r\n                continue;\r\n\r\n            // parse data\r\n            if (parseType.indexOf('nodes') > -1) {\r\n                nodeTable.push([nodeTable.length, line[1]]);\r\n            } else\r\n                if (parseType.indexOf('undirectedLinks') > -1) {\r\n                    linkTable.push([linkTable.length, parseInt(line[0]) - 1, parseInt(line[1]) - 1, false]);\r\n                } else\r\n                    if (parseType.indexOf('directedLinks') > -1) {\r\n                        linkTable.push([linkTable.length, parseInt(line[0]) - 1, parseInt(line[1]) - 1, true]);\r\n                    }\r\n        }\r\n\r\n        callBack(new DataSet({\r\n            name: url.split('=')[0],\r\n            nodeTable: nodeTable,\r\n            linkTable: linkTable,\r\n            nodeSchema: nodeSchema,\r\n            linkSchema: linkSchema\r\n        }))\r\n    });\r\n}\r\n\r\nexport function loadMat(url: string, callBack: Function): void {\r\n    var d: DataSet;\r\n    var url = url;\r\n    var dataset;\r\n    var callBack = callBack;\r\n\r\n    $.get(url, (data) => {\r\n        var lines = data.split('\\n')\r\n        var nodeTable = []\r\n        var nodeSchema = { id: 0, label: 1 }\r\n        var linkTable = []\r\n        var linkSchema = { id: 0, source: 1, target: 2 }\r\n        var parseType = '';\r\n        var line;\r\n        var rowCount = 0;\r\n        var currRow = 0;\r\n        for (var i = 0; i < lines.length; i++) {\r\n            line = lines[i];\r\n\r\n            // define data type\r\n            if (line.indexOf('ROW LABELS') > -1) {\r\n                parseType = 'rows';\r\n                continue;\r\n            } else\r\n                if (line.indexOf('COLUMN LABELS') > -1) {\r\n                    parseType = 'cols';\r\n                    continue;\r\n                } else\r\n                    if (line.indexOf('DATA:') > -1) {\r\n                        parseType = 'links';\r\n                        continue;\r\n                    }\r\n            if (parseType.length == 0)\r\n                continue;\r\n\r\n            line = line.trim();\r\n            line = line.split(' ');\r\n            if (parseType.indexOf('rows') > -1) {\r\n                nodeTable.push([nodeTable.length, line[0]])\r\n                rowCount++;\r\n            } else\r\n                if (parseType.indexOf('cols') > -1) {\r\n                    if (line[0].indexOf(nodeTable[0][1] > -1)) {\r\n                        parseType = '';\r\n                        rowCount = 0;\r\n                        continue;\r\n                    }\r\n                    nodeTable.push([nodeTable.length, line[0]])\r\n                } else\r\n                    if (parseType.indexOf('links') > -1) {\r\n                        for (var j = 0; j < line.length; j++) {\r\n                            if (parseInt(line[j]) == 1) {\r\n                                linkTable.push([linkTable.length, currRow, rowCount + 1])\r\n                            }\r\n                        }\r\n                        currRow++;\r\n                    }\r\n        }\r\n        callBack(new DataSet({\r\n            name: url.split('=')[0],\r\n            nodeTable: nodeTable,\r\n            linkTable: linkTable,\r\n            nodeSchema: nodeSchema,\r\n            linkSchema: linkSchema\r\n        }))\r\n    })\r\n}\r\n\r\n\r\nexport function loadGEDCOM(url: string, callBack: Function): void {\r\n    var d: DataSet;\r\n    var url = url;\r\n    var dataset;\r\n    var callBack = callBack;\r\n    var nodeTable: any[] = []\r\n    var nodeSchema = { id: 0, label: 1, nodeType: 2 }\r\n    var linkTable: any[] = []\r\n    var linkSchema = { id: 0, source: 1, target: 2 }\r\n    var line;\r\n    var s, t;\r\n\r\n    $.get(url, (data) => {\r\n        data = data.split('\\n');\r\n        var singleLine: any;\r\n        var line: any[];\r\n        var currPersonId;\r\n        var personIds = [];\r\n        var personSex = [];\r\n        var familiyIds: any[] = []\r\n        var familiyChildren: any[][] = []\r\n        var familiyHusband: any[] = []\r\n        var familiyWife: any[] = []\r\n        for (var i = 0; i < data.length; i++) {\r\n            singleLine = data[i].replace(/@/g, '');\r\n            line = singleLine.split(' ')\r\n            // parsing persons\r\n            if (line.length < 3)\r\n                continue;\r\n\r\n            if (parseInt(line[0]) == 0 && line[2].indexOf('INDI') > -1) {\r\n                personIds.push(line[1].trim());\r\n                personSex.push('');\r\n            }\r\n            else\r\n                if (parseInt(line[0]) == 1 && line[1].indexOf('SEX') > -1) {\r\n                    personSex[personSex.length - 1] = line[2].trim();\r\n                }\r\n                else\r\n                    if (parseInt(line[0]) == 0 && line[2].indexOf('FAM') > -1) {\r\n                        familiyIds.push(line[1].trim());\r\n                        familiyChildren.push([])\r\n                        familiyHusband.push(undefined)\r\n                        familiyWife.push(undefined)\r\n                    }\r\n                    else\r\n                        if (parseInt(line[0]) == 1 && line[1].indexOf('CHIL') > -1) {\r\n                            familiyChildren[familiyChildren.length - 1].push(line[2].trim());\r\n                        }\r\n                        else\r\n                            if (parseInt(line[0]) == 1 && line[1].indexOf('HUSB') > -1) {\r\n                                familiyHusband[familiyChildren.length - 1] = line[2].trim();\r\n                            }\r\n                            else\r\n                                if (parseInt(line[0]) == 1 && line[1].indexOf('WIFE') > -1) {\r\n                                    familiyWife[familiyChildren.length - 1] = line[2].trim();\r\n                                }\r\n        }\r\n\r\n        for (var fi = 0; fi < personIds.length; fi++) {\r\n            nodeTable.push([fi, personIds[fi], personSex[fi]]);\r\n        }\r\n\r\n\r\n        var hi, wi, ci\r\n        var nodeNames = [];\r\n        for (var fi = 0; fi < familiyIds.length; fi++) {\r\n            hi = personIds.indexOf(familiyHusband[fi]);\r\n            wi = personIds.indexOf(familiyWife[fi]);\r\n            console.log('-->', hi, wi, familiyHusband[fi], familiyWife[fi])\r\n            for (var i = 0; i < familiyChildren[fi].length; i++) {\r\n                ci = personIds.indexOf(familiyChildren[fi][i]);\r\n                if (ci == undefined || ci == -1)\r\n                    continue;\r\n                if (hi != undefined && hi > -1)\r\n                    linkTable.push([linkTable.length, hi, ci])\r\n                if (wi != undefined && wi > -1)\r\n                    linkTable.push([linkTable.length, wi, ci])\r\n            }\r\n        }\r\n\r\n        callBack(new DataSet({\r\n            name: url.split('=')[0],\r\n            nodeTable: nodeTable,\r\n            linkTable: linkTable,\r\n            nodeSchema: nodeSchema,\r\n            linkSchema: linkSchema\r\n        }))\r\n    })\r\n}\r\n\r\nexport function loadLinkList(url: string, callBack: Function): void {\r\n    var d: DataSet;\r\n    var url = url;\r\n    var dataset;\r\n    var callBack = callBack;\r\n\r\n    $.get(url, (data) => {\r\n        var lines = data.split('\\n')\r\n        var nodeTable = []\r\n        var nodeSchema = { id: 0, label: 1 }\r\n        var linkTable = []\r\n        var linkSchema = { id: 0, source: 1, target: 2, weight: 3 };\r\n        var line\r\n        var s, t;\r\n        for (var i = 0; i < lines.length; i++) {\r\n            line = lines[i];\r\n            if (line.indexOf('#') == -1) {\r\n                break;\r\n            }\r\n        }\r\n        var DEL = ' ';\r\n        if (lines[i].indexOf(',') > -1)\r\n            DEL = ','\r\n        else if (lines[i].indexOf('\\t') > -1)\r\n            DEL = '\\t'\r\n\r\n        var nodeLabels = [];\r\n        var weight;\r\n        for (i; i < lines.length; i++) {\r\n            line = lines[i]\r\n            line = line.split(DEL);\r\n            for (var j = 0; j < line.length; j) {\r\n                if (line[j].length == 0) {\r\n                    line.splice(j, 1)\r\n                } else {\r\n                    j++;\r\n                }\r\n            }\r\n            if (line.length < 2)\r\n                continue;\r\n\r\n            s = line[0].toLowerCase();\r\n            if (s == undefined || s == '')\r\n                continue;\r\n\r\n            var si = nodeLabels.indexOf(s)\r\n            if (si == -1) {\r\n                si = nodeLabels.length;\r\n                nodeLabels.push(s)\r\n            }\r\n\r\n            t = line[1].toLowerCase();\r\n            if (t == undefined)\r\n                continue;\r\n            t = t.trim();\r\n            var ti = nodeLabels.indexOf(t)\r\n            if (ti == -1) {\r\n                ti = nodeLabels.length;\r\n                nodeLabels.push(t)\r\n            }\r\n\r\n            weight = 1;\r\n            linkTable.push([linkTable.length, si, ti, weight])\r\n\r\n        }\r\n        for (i = 0; i <= nodeLabels.length; i++) {\r\n            nodeTable.push([i, nodeLabels[i] + '']);\r\n        }\r\n\r\n        callBack(new DataSet({\r\n            name: url.split('=')[0],\r\n            nodeTable: nodeTable,\r\n            linkTable: linkTable,\r\n            nodeSchema: nodeSchema,\r\n            linkSchema: linkSchema\r\n        }))\r\n    })\r\n}\r\n\r\nexport function loadMatrix(url: string, callBack: Function): void {\r\n    var d: DataSet;\r\n    var url = url;\r\n    var dataset;\r\n    var callBack = callBack;\r\n\r\n    $.get(url, (data) => {\r\n        var lines = data.split('\\n')\r\n        var nodeTable = []\r\n        var nodeSchema = { id: 0, label: 1 }\r\n        var linkTable = []\r\n        var linkSchema = { id: 0, source: 1, target: 2 }\r\n        var parseType = '';\r\n        var line;\r\n        var rowCount = 0;\r\n        var currRow = 0;\r\n        var nodeNames = [];\r\n        var label\r\n        // get nodes from rows\r\n        var line = lines[0].trim().split(',')\r\n        for (var i = 0; i < line.length; i++) {\r\n            label = line[i].trim();\r\n            nodeTable.push([nodeTable.length, label])\r\n            nodeNames.push(label)\r\n        }\r\n        var t;\r\n        for (var i = 1; i < lines.length; i++) {\r\n            line = lines[i];\r\n            line = line.trim();\r\n            line = line.split(',');\r\n            t = nodeNames.indexOf(line[0].trim())\r\n            if (t == -1) {\r\n                console.error('Node', line[0], 'not defined')\r\n                continue;\r\n            }\r\n            for (var j = 1; j < line.length; j++) {\r\n                if (line[j].length > 0 && parseInt(line[j].replace(/\\s/g, '')) > 300000) {\r\n                    linkTable.push([linkTable.length, t, j - 1])\r\n                }\r\n            }\r\n        }\r\n        console.log('---->nodes found:', nodeTable.length)\r\n        console.log('---->links found:', linkTable.length)\r\n        callBack(new DataSet({\r\n            name: url.split('=')[0],\r\n            nodeTable: nodeTable,\r\n            linkTable: linkTable,\r\n            nodeSchema: nodeSchema,\r\n            linkSchema: linkSchema\r\n        }))\r\n    })\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n/// EXPORTERS\r\n\r\n/** Returns a csv table representation of this graph. It should be the same as\r\n * the input table format (fix!) \r\n * Currently: returns simple list of node index pairs.\r\n */\r\nexport function exportCSV(graph: DynamicGraph): string {\r\n    var csv: string = '';\r\n    var DEL = ',';\r\n    var ST = '';\r\n    var BR = '\\n';\r\n    for (var i = 0; i < graph.links().length; i++) {\r\n        var graph_link = graph.link(i);\r\n        if (graph_link != undefined) {\r\n            csv += ST + graph_link.source.id() + ST + DEL\r\n                + ST + graph_link.target.id() + ST + BR\r\n        }\r\n    }\r\n    return csv;\r\n}\r\n\r\n\r\n\r\n/// HELPER FUNCTIONS\r\n\r\n/** Downloads a string as file.*/\r\nexport function downloadText(text: string, filename: string) {\r\n    var textFileAsBlob = new Blob([text], { type: 'text/text' });\r\n    var fileNameToSaveAs = filename;\r\n    var downloadLink = document.createElement(\"a\")\r\n    downloadLink.download = fileNameToSaveAs;\r\n    downloadLink.href = (window as any).webkitURL.createObjectURL(textFileAsBlob);\r\n    downloadLink.click();\r\n}\r\n","import { DynamicGraph, Link, Node, Location, IDCompound } from './dynamicgraph'\r\n\r\nexport function searchForTerm(term: string, dgraph: DynamicGraph, type?: string): IDCompound {\r\n\tvar terms = term.toLowerCase().split(',');\r\n\r\n\tvar result: IDCompound = new IDCompound();\r\n\r\n\r\n\tfor (var i = 0; i < terms.length; i++) {\r\n\t\tterm = terms[i].trim();\r\n\t\tif (!type || type == 'node')\r\n\t\t\tresult.nodeIds = result.nodeIds.concat(dgraph.nodes().filter(\r\n\t\t\t\t(e: Node) =>\r\n\t\t\t\t\te.label().toLowerCase().indexOf(term) > -1\r\n\t\t\t\t\t|| e.nodeType().toLowerCase().indexOf(term) > -1\r\n\t\t\t).ids());\r\n\t\tif (!type || type == 'link')\r\n\t\t\tresult.linkIds = result.linkIds.concat(dgraph.links().filter(\r\n\t\t\t\t(e: Link) =>\r\n\t\t\t\t\te.source.label().toLowerCase().indexOf(term) > -1\r\n\t\t\t\t\t|| e.target.label().toLowerCase().indexOf(term) > -1\r\n\t\t\t\t\t|| e.linkType().indexOf(term) > -1\r\n\t\t\t).ids());\r\n\t\tif (!type || type == 'locations')\r\n\t\t\tresult.locationIds = result.locationIds.concat(dgraph.locations().filter(\r\n\t\t\t\t(e: Location) =>\r\n\t\t\t\t\te.label().toLowerCase().indexOf(term) > -1\r\n\t\t\t).ids());\r\n\t}\r\n\treturn result;\r\n}\r\n\r\n\r\n\r\n/// FILTERS\r\n\r\nexport interface IFilter {\r\n\ttest(o: any): boolean;\r\n}\r\n\r\nclass StringContainsFilter {\r\n\tpattern: string;\r\n\tconstructor(pattern: string) {\r\n\t\tthis.pattern = pattern;\r\n\t}\r\n\r\n\ttest(word: any) {\r\n\t\tconsole.log('contains:', word, this.pattern)\r\n\t\treturn word.indexOf(this.pattern) > -1;\r\n\t}\r\n}\r\n\r\n","import { makeIdCompound, sortByPriority, ElementCompound } from './utils'\r\nimport { Selection } from './datamanager'\r\nimport { Time, DynamicGraph, dgraphReplacer, dgraphReviver, IDCompound, copyTimeseriesPropsShallow } from './dynamicgraph'\r\nimport { getDynamicGraph } from './main'\r\nimport { searchForTerm } from './search'\r\n\r\nexport var MESSAGE_HIGHLIGHT = 'highlight';\r\nexport var MESSAGE_SELECTION = 'selection';\r\nexport var MESSAGE_TIME_RANGE = 'timeRange';\r\nexport var MESSAGE_SELECTION_CREATE = 'createSelection';\r\nexport var MESSAGE_SELECTION_DELETE = 'deleteSelection';\r\nexport var MESSAGE_SELECTION_SET_CURRENT = 'setCurrentSelectionId';\r\nexport var MESSAGE_SELECTION_COLORING = 'setSelectionColor';\r\nexport var MESSAGE_SELECTION_SET_COLORING_VISIBILITY = 'selectionColoring';\r\nexport var MESSAGE_SELECTION_FILTER = 'selectionFilter';\r\nexport var MESSAGE_SELECTION_PRIORITY = 'selectionPriority'\r\nexport var MESSAGE_SEARCH_RESULT = 'searchResult';\r\nexport var MESSAGE_SET_STATE= 'SET_STATE';\r\nexport var MESSAGE_GET_STATE= 'GET_STATE';\r\nexport var MESSAGE_STATE_CREATED= 'STATE_CREATED';\r\n\r\nvar MESSENGER_PROPAGATE: boolean = true;\r\n\r\n\r\nvar MESSAGE_HANDLERS: string[] = [\r\n    MESSAGE_HIGHLIGHT,\r\n    MESSAGE_SELECTION,\r\n    MESSAGE_TIME_RANGE,\r\n    MESSAGE_SELECTION_CREATE,\r\n    MESSAGE_SELECTION_DELETE,\r\n    MESSAGE_SELECTION_SET_CURRENT,\r\n    MESSAGE_SELECTION_SET_COLORING_VISIBILITY,\r\n    MESSAGE_SELECTION_FILTER,\r\n    MESSAGE_SELECTION_PRIORITY,\r\n    MESSAGE_SEARCH_RESULT,\r\n    MESSAGE_SELECTION_COLORING,\r\n    MESSAGE_SET_STATE,\r\n    MESSAGE_GET_STATE,\r\n    MESSAGE_STATE_CREATED\r\n]\r\n\r\n\r\n\r\nvar messageHandlers: MessageHandler[] = [];\r\n\r\n// contains handlers for passing messages to the\r\n// visualization.\r\nclass MessageHandler {\r\n\r\n    /* DEFAULT VALUES ?? */\r\n    highlightUpdate: Function = () => { return; };\r\n    selectionUpdate: Function = () => { return; };\r\n\r\n}\r\nvar messageHandler: MessageHandler = new MessageHandler();\r\n\r\nvar previousMessageId: number = -1;\r\n\r\n// register an event handler\r\nexport function addEventListener(messageType: string, handler: Function) {\r\n    (messageHandler as any)[messageType] = handler;\r\n}\r\n\r\nexport function setDefaultEventListener(handler: Function) {\r\n    for (var i = 0; i < MESSAGE_HANDLERS.length; i++) {\r\n        (messageHandler as any)[MESSAGE_HANDLERS[i]] = handler;\r\n    }\r\n}\r\n\r\n// create internal listener to storage events\r\nwindow.addEventListener('storage', receiveMessage, false);\r\n\r\nexport class Message {\r\n    id: number;\r\n    type: string;\r\n    body: any;\r\n    constructor(type: string) {\r\n        this.id = Math.random();\r\n        this.type = type;\r\n        this.body = null;\r\n    }\r\n}\r\n\r\n/////////////////////////////\r\n/// NON-SPECIFIC MESSAGES ///\r\n/////////////////////////////\r\n\r\n\r\nexport function sendMessage(type: string, body: any) {\r\n    var m = new Message(type)\r\n    m.body = body;\r\n    distributeMessage(m, true);\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/////////////////////////\r\n/// SPECIFIC MESSAGES ///\r\n/////////////////////////\r\n\r\nfunction isEmpty(obj: any) {\r\n    for (var key in obj) {\r\n        if (obj.hasOwnProperty(key))\r\n            return false;\r\n    }\r\n    return true;\r\n}\r\n\r\n\r\n// HIGHLIGHT\r\nexport function highlight(action: string, elementCompound?: ElementCompound): void {\r\n\r\n    var g: DynamicGraph = getDynamicGraph();\r\n    var idCompound: IDCompound = makeIdCompound(elementCompound);\r\n\r\n\r\n    var highlightAnyElement = false;\r\n    if (elementCompound != null && !isEmpty(elementCompound)) {\r\n        highlightAnyElement = true;\r\n    }\r\n\r\n    if (!elementCompound == undefined)\r\n        action = 'reset';\r\n\r\n    // create message\r\n    var m: HighlightMessage;\r\n    m = new HighlightMessage(\r\n        action,\r\n        idCompound);\r\n\r\n    distributeMessage(m);\r\n\r\n\r\n    if (elementCompound && g.currentSelection_id > 0) {\r\n        $('body').css('cursor', 'url(/networkcube/icons/brush.png),auto')\r\n    } else {\r\n        $('body').css('cursor', 'auto')\r\n    }\r\n}\r\n\r\nexport class HighlightMessage extends Message {\r\n    action: string\r\n    idCompound: IDCompound;\r\n\r\n    constructor(action: string, idCompound?: IDCompound) {\r\n        super(MESSAGE_HIGHLIGHT);\r\n        this.action = action;\r\n        this.idCompound = idCompound != undefined ? idCompound : new IDCompound(); // WHAT HAPPEND IF IT IS UNDEFINED??\r\n    }\r\n}\r\n\r\n\r\n\r\n// SELECTION MESSAGES\r\n\r\nexport function selection(action: string, compound: ElementCompound, selectionId?: number): void {\r\n    var g: DynamicGraph = getDynamicGraph();\r\n    if (!selectionId)\r\n        selectionId = g.currentSelection_id;\r\n    var selection = g.getSelection(selectionId)\r\n\r\n    var idCompound: IDCompound = makeIdCompound(compound);\r\n\r\n    var m: SelectionMessage = new SelectionMessage(\r\n        action,\r\n        idCompound,\r\n        selectionId);\r\n\r\n    distributeMessage(m);\r\n}\r\n\r\nexport class SelectionMessage extends Message {\r\n    action: string\r\n    selectionId: number;\r\n    idCompound: IDCompound;\r\n\r\n    constructor(action: string, idCompound: IDCompound, selectionId?: number) {\r\n        super(MESSAGE_SELECTION);\r\n        this.action = action;\r\n        this.idCompound = idCompound;\r\n        this.selectionId = selectionId != undefined ? selectionId : 0 ; // WHAT HAPPEND IF IT IS UNDEFINED?\r\n    }\r\n}\r\n\r\n\r\n// TIME CHANGE MESSAGES\r\n\r\nexport function timeRange(startUnix: number, endUnix: number, single: Time, propagate?: boolean) {\r\n    var m: TimeRangeMessage = new TimeRangeMessage(startUnix, endUnix);\r\n    if (propagate == undefined)\r\n        propagate = false;\r\n\r\n    if (propagate)\r\n        distributeMessage(m); // notifies all views, including this\r\n    else\r\n        processMessage(m);\r\n}\r\n\r\nexport class TimeRangeMessage extends Message {\r\n    startUnix: number;\r\n    endUnix: number;\r\n\r\n    constructor(start: number, end: number) {\r\n        super(MESSAGE_TIME_RANGE);\r\n        this.startUnix = start;\r\n        this.endUnix = end;\r\n    }\r\n}\r\n\r\n\r\n/// CREATE NEW SELECTION\r\n\r\nexport function createSelection(type: string, name: string) {\r\n\r\n    var g: DynamicGraph = getDynamicGraph();\r\n    var b = g.createSelection(type);\r\n    b.name = name;\r\n    var m = new CreateSelectionMessage(b)\r\n    distributeMessage(m, false);\r\n\r\n    return b;\r\n}\r\nexport class CreateSelectionMessage extends Message {\r\n    selection: Selection;\r\n    constructor(b: Selection) {\r\n        super(MESSAGE_SELECTION_CREATE)\r\n        this.selection = b;\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n// SET CURRENT SELECTION\r\n\r\n\r\nexport function setCurrentSelection(b: Selection) {\r\n\r\n    var g: DynamicGraph = getDynamicGraph();\r\n    var m = new SetCurrentSelectionIdMessage(b);\r\n    distributeMessage(m);\r\n}\r\nexport class SetCurrentSelectionIdMessage extends Message {\r\n    selectionId: number\r\n    constructor(b: Selection) {\r\n        super(MESSAGE_SELECTION_SET_CURRENT)\r\n        this.selectionId = b.id;\r\n    }\r\n}\r\n\r\n// CHANGE SELECTION COLOR\r\n\r\nexport function showSelectionColor(selection: Selection, showColor: boolean) {\r\n\r\n    var m = new ShowSelectionColorMessage(selection, showColor)\r\n    distributeMessage(m);\r\n}\r\nexport class ShowSelectionColorMessage extends Message {\r\n    selectionId: number;\r\n    showColor: boolean\r\n    constructor(selection: Selection, showColor: boolean) {\r\n        super(MESSAGE_SELECTION_SET_COLORING_VISIBILITY)\r\n        this.selectionId = selection.id;\r\n        this.showColor = showColor;\r\n    }\r\n}\r\n\r\n\r\n/// FILTER SELECTION\r\n\r\n\r\nexport function filterSelection(selection: Selection, filter: boolean) {\r\n\r\n    var m = new FilterSelectionMessage(selection, filter);\r\n    distributeMessage(m);\r\n}\r\nexport class FilterSelectionMessage extends Message {\r\n    selectionId: number;\r\n    filter: boolean\r\n    constructor(selection: Selection, filter: boolean) {\r\n        super(MESSAGE_SELECTION_FILTER)\r\n        this.selectionId = selection.id;\r\n        this.filter = filter;\r\n    }\r\n}\r\n\r\n/// SWAP PRIORITY\r\n\r\nexport function swapPriority(s1: Selection, s2: Selection) {\r\n\r\n    var m = new SelectionPriorityMessage(s1, s2, s2.priority, s1.priority);\r\n    distributeMessage(m);\r\n}\r\n\r\nexport class SelectionPriorityMessage extends Message {\r\n    selectionId1: number;\r\n    selectionId2: number;\r\n    priority1: number;\r\n    priority2: number;\r\n    constructor(s1: Selection, s2: Selection, p1: number, p2: number) {\r\n        super(MESSAGE_SELECTION_PRIORITY)\r\n        this.selectionId1 = s1.id;\r\n        this.selectionId2 = s2.id;\r\n        this.priority1 = p1;\r\n        this.priority2 = p2;\r\n    }\r\n}\r\n\r\n\r\n/// DELETE SELECTION\r\n\r\nexport function deleteSelection(selection: Selection) {\r\n\r\n    var m = new DeleteSelectionMessage(selection);\r\n    distributeMessage(m);\r\n}\r\n\r\nexport class DeleteSelectionMessage extends Message {\r\n    selectionId: number;\r\n    constructor(selection: Selection) {\r\n        super(MESSAGE_SELECTION_DELETE)\r\n        this.selectionId = selection.id;\r\n    }\r\n}\r\n\r\n\r\n\r\n/// SET SELECTION COLOR\r\n\r\nexport function setSelectionColor(s: Selection, color: string) {\r\n\r\n    distributeMessage(new SelectionColorMessage(s, color));\r\n}\r\n\r\nclass SelectionColorMessage extends Message {\r\n    selectionId: number;\r\n    color: string;\r\n    constructor(selection: Selection, color: string) {\r\n        super(MESSAGE_SELECTION_COLORING)\r\n        this.selectionId = selection.id;\r\n        this.color = color;\r\n    }\r\n}\r\n\r\n\r\n/// SEARCH SELECTION\r\n\r\nexport function search(term: string, type?: string) {\r\n\r\n    var idCompound: IDCompound = searchForTerm(term, getDynamicGraph(), type);\r\n    distributeMessage(new SearchResultMessage(term, idCompound));\r\n}\r\n\r\nexport class SearchResultMessage extends Message {\r\n    idCompound: IDCompound;\r\n    searchTerm: string\r\n    constructor(searchTerm: string, idCompound: IDCompound) {\r\n        super(MESSAGE_SEARCH_RESULT);\r\n        this.idCompound = idCompound;\r\n        this.searchTerm = searchTerm;\r\n    }\r\n}\r\n\r\nexport class NetworkControls {\r\n    networkType: string;\r\n    timeSliderStart: number;\r\n    timeSliderEnd: number;\r\n\r\n    constructor(networkType:string,startTime:number,endTime:number){\r\n        this.networkType=networkType;\r\n        this.timeSliderStart=startTime;\r\n        this.timeSliderEnd=endTime;\r\n\r\n    }\r\n}\r\n\r\nexport class NodeLinkControls extends NetworkControls{\r\n    globalZoom: number;\r\n    panOffsetLocal: number[] ;\r\n    panOffsetGlobal: number[];\r\n    linkOpacity: number;\r\n    nodeOpacity: number;\r\n    nodeSize: number;\r\n    edgeGap: number;\r\n    linkWidth: number;\r\n    labellingType: number;\r\n    constructor(networkType:string,startTime:number,endTime:number,globalZoom:number,panOffsetLocal: number[],panOffsetGlobal: number[],linkOpacity:number,nodeOpacity:number,nodeSize:number,edgeGap:number,linkWidth:number,labellingType:number){\r\n        super(networkType,startTime,endTime);\r\n        this.globalZoom=globalZoom;\r\n        this.panOffsetGlobal=panOffsetGlobal;\r\n        this.panOffsetLocal=panOffsetLocal;\r\n        this.linkOpacity=linkOpacity;\r\n        this.nodeOpacity=nodeOpacity;\r\n        this.nodeSize=nodeSize;\r\n        this.edgeGap=edgeGap;\r\n        this.linkWidth=linkWidth;\r\n        this.labellingType=labellingType;\r\n    }\r\n}\r\nexport class MatrixControls extends NetworkControls{\r\n    labellingType: string;\r\n    zoom:number;\r\n    constructor(networkType:string,startTime:number,endTime:number,zoom:number,labellingType:string){\r\n        super(networkType,startTime,endTime);\r\n        this.zoom=zoom;\r\n        this.labellingType=labellingType;\r\n    }\r\n}\r\nexport class TimeArchsControls extends NetworkControls{\r\n    labellingType: string;\r\n    /* webglState:any;\r\n    camera_position_x:number;\r\n    camera_position_y:number;\r\n    camera_position_z:number; */\r\n\r\n    constructor(networkType:string,startTime:number,endTime:number,labellingType:string){\r\n    //,webglState:any,camera_position_x:number,camera_position_y:number,camera_position_z:number){\r\n        super(networkType,startTime,endTime);\r\n        this.labellingType=labellingType;\r\n       /*  this.webglState=webglState;\r\n        this.camera_position_x=camera_position_x;\r\n        this.camera_position_y=camera_position_z;\r\n        this.camera_position_z=camera_position_z;\r\n */\r\n    }\r\n    \r\n}\r\nexport class MapControls extends NetworkControls{\r\n    nodeOverlap: number;\r\n    linkOpacity: number;\r\n    opacityOfPositionlessNodes: number;\r\n    constructor(networkType:string,startTime:number,endTime:number,nodeOverlap:number,linkOpacity:number,opacityOfPositionlessNodes:number){\r\n        super(networkType,startTime,endTime);\r\n        this.nodeOverlap=nodeOverlap;\r\n        this.linkOpacity=linkOpacity;\r\n        this.opacityOfPositionlessNodes=opacityOfPositionlessNodes;\r\n    }\r\n}\r\n\r\n// SET STATE MESSAGE\r\n\r\nexport class SetStateMessage extends Message {\r\n    state: NetworkControls; // this is the state with all the parameters to set the view to. \r\n    viewType: string;\r\n    constructor(state: NetworkControls,viewType: string) {\r\n        super(MESSAGE_SET_STATE);\r\n        this.state = state;\r\n        this.viewType=viewType;\r\n    }\r\n}\r\n\r\nexport function setState(state: NetworkControls,viewType:string) {\r\n    // is called from anywhere in vistorian by calling \r\n    // window.vc.messenger.setState(myState);\r\n    distributeMessage(new SetStateMessage(state,viewType), true);\r\n}\r\n\r\n// GET STATE MESSAGE\r\n\r\n\r\nexport class GetStateMessage extends Message {\r\n    bookmarkIndex: number;\r\n    viewType: string;\r\n    isNewBookmark:boolean;\r\n    typeOfMultiView: string;\r\n    constructor(bookmarkIndex: number,viewType: string,isNewBookmark:boolean,typeOfMultiView: string){\r\n        super(MESSAGE_GET_STATE);\r\n        this.bookmarkIndex=bookmarkIndex;\r\n        this.viewType=viewType;\r\n        this.isNewBookmark=isNewBookmark;\r\n        this.typeOfMultiView=typeOfMultiView;\r\n    } \r\n}\r\n\r\nexport function getState(bookmarkIndex: number,viewType:string,isNewBookmark:boolean,typeOfMultiView: string){\r\n    // is called from anywhere in vistorian by calling \r\n    // window.vc.messenger.getState(bookmarkIndex);\r\n\r\n   distributeMessage(new GetStateMessage(bookmarkIndex,viewType,isNewBookmark,typeOfMultiView), true);\r\n}\r\n\r\n\r\nexport class StateCreatedMessage extends Message{\r\n    state: NetworkControls;\r\n    bookmarkIndex: number;\r\n    viewType: string;\r\n    isNewBookmark:boolean;\r\n    typeOfMultiView: string;\r\n    constructor(state: NetworkControls,bookmarkIndex: number,viewType: string,isNewBookmark:boolean,typeOfMultiView: string) {\r\n        super(MESSAGE_STATE_CREATED)\r\n        this.state = state;\r\n        this.bookmarkIndex=bookmarkIndex;\r\n        this.viewType=viewType;\r\n        this.isNewBookmark=isNewBookmark;\r\n        this.typeOfMultiView=typeOfMultiView;\r\n    }\r\n}\r\n\r\nexport function stateCreated(state: NetworkControls,bookmarkIndex: number,viewType: string,isNewBookmark:boolean,typeOfMultiView: string){\r\n    // State created : to set the state after getting it from the selected network\r\n\r\n    distributeMessage(new StateCreatedMessage(state,bookmarkIndex,viewType,isNewBookmark,typeOfMultiView), true);\r\n}\r\n\r\n////////////////////////\r\n// INTERNAL FUNCTIONS //\r\n////////////////////////\r\n\r\nvar MESSAGE_KEY: string = 'networkcube_message';\r\nlocalStorage[MESSAGE_KEY] = undefined;\r\n\r\nexport function distributeMessage(message: Message, ownView?: boolean) {\r\n\r\n    //VS: Link Function Use\r\n    // trace.event(null, 'LinkFunctionUse', message.type, );\r\n\r\n    if (ownView == undefined || ownView)\r\n        processMessage(message);\r\n\r\n    // other views\r\n    if (MESSENGER_PROPAGATE) {\r\n        localStorage[MESSAGE_KEY] = JSON.stringify(\r\n            message,\r\n            function (k, v) { return dgraphReplacer(k, v); });\r\n    }\r\n}\r\n\r\nfunction receiveMessage() {\r\n    // read message from local storage\r\n    var s = localStorage[MESSAGE_KEY];\r\n    if (s == undefined || s == 'undefined')\r\n        return;\r\n    var dgraph: DynamicGraph = getDynamicGraph();\r\n    var m: Message = <Message>JSON.parse(\r\n        s,\r\n        function (k, v) { return dgraphReviver(dgraph, k, v); });\r\n\r\n    if (!m || m.id == previousMessageId) {\r\n        return;\r\n    }\r\n    previousMessageId = m.id;\r\n    processMessage(m);\r\n}\r\n\r\n\r\nfunction processMessage(m: Message) {\r\n    var graph = getDynamicGraph();\r\n\r\n    if ((messageHandler as any)[m.type]) {\r\n        // for messages with handlers\r\n        if (m.type == MESSAGE_HIGHLIGHT) {\r\n            var m2: HighlightMessage = <HighlightMessage>m;\r\n            graph.highlight(m2.action, m2.idCompound);\r\n        } else\r\n            if (m.type == MESSAGE_SELECTION) {\r\n                var m3: SelectionMessage = <SelectionMessage>m;\r\n                graph.selection(m3.action, m3.idCompound, m3.selectionId);\r\n            } else\r\n                if (m.type == MESSAGE_TIME_RANGE) {\r\n                    // this type is a view message. no adjustments on the graph necessary.\r\n                } else\r\n                    if (m.type == MESSAGE_SELECTION_SET_COLORING_VISIBILITY) {\r\n                        var m4: ShowSelectionColorMessage = <ShowSelectionColorMessage>m;\r\n                        var m4Selection = graph.getSelection(m4.selectionId);\r\n                        if (m4Selection != undefined) {\r\n                            m4Selection.showColor = m4.showColor;\r\n                        }\r\n                    } else\r\n                        if (m.type == MESSAGE_SELECTION_PRIORITY) {\r\n                            var m5: SelectionPriorityMessage = <SelectionPriorityMessage>m;\r\n                            var m5SelectionId1 = graph.getSelection(m5.selectionId1);\r\n                            var m5SelectionId2 = graph.getSelection(m5.selectionId2);\r\n                            if (m5SelectionId1 != undefined) {\r\n                                m5SelectionId1.priority = m5.priority1;\r\n                            } // ELSE?\r\n                            if (m5SelectionId2 != undefined) {\r\n                                m5SelectionId2.priority = m5.priority2;\r\n                            } // ELSE?\r\n\r\n                            var linkElements = graph.links().selected().toArray();\r\n                            for (var i = 0; i < linkElements.length; i++) {\r\n                                linkElements[i].getSelections().sort(sortByPriority)\r\n                            }\r\n                            var nodeElements = graph.nodes().selected().toArray();\r\n                            for (var i = 0; i < nodeElements.length; i++) {\r\n                                nodeElements[i].getSelections().sort(sortByPriority)\r\n                            }\r\n                            var nodePairElements = graph.nodePairs().selected().toArray();\r\n                            for (var i = 0; i < nodePairElements.length; i++) {\r\n                                nodePairElements[i].getSelections().sort(sortByPriority)\r\n                            }\r\n                        } else\r\n                            if (m.type == MESSAGE_SELECTION_FILTER) {\r\n                                var m6: FilterSelectionMessage = <FilterSelectionMessage>m;\r\n                                graph.filterSelection(m6.selectionId, m6.filter);\r\n                            } else\r\n                                // test messages that don't require a message handler\r\n                                if (m.type == MESSAGE_SELECTION_CREATE) {\r\n                                    var m7: CreateSelectionMessage = <CreateSelectionMessage>m;\r\n                                    graph.addSelection(m7.selection.id, m7.selection.color, m7.selection.acceptedType, m7.selection.priority);\r\n                                } else\r\n                                    if (m.type == MESSAGE_SELECTION_SET_CURRENT) {\r\n                                        var m8: SetCurrentSelectionIdMessage = <SetCurrentSelectionIdMessage>m;\r\n                                        graph.setCurrentSelection(m8.selectionId);\r\n                                    } else\r\n                                        if (m.type == MESSAGE_SELECTION_DELETE) {\r\n                                            var m10: DeleteSelectionMessage = <DeleteSelectionMessage>m;\r\n                                            graph.deleteSelection(m10.selectionId);\r\n                                        } else\r\n                                            if (m.type == MESSAGE_SEARCH_RESULT) {\r\n                                                var m11: SearchResultMessage = <SearchResultMessage>m;\r\n                                                graph.highlight('set', m11.idCompound);\r\n                                            } else\r\n                                                if (m.type == MESSAGE_SELECTION_COLORING) {\r\n                                                    var m12: SelectionColorMessage = <SelectionColorMessage>m;\r\n                                                    var m12Selection = graph.getSelection(m12.selectionId);\r\n                                                    if (m12Selection != undefined) {\r\n                                                        m12Selection.color = m12.color;\r\n                                                    } // ELSE ??\r\n                                                }\r\n                                                else\r\n                                                    if (m.type == MESSAGE_GET_STATE || m.type == MESSAGE_SET_STATE || m.type == MESSAGE_STATE_CREATED){\r\n                                                        // this type is a state message. no adjustments on the graph necessary.\r\n                                                    }\r\n\r\n        callHandler(m);\r\n    }\r\n}\r\n\r\n// calls the handler for the passed message\r\nfunction callHandler(message: Message) {\r\n    if ((messageHandler as any)[message.type] && (messageHandler as any)[message.type] != undefined) {\r\n        (messageHandler as any)[message.type](message);\r\n    }\r\n}","import { Motif } from \"./queries\";\r\nimport { Node } from './dynamicgraph';\r\nexport function findDegree(nodes: Node[]): Motif[] {\r\n    const motifs: Motif[] = [];\r\n    for (const n of nodes) {\r\n        const ns = n.neighbors().removeDuplicates().toArray().concat(n);\r\n        const ls = n.links().removeDuplicates().toArray();\r\n        motifs.push(new Motif(ns, ls));\r\n    }\r\n    return motifs;\r\n}\r\n","// namespace colorSchemes{\r\n    // create more color pallets on\r\n    // http://www.palettefx.com/\r\n\r\n    export const schema1 = [\r\n        \"#775566\",\r\n        \"#6688bb\",\r\n        \"#556677\",\r\n        \"#88aa88\",\r\n        \"#88bb33\",\r\n        \"#cc7744\",\r\n        \"#003366\",\r\n        \"#994422\",\r\n        \"#331111\",\r\n    ];\r\n\r\n    export const schema2 = [\r\n        \"#44B3C2\",\r\n        \"#F1A94E\",\r\n        \"#E45641\",\r\n        \"#5D4C46\",\r\n        \"#7B8D8E\",\r\n        \"#2ca02c\",\r\n        \"#003366\",\r\n        \"#9467bd\",\r\n        \"#bcbd22\",\r\n        \"#e377c2\",\r\n        ];\r\n\r\n    export const schema3 = [\r\n        \"#001166\",\r\n        \"#0055aa\",\r\n        \"#1199cc\",\r\n        \"#99ccdd\",\r\n        \"#002222\",\r\n        \"#ddffff\",\r\n        \"#446655\",\r\n        \"#779988\",\r\n        \"#115522\",\r\n        ];\r\n\r\n    export const schema4 = [\r\n        \"#1f77b4\",\r\n        \"#ff7f0e\",\r\n        \"#2ca02c\",\r\n        \"#d62728\",\r\n        \"#9467bd\",\r\n        \"#8c564b\",\r\n        \"#e377c2\",\r\n        \"#7f7f7f\",\r\n        \"#bcbd22\",\r\n        \"#17becf\",\r\n        ];\r\n\r\n    export const schema5 = [\r\n        \"#1f77b4\",\r\n        \"#aec7e8\",\r\n        \"#ff7f0e\",\r\n        \"#ffbb78\",\r\n        \"#2ca02c\",\r\n        \"#98df8a\",\r\n        \"#d62728\",\r\n        \"#ff9896\",\r\n        \"#9467bd\",\r\n        \"#c5b0d5\",\r\n        \"#8c564b\",\r\n        \"#c49c94\",\r\n        \"#e377c2\",\r\n        \"#f7b6d2\",\r\n        \"#7f7f7f\",\r\n        \"#c7c7c7\",\r\n        \"#bcbd22\",\r\n        \"#dbdb8d\",\r\n        \"#17becf\",\r\n        \"#9edae5\",\r\n        ];\r\n\r\n    // colorbrewer categorical 12\r\n    export const schema6 = [\r\n        \"#a6cee3\",\r\n        \"#1f78b4\",\r\n        \"#b2df8a\",\r\n        \"#33a02c\",\r\n        \"#fb9a99\",\r\n        \"#e31a1c\",\r\n        \"#fdbf6f\",\r\n        \"#ff7f00\",\r\n        \"#cab2d6\",\r\n        \"#6a3d9a\",\r\n        \"#ffff99\",\r\n        \"#b15928\",\r\n        ];\r\n// }\r\n","\r\nexport class BSpline {\r\n    points: any[] = [];\r\n    degree: any;\r\n    dimension: any;\r\n    baseFunc: any;\r\n    baseFuncRangeInt: number = 0; // INIT??\r\n\r\n\r\n    constructor(points: any, degree: any, copy?: any) {\r\n        if (copy) {\r\n            this.points = []\r\n            for (var i = 0; i < points.length; i++) {\r\n                this.points.push(points[i]);\r\n            }\r\n        } else {\r\n            this.points = points;\r\n        }\r\n        this.degree = degree;\r\n        this.dimension = points[0].length;\r\n        if (degree == 2) {\r\n            this.baseFunc = this.basisDeg2;\r\n            this.baseFuncRangeInt = 2;\r\n        } else if (degree == 3) {\r\n            this.baseFunc = this.basisDeg3;\r\n            this.baseFuncRangeInt = 2;\r\n        } else if (degree == 4) {\r\n            this.baseFunc = this.basisDeg4;\r\n            this.baseFuncRangeInt = 3;\r\n        } else if (degree == 5) {\r\n            this.baseFunc = this.basisDeg5;\r\n            this.baseFuncRangeInt = 3;\r\n        }\r\n    }\r\n\r\n    //BSpline.prototype.seqAt = function(dim: any): any{\r\n    seqAt(dim: any): any {\r\n        var points: any = this.points;\r\n        var margin: any = this.degree + 1;\r\n        return function (n: any) {\r\n            if (n < margin) {\r\n                return points[0][dim];\r\n            } else if (points.length + margin <= n) {\r\n                return points[points.length - 1][dim];\r\n            } else {\r\n                return points[n - margin][dim];\r\n            }\r\n        };\r\n    };\r\n\r\n    //BSpline.prototype.basisDeg2 = function(x: any): number{\r\n    basisDeg2(x: any): number {\r\n        if (-0.5 <= x && x < 0.5) {\r\n            return 0.75 - x * x;\r\n        } else if (0.5 <= x && x <= 1.5) {\r\n            return 1.125 + (-1.5 + x / 2.0) * x;\r\n        } else if (-1.5 <= x && x < -0.5) {\r\n            return 1.125 + (1.5 + x / 2.0) * x;\r\n        } else {\r\n            return 0;\r\n        }\r\n    };\r\n\r\n    //BSpline.prototype.basisDeg3 = function(x: any): number{\r\n    basisDeg3(x: any): number {\r\n        if (-1 <= x && x < 0) {\r\n            return 2.0 / 3.0 + (-1.0 - x / 2.0) * x * x;\r\n        } else if (1 <= x && x <= 2) {\r\n            return 4.0 / 3.0 + x * (-2.0 + (1.0 - x / 6.0) * x);\r\n        } else if (-2 <= x && x < -1) {\r\n            return 4.0 / 3.0 + x * (2.0 + (1.0 + x / 6.0) * x);\r\n        } else if (0 <= x && x < 1) {\r\n            return 2.0 / 3.0 + (-1.0 + x / 2.0) * x * x;\r\n        } else {\r\n            return 0;\r\n        }\r\n    };\r\n\r\n    //BSpline.prototype.basisDeg4 = function(x: any): number{\r\n    basisDeg4(x: any): number {\r\n        if (-1.5 <= x && x < -0.5) {\r\n            return 55.0 / 96.0 + x * (-(5.0 / 24.0) + x * (-(5.0 / 4.0) + (-(5.0 / 6.0) - x / 6.0) * x));\r\n        } else if (0.5 <= x && x < 1.5) {\r\n            return 55.0 / 96.0 + x * (5.0 / 24.0 + x * (-(5.0 / 4.0) + (5.0 / 6.0 - x / 6.0) * x));\r\n        } else if (1.5 <= x && x <= 2.5) {\r\n            return 625.0 / 384.0 + x * (-(125.0 / 48.0) + x * (25.0 / 16.0 + (-(5.0 / 12.0) + x / 24.0) * x));\r\n        } else if (-2.5 <= x && x <= -1.5) {\r\n            return 625.0 / 384.0 + x * (125.0 / 48.0 + x * (25.0 / 16.0 + (5.0 / 12.0 + x / 24.0) * x));\r\n        } else if (-1.5 <= x && x < 1.5) {\r\n            return 115.0 / 192.0 + x * x * (-(5.0 / 8.0) + x * x / 4.0);\r\n        } else {\r\n            return 0;\r\n        }\r\n    };\r\n\r\n    //BSpline.prototype.basisDeg5 = function(x: any): number{\r\n    basisDeg5(x: any): number {\r\n        if (-2 <= x && x < -1) {\r\n            return 17.0 / 40.0 + x * (-(5.0 / 8.0) + x * (-(7.0 / 4.0) + x * (-(5.0 / 4.0) + (-(3.0 / 8.0) - x / 24.0) * x)));\r\n        } else if (0 <= x && x < 1) {\r\n            return 11.0 / 20.0 + x * x * (-(1.0 / 2.0) + (1.0 / 4.0 - x / 12.0) * x * x);\r\n        } else if (2 <= x && x <= 3) {\r\n            return 81.0 / 40.0 + x * (-(27.0 / 8.0) + x * (9.0 / 4.0 + x * (-(3.0 / 4.0) + (1.0 / 8.0 - x / 120.0) * x)));\r\n        } else if (-3 <= x && x < -2) {\r\n            return 81.0 / 40.0 + x * (27.0 / 8.0 + x * (9.0 / 4.0 + x * (3.0 / 4.0 + (1.0 / 8.0 + x / 120.0) * x)));\r\n        } else if (1 <= x && x < 2) {\r\n            return 17.0 / 40.0 + x * (5.0 / 8.0 + x * (-(7.0 / 4.0) + x * (5.0 / 4.0 + (-(3.0 / 8.0) + x / 24.0) * x)));\r\n        } else if (-1 <= x && x < 0) {\r\n            return 11.0 / 20.0 + x * x * (-(1.0 / 2.0) + (1.0 / 4.0 + x / 12.0) * x * x);\r\n        } else {\r\n            return 0;\r\n        }\r\n    };\r\n\r\n    //BSpline.prototype.getInterpol = function(seq: any, t: any): number{\r\n    getInterpol(seq: any, t: any): number {\r\n        var f: any = this.baseFunc;\r\n        var rangeInt: any = this.baseFuncRangeInt;\r\n        var tInt: number = Math.floor(t);\r\n        var result: number = 0;\r\n        for (var i = tInt - rangeInt; i <= tInt + rangeInt; i++) {\r\n            result += seq(i) * f(t - i);\r\n        }\r\n        return result;\r\n    };\r\n\r\n    //BSpline.prototype.calcAt = function(t: any): any{\r\n    calcAt(t: any): any {\r\n        t = t * ((this.degree + 1) * 2 + this.points.length);//t must be in [0,1]\r\n        if (this.dimension == 2) {\r\n            return [this.getInterpol(this.seqAt(0), t), this.getInterpol(this.seqAt(1), t)];\r\n        } else if (this.dimension == 3) {\r\n            return [this.getInterpol(this.seqAt(0), t), this.getInterpol(this.seqAt(1), t), this.getInterpol(this.seqAt(2), t)];\r\n        } else {\r\n            var res = [];\r\n            for (var i = 0; i < this.dimension; i++) {\r\n                res.push(this.getInterpol(this.seqAt(i), t));\r\n            }\r\n            return res;\r\n        }\r\n    };\r\n}\r\n\r\n/*\r\nvar BSpline = function(points: any, degree: any, copy: any){\r\n    if(copy){\r\n        this.points = []\r\n        for(var i = 0;i<points.length;i++){\r\n            this.points.push(points[i]);\r\n        }\r\n    }else{\r\n        this.points = points;\r\n    }\r\n    this.degree = degree;\r\n    this.dimension = points[0].length;\r\n    if(degree == 2){\r\n        this.baseFunc = this.basisDeg2;\r\n        this.baseFuncRangeInt = 2;\r\n    }else if(degree == 3){\r\n        this.baseFunc = this.basisDeg3;\r\n        this.baseFuncRangeInt = 2;\r\n    }else if(degree == 4){\r\n        this.baseFunc = this.basisDeg4;\r\n        this.baseFuncRangeInt = 3;\r\n    }else if(degree == 5){\r\n        this.baseFunc = this.basisDeg5;\r\n        this.baseFuncRangeInt = 3;\r\n    }\r\n};\r\n*/","import * as THREE from 'three';\r\nimport $ from 'jquery';\r\nimport { BSpline } from './BSpline';\r\n\r\n//module glutils {\r\n\r\nexport function makeAlphaBuffer(array: number[], stretch: number) {\r\n    var buffer: Float32Array = new Float32Array(array.length * stretch); // three components per vertex\r\n    for (var i = 0; i < array.length; i++) {\r\n        for (var j = 0; j < stretch; j++) {\r\n            buffer[i * stretch + j] = array[i];\r\n        }\r\n    }\r\n    return buffer\r\n}\r\n\r\nexport function addBufferedHatchedRect(vertexArray: number[][], x: number, y: number, z: number, width: number, height: number, colorArray: number[][], c: number[]) {\r\n    var HATCH_NUM = 3;\r\n    var LINE_WIDTH = 1;\r\n    var hatchWidth = width / HATCH_NUM;\r\n    width = width / 2;\r\n    height = height / 2;\r\n    var startX: number = x + width;\r\n    var startY: number = y - height;\r\n    for (var i = 1; i <= HATCH_NUM; i++) {\r\n\r\n        vertexArray.push(\r\n            [startX - hatchWidth * i, startY, z],\r\n            [startX - hatchWidth * i + LINE_WIDTH, startY, z],\r\n            [startX, startY + hatchWidth * i + LINE_WIDTH, z],\r\n            [startX, startY + hatchWidth * i + LINE_WIDTH, z],\r\n            [startX, startY + hatchWidth * i, z],\r\n            [startX - hatchWidth * i, startY, z]\r\n        )\r\n        colorArray.push(\r\n            [c[0], c[1], c[2], c[3]],\r\n            [c[0], c[1], c[2], c[3]],\r\n            [c[0], c[1], c[2], c[3]],\r\n            [c[0], c[1], c[2], c[3]],\r\n            [c[0], c[1], c[2], c[3]],\r\n            [c[0], c[1], c[2], c[3]]\r\n        )\r\n    }\r\n}\r\n\r\nexport function addBufferedRect(vertexArray: number[][], x: number, y: number, z: number, width: number, height: number, colorArray: number[][], c: number[]) {\r\n    width = width / 2;\r\n    height = height / 2;\r\n    vertexArray.push(\r\n        [x - width, y - height, z],\r\n        [x + width, y - height, z],\r\n        [x + width, y + height, z],\r\n        [x + width, y + height, z],\r\n        [x - width, y + height, z],\r\n        [x - width, y - height, z]\r\n    );\r\n    colorArray.push(\r\n        [c[0], c[1], c[2], c[3]],\r\n        [c[0], c[1], c[2], c[3]],\r\n        [c[0], c[1], c[2], c[3]],\r\n        [c[0], c[1], c[2], c[3]],\r\n        [c[0], c[1], c[2], c[3]],\r\n        [c[0], c[1], c[2], c[3]]\r\n    );\r\n}\r\n\r\nexport function addBufferedCirlce(vertexArray: number[][], x: number, y: number, z: number, radius: number, colorArray: number[][], c: number[]) {\r\n    var segments: number = 11;\r\n    var angle: number = Math.PI / (segments / 2)\r\n    for (var i = 0; i < segments; i++) {\r\n        vertexArray.push(\r\n            [x + Math.cos(i * angle) * radius, y + Math.sin(i * angle) * radius, z],\r\n            [x + Math.cos((i + 1) * angle) * radius, y + Math.sin((i + 1) * angle) * radius, z],\r\n            [x, y, z]\r\n        )\r\n        colorArray.push(\r\n            [c[0], c[1], c[2], c[3]],\r\n            [c[0], c[1], c[2], c[3]],\r\n            [c[0], c[1], c[2], c[3]]\r\n        )\r\n    }\r\n}\r\n\r\nexport function addBufferedDiamond(vertexArray: number[][], x: number, y: number, z: number, width: number, height: number, colorArray: number[][], c: number[]) {\r\n    width = width / 2;\r\n    height = height / 2;\r\n    vertexArray.push(\r\n        [x - width, y, z],\r\n        [x, y - height, z],\r\n        [x + width, y, z],\r\n        [x + width, y, z],\r\n        [x, y + height, z],\r\n        [x - width, y, z]\r\n    );\r\n    colorArray.push(\r\n        [c[0], c[1], c[2], c[3]],\r\n        [c[0], c[1], c[2], c[3]],\r\n        [c[0], c[1], c[2], c[3]],\r\n        [c[0], c[1], c[2], c[3]],\r\n        [c[0], c[1], c[2], c[3]],\r\n        [c[0], c[1], c[2], c[3]]\r\n    );\r\n}\r\n\r\nexport function createRectFrame(w: number, h: number, color: number, lineThickness: number): THREE.Line {\r\n    w = w / 2\r\n    h = h / 2\r\n    var geom: THREE.Geometry = new THREE.Geometry();\r\n    geom.vertices = [\r\n        new THREE.Vector3(-w, -h, 0),\r\n        new THREE.Vector3(-w, h, 0),\r\n        new THREE.Vector3(w, h, 0),\r\n        new THREE.Vector3(w, -h, 0),\r\n        new THREE.Vector3(-w, -h, 0)\r\n    ]\r\n\r\n    var material: THREE.LineBasicMaterial = new THREE.LineBasicMaterial({\r\n        color: color,\r\n        // linewidth: lineThickness,\r\n    });\r\n\r\n    return new THREE.Line(geom, material);\r\n}\r\n\r\nexport function createDiagonalCross(w: number, h: number, color: number, lineThickness: number): THREE.Line {\r\n    w = w / 2\r\n    h = h / 2\r\n    var geom: THREE.Geometry = new THREE.Geometry();\r\n    geom.vertices = [\r\n        new THREE.Vector3(-w, -h, 0),\r\n        new THREE.Vector3(-w, h, 0),\r\n        new THREE.Vector3(w, h, 0),\r\n        new THREE.Vector3(w, -h, 0),\r\n        new THREE.Vector3(-w, -h, 0),\r\n        new THREE.Vector3(w, h, 0),\r\n        new THREE.Vector3(0, 0, 0),\r\n        new THREE.Vector3(-w, h, 0),\r\n        new THREE.Vector3(w, -h, 0)\r\n    ];\r\n\r\n    var material: THREE.LineBasicMaterial = new THREE.LineBasicMaterial({\r\n        color: color,\r\n        linewidth: lineThickness,\r\n    });\r\n\r\n    return new THREE.Line(geom, material);\r\n}\r\n\r\nexport function makeBuffer3f(array: number[][]): Float32Array {\r\n    var buffer: Float32Array = new Float32Array(array.length * 3); // three components per vertex\r\n    for (var i = 0; i < array.length; i++) {\r\n        buffer[i * 3 + 0] = array[i][0];\r\n        buffer[i * 3 + 1] = array[i][1];\r\n        buffer[i * 3 + 2] = array[i][2];\r\n    }\r\n    return buffer\r\n}\r\nexport function makeBuffer4f(array: number[][]): Float32Array {\r\n    var buffer: Float32Array = new Float32Array(array.length * 4); // three components per vertex\r\n    for (var i = 0; i < array.length; i++) {\r\n        buffer[i * 4 + 0] = array[i][0];\r\n        buffer[i * 4 + 1] = array[i][1];\r\n        buffer[i * 4 + 2] = array[i][2];\r\n        buffer[i * 4 + 3] = array[i][3];\r\n    }\r\n    return buffer\r\n}\r\n\r\n\r\nexport function updateBuffer(buffer: number[], array: number[][], size: number) {\r\n    for (var i = 0; i < array.length; i++) {\r\n        for (var j = 0; j < size; j++) {\r\n            buffer[i * size + j] = array[i][j];\r\n        }\r\n    }\r\n}\r\n\r\n\r\n\r\nexport function createText(string: string, x: number, y: number, z: number, size: number, color: string, weight: string = 'normal', align: string = 'left'): THREE.Mesh {\r\n    var textGeom: THREE.TextGeometry = new THREE.TextGeometry(string, {\r\n        // font: 'helvetiker', // IT'S NOT CORRECT FORMAT\r\n        size: size,\r\n        height: 1,\r\n        curveSegments: 1,\r\n    })\r\n    var textMaterial: THREE.MeshBasicMaterial = new THREE.MeshBasicMaterial({ color: color });\r\n    var label: THREE.Mesh = new THREE.Mesh(textGeom, textMaterial)\r\n\r\n    if (align == 'right') {\r\n        label.geometry.computeBoundingBox();\r\n        var bounds: THREE.Box3 = label.geometry.boundingBox;\r\n        x -= bounds.max.x - bounds.min.x;\r\n    }\r\n\r\n    label.position.set(x, y, z)\r\n    return label;\r\n}\r\n\r\nexport function getMousePos(canvas: any, x: any, y: any) {\r\n    var rect = canvas.getBoundingClientRect();\r\n    return {\r\n        x: x - rect.left,\r\n        y: y - rect.top\r\n    };\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n/////////////////////////////\r\n/// QUERY LAYER FOR WEBGL ///\r\n/////////////////////////////    \r\n\r\n// SETUP\r\n\r\nvar txtCanvas = document.createElement(\"canvas\")\r\n\r\nexport class WebGL {\r\n    /* INIT ?????? */\r\n    scene: THREE.Scene = new THREE.Scene();\r\n    camera: THREE.OrthographicCamera = new THREE.OrthographicCamera(0, 0, 0, 0);\r\n    renderer: THREE.WebGLRenderer = new THREE.WebGLRenderer();\r\n    canvas: any;\r\n    geometry: THREE.BufferGeometry = new THREE.BufferGeometry();\r\n    interactor: any; // BEFORE WebGLInteractor;\r\n\r\n    elementQueries: WebGLElementQuery[] = []\r\n\r\n    constructor(params?: Object) {\r\n        txtCanvas = document.createElement(\"canvas\");\r\n        txtCanvas.setAttribute('id', 'textCanvas');\r\n    }\r\n\r\n    render() {\r\n        // var d = new Date();\r\n        // var begin = d.getTime()\r\n\r\n        // check which webgl groups must be updated\r\n        for (var i = 0; i < this.elementQueries.length; i++) {\r\n            if (this.elementQueries[i].updateAttributes || this.elementQueries[i].updateStyle) {\r\n                this.elementQueries[i].set();\r\n            }\r\n        }\r\n\r\n        this.renderer.render(this.scene, this.camera)\r\n    }\r\n\r\n\r\n    selectAll() {\r\n        return selectAll()\r\n    }\r\n\r\n\r\n\r\n\r\n    ///////////////////////\r\n    // RENDER PARAMETERS //\r\n    ///////////////////////\r\n\r\n    enableZoom(b?: boolean) {\r\n        function mouseWheel(event: any) {\r\n            event.preventDefault();\r\n\r\n            webgl.camera.zoom += event.wheelDelta / 1000;\r\n            webgl.camera.zoom = Math.max(0.1, webgl.camera.zoom)\r\n            webgl.camera.updateProjectionMatrix();\r\n            webgl.render();\r\n        }\r\n        if (b) {\r\n            window.addEventListener(\"mousewheel\", mouseWheel, false);\r\n        } else {\r\n            window.addEventListener(\"mousewheel\", mouseWheel, false);\r\n        }\r\n    }\r\n    enablePanning(b: boolean) {\r\n        this.interactor.isPanEnabled = b;\r\n    }\r\n    enableHorizontalPanning(b: boolean) {\r\n        this.interactor.isHorizontalPanEnabled = b;\r\n    }\r\n\r\n\r\n    ////////////////////\r\n    /// IMAGE EXPORT ///\r\n    ////////////////////\r\n\r\n}\r\n\r\nvar webgl: WebGL;\r\n\r\nexport function initWebGL(parentId: string, width: number, height: number, params?: Object): WebGL {\r\n\r\n    webgl = new WebGL(params);\r\n\r\n\r\n    webgl.camera = new THREE.OrthographicCamera(\r\n        width / -2,\r\n        width / 2,\r\n        height / 2,\r\n        height / -2,\r\n        0, 1000)\r\n\r\n    webgl.scene = new THREE.Scene();\r\n    webgl.scene.add(webgl.camera);\r\n    webgl.camera.position.z = 100;\r\n\r\n\r\n    // renderer\r\n    webgl.renderer = new THREE.WebGLRenderer({\r\n        antialias: true,\r\n        preserveDrawingBuffer: true\r\n    });\r\n    webgl.renderer.setSize(width, height)\r\n    webgl.renderer.setClearColor(0xffffff, 1);\r\n\r\n    // position canvas element containing cells\r\n    webgl.canvas = webgl.renderer.domElement;\r\n    $(\"#\" + parentId).append(webgl.canvas);\r\n\r\n    webgl.interactor = new WebGLInteractor(webgl.scene, webgl.canvas, webgl.camera);\r\n\r\n\r\n    var light: THREE.PointLight = new THREE.PointLight(0x000000, 1, 100);\r\n    light.position.set(0, 0, 1000);\r\n    webgl.scene.add(light);\r\n\r\n    return webgl;\r\n}\r\n\r\n// camera BEFORE THREE.Camera, renderer BEFORE THREE.Renderer\r\nexport function setWebGL(scene: THREE.Scene, camera: THREE.OrthographicCamera, renderer: THREE.WebGLRenderer, canvas: any) {\r\n    webgl = new WebGL();\r\n    webgl.camera = camera;\r\n    webgl.scene = scene;\r\n    webgl.renderer = renderer;\r\n}\r\n\r\n// INTERACTION\r\n\r\n/// SELECTIONS in the style of D3\r\n\r\nexport function selectAll(): WebGLElementQuery {\r\n    var q: WebGLElementQuery = new WebGLElementQuery();\r\n    webgl.elementQueries.push(q)\r\n    return q;\r\n}\r\n\r\n\r\nexport class WebGLElementQuery {\r\n    dataElements: Object[] = [];\r\n    visualElements: any[] = [];\r\n    mesh: THREE.Mesh = new THREE.Mesh();\r\n    children: Object[] = []\r\n    scene: THREE.Scene = new THREE.Scene();\r\n    mouseOverHandler: any; // BEFORE Function;\r\n    mouseMoveHandler: any; // BEFORE Function;\r\n    mouseOutHandler: any; // BEFORE Function;\r\n    mouseDownHandler: any; // BEFORE Function;\r\n    mouseUpHandler: any; // BEFORE Function;\r\n    clickHandler: any; // BEFORE Function;\r\n\r\n    // attribute arrays\r\n    x: number[] = [];\r\n    y: number[] = [];\r\n    z: number[] = [];\r\n    r: number[] = [];\r\n\r\n    // style arrays\r\n    fill: string[] = []; // BEFORE number\r\n    stroke: string[] = []; // BEFORE number\r\n    strokewidth: number[] = [];\r\n    opacity: number[] = [];\r\n\r\n    shape: string = ''; // INIT ??\r\n\r\n    updateAttributes: boolean = false\r\n    updateStyle: boolean = false\r\n\r\n    IS_SHADER: boolean = false\r\n\r\n    constructor() {\r\n        this.scene = webgl.scene;\r\n    }\r\n\r\n    data(arr: Object[]): WebGLElementQuery {\r\n        this.dataElements = arr.slice(0);\r\n        return this;\r\n    }\r\n\r\n    append(shape: string): WebGLElementQuery {\r\n        var elements: any[] = []\r\n        switch (shape) {\r\n            // case 'circle': elements = createCirclesNoShader(this.dataElements, this.scene); break\r\n            case 'circle': createCirclesWithBuffers(this, this.scene); break\r\n            // case 'circle': elements = createCircles(this.dataElements, this.scene); break\r\n            // case 'g': elements = createG(this.dataElements, this.scene); break\r\n            case 'path': elements = createPaths(this.dataElements, this.scene); break\r\n            case 'line': elements = createLines(this.dataElements, this.scene); break\r\n            case 'rect': elements = createRectangles(this.dataElements, this.scene); break\r\n            case 'text': elements = createWebGLText(this.dataElements, this.scene); break\r\n            case 'polygon': elements = createPolygons(this.dataElements, this.scene); break\r\n            default: console.error('Shape', shape, 'does not exist.')\r\n        }\r\n\r\n        // init position arrays\r\n        if (!this.IS_SHADER) {\r\n            for (var i = 0; i < elements.length; i++) {\r\n                this.x.push(0);\r\n                this.y.push(0);\r\n                this.z.push(0);\r\n            }\r\n        }\r\n\r\n        this.shape = shape;\r\n        this.visualElements = elements;\r\n        return this;\r\n    }\r\n\r\n    push(e: any): WebGLElementQuery {\r\n        this.dataElements.push(e);\r\n        return this;\r\n    }\r\n    getData(i: any): any {\r\n        return this.dataElements[this.visualElements.indexOf(i)];\r\n    }\r\n    getVisual(i: any): any {\r\n        return this.visualElements[this.dataElements.indexOf(i)];\r\n    }\r\n\r\n    get length() {\r\n        return this.dataElements.length;\r\n    }\r\n\r\n    filter(f: Function): WebGLElementQuery {\r\n        var arr: any[] = [];\r\n        var visArr: any[] = []\r\n        for (var i = 0; i < this.dataElements.length; i++) {\r\n            if (f(this.dataElements[i], i)) {\r\n                arr.push(this.dataElements[i])\r\n                visArr.push(this.visualElements[i])\r\n            }\r\n        }\r\n        var q: WebGLElementQuery = new WebGLElementQuery().data(arr);\r\n        q.visualElements = visArr;\r\n        return q;\r\n    }\r\n\r\n    // geometric attributes\r\n    attr(name: string, v: any): WebGLElementQuery {\r\n        var l = this.visualElements.length;\r\n        if (this.IS_SHADER) {\r\n            for (var i = 0; i < this.dataElements.length; i++) {\r\n                (this as any)[name][i] = v instanceof Function ? v(this.dataElements[i], i) : v\r\n            }\r\n        } else {\r\n            for (var i = 0; i < l; i++) {\r\n                this.setAttr(this.visualElements[i], name, v instanceof Function ? v(this.dataElements[i], i) : v, i);\r\n                if (this.visualElements[i].hasOwnProperty('wireframe')) {\r\n                    this.setAttr(this.visualElements[i].wireframe, name, v instanceof Function ? v(this.dataElements[i], i) : v, i);\r\n                }\r\n            }\r\n        }\r\n        this.updateAttributes = true;\r\n        return this;\r\n    }\r\n\r\n    // style attributes\r\n    style(name: string, v: any): WebGLElementQuery {\r\n        var l = this.visualElements.length;\r\n        if (this.IS_SHADER) {\r\n            name = name.replace('-', '');\r\n            for (var i = 0; i < this.dataElements.length; i++) {\r\n                (this as any)[name][i] = v instanceof Function ? v(this.dataElements[i], i) : v\r\n            }\r\n        } else {\r\n            for (var i = 0; i < l; i++) {\r\n                setStyle(this.visualElements[i], name, v instanceof Function ? v(this.dataElements[i], i) : v, this);\r\n            }\r\n        }\r\n        this.updateStyle = true;\r\n        return this;\r\n    }\r\n\r\n    // called after all visual attributes have been set\r\n    // method that passes updated values to the shaders \r\n    set(): WebGLElementQuery {\r\n        if (!this.IS_SHADER)\r\n            return this;\r\n\r\n        var l = this.visualElements.length;\r\n        var vertexPositionBuffer: any[] = []\r\n        var vertexColorBuffer: any[] = []\r\n        var c\r\n        if (this.shape == 'circle') {\r\n            for (var i = 0; i < this.dataElements.length; i++) {\r\n                c = new THREE.Color(this.fill[i])\r\n                addBufferedCirlce(vertexPositionBuffer, this.x[i], this.y[i], this.z[i], this.r[i], vertexColorBuffer, [c.r, c.g, c.b, this.opacity[i]])\r\n            }\r\n        }\r\n        var geometry: any = this.mesh.geometry;\r\n        geometry.addAttribute('position', new THREE.BufferAttribute(makeBuffer3f(vertexPositionBuffer), 3));\r\n        geometry.addAttribute('customColor', new THREE.BufferAttribute(makeBuffer4f(vertexColorBuffer), 4));\r\n        geometry.needsUpdate = true;\r\n        geometry.verticesNeedUpdate = true;\r\n        (this.mesh.material as THREE.Material).needsUpdate = true;\r\n\r\n        this.updateAttributes = false;\r\n        this.updateStyle = false;\r\n\r\n        return this;\r\n    }\r\n\r\n    text(v: any): WebGLElementQuery {\r\n        var l = this.visualElements.length;\r\n        for (var i = 0; i < l; i++) {\r\n            this.visualElements[i]['text'] = v instanceof Function ? v(this.dataElements[i], i) : v\r\n            if (this.visualElements[i]['text'] == undefined)\r\n                continue;\r\n            setText(this.visualElements[i], this.visualElements[i]['text']);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    // interaction\r\n    on(event: string, f: Function): WebGLElementQuery {\r\n        switch (event) {\r\n            case 'mouseover': this.mouseOverHandler = f; break;\r\n            case 'mousemove': this.mouseMoveHandler = f; break;\r\n            case 'mouseout': this.mouseOutHandler = f; break;\r\n            case 'mousedown': this.mouseDownHandler = f; break;\r\n            case 'mouseup': this.mouseUpHandler = f; break;\r\n            case 'click': this.clickHandler = f; break;\r\n        }\r\n        webgl.interactor.register(this, event);\r\n        return this;\r\n    }\r\n\r\n    call(method: string, dataElement: any, event: any): WebGLElementQuery {\r\n        var i = this.dataElements.indexOf(dataElement);\r\n        switch (method) {\r\n            case 'mouseover': this.mouseOverHandler(dataElement, i, event); break;\r\n            case 'mousemove': this.mouseMoveHandler(dataElement, i, event); break;\r\n            case 'mouseout': this.mouseOutHandler(dataElement, i, event); break;\r\n            case 'mousedown': this.mouseDownHandler(dataElement, i, event); break;\r\n            case 'mouseup': this.mouseUpHandler(dataElement, i, event); break;\r\n            case 'click': this.clickHandler(dataElement, i, event); break;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    setAttr(element: THREE.Mesh, attr: string, v: any, index: number) {\r\n        switch (attr) {\r\n            case 'x': element.position.x = v; this.x[index] = v; break;\r\n            case 'y': element.position.y = v; this.y[index] = v; break;\r\n            case 'z': element.position.z = v; this.z[index] = v; break;\r\n            case 'x1': setX1(element, v); break; // lines only\r\n            case 'y1': setY1(element, v); break; // lines only\r\n            case 'x2': setX2(element, v); break; // lines only\r\n            case 'y2': setY2(element, v); break; // lines only\r\n            case 'r': element.scale.set(v, v, v); break; // circles only\r\n            case 'width': element.scale.setX(v); break;\r\n            case 'height': element.scale.setY(v); break;\r\n            case 'depth': element.scale.setZ(v); break;\r\n            case 'd': createPath(element, v); break;\r\n            case 'points': createPolygon(element, v); break;\r\n            case 'rotation': element.rotation.z = v * Math.PI / 180; break;\r\n            case 'scaleX': element.scale.x = v; break;\r\n            case 'scaleY': element.scale.y = v; break;\r\n            default: console.error('Attribute', attr, 'does not exist.')\r\n        }\r\n        (element.geometry as THREE.Geometry).verticesNeedUpdate = true;\r\n        (element.geometry as THREE.Geometry).elementsNeedUpdate = true;\r\n        (element.geometry as THREE.Geometry).lineDistancesNeedUpdate = true;\r\n    }\r\n\r\n    removeAll() {\r\n        for (var i = 0; i < this.visualElements.length; i++) {\r\n            if (this.visualElements[i].wireframe)\r\n                this.scene.remove(this.visualElements[i].wireframe)\r\n            this.scene.remove(this.visualElements[i]);\r\n        }\r\n    }\r\n\r\n\r\n}\r\n\r\n\r\n///////////////\r\n/// METHODS /// \r\n///////////////\r\n\r\n\r\n\r\nexport function setStyle(element: any, attr: string, v: any, query: WebGLElementQuery) {\r\n    switch (attr) {\r\n        case 'fill':\r\n            if (query.shape == 'text')\r\n                setText(element, element['text'], { color: v })\r\n            else\r\n                element.material.color = new THREE.Color(v);\r\n            break;\r\n        case 'stroke':\r\n            if (element.hasOwnProperty('wireframe')) {\r\n                element.wireframe.material.color = new THREE.Color(v);\r\n            } else {\r\n                element.material.color = new THREE.Color(v);\r\n            }\r\n            break;\r\n        case 'opacity':\r\n            element.material.opacity = v;\r\n            if (element.hasOwnProperty('wireframe')) element.wireframe.material.opacity = v;\r\n            break;\r\n        case 'stroke-width':\r\n            if (element.hasOwnProperty('wireframe'))\r\n                element.wireframe.material.linewidth = v;\r\n            else\r\n                element.material.linewidth = v;\r\n            break;\r\n        case 'font-size':\r\n            element.scale.x = v / 30;\r\n            element.scale.y = v / 30;\r\n            element.geometry.verticesNeedUpdate = true;\r\n            break;\r\n        default: console.error('Style', attr, 'does not exist.')\r\n    }\r\n    element.material.needsUpdate = true;\r\n    if (element.hasOwnProperty('wireframe'))\r\n        element.wireframe.material.needsUpdate = true;\r\n}\r\n\r\n// var textCtx\r\nexport function setText(mesh: any, text: string, parConfig?: any) {\r\n    var config = parConfig;\r\n    if (config == undefined) {\r\n        config = {};\r\n    }\r\n    if (config.color == undefined)\r\n        config.color = '#000000'\r\n\r\n    mesh['text'] = text;\r\n    var backgroundMargin = 10;\r\n    var txtCanvas = document.createElement(\"canvas\");\r\n\r\n    var context = txtCanvas.getContext(\"2d\");\r\n\r\n    var SIZE: number = 30;\r\n    var WIDTH: number = 0; // ????????\r\n    if (context) {\r\n        context.font = SIZE + \"pt Helvetica\";\r\n        WIDTH = context.measureText(text).width;\r\n        txtCanvas.width = WIDTH;\r\n        txtCanvas.height = SIZE;\r\n\r\n        context.textAlign = \"left\";\r\n        context.textBaseline = \"middle\";\r\n        context.fillStyle = config.color;\r\n        context.font = SIZE + \"pt Helvetica\";\r\n        // context.clearColor(1.0, 1.0, 0.0, 1.0)\r\n        // context.clear(gl.COLOR_BUFFER_BIT)\r\n        context.fillText(text, 0, txtCanvas.height / 2);\r\n    }\r\n\r\n    var tex = new THREE.Texture(txtCanvas);\r\n    tex.minFilter = THREE.LinearFilter\r\n    tex.flipY = true;\r\n    tex.needsUpdate = true;\r\n\r\n    mesh.material.map = tex;\r\n    mesh.material.transparent = true;\r\n    mesh.material.needsUpdate = true;\r\n\r\n    // adjust mesh geometry\r\n    mesh.geometry = new THREE.PlaneGeometry(WIDTH, SIZE);\r\n    mesh.geometry.needsUpdate = true;\r\n    mesh.geometry.verticesNeedUpdate = true;\r\n    mesh.needsUpdate = true;\r\n\r\n}\r\n\r\n// function setText(mesh:any, text:string, parConfig?:Object){\r\n//     var SIZE = 10\r\n//     var MARGIN = 2\r\n\r\n\r\n//     var config = parConfig;            \r\n//     if(config == undefined){\r\n//         config = {};\r\n//     }\r\n//     if(config.color == undefined)        \r\n//        config.color = '#000000'\r\n\r\n//     var canvas = document.createElement(\"canvas\");\r\n//     var context = canvas.getContext(\"2d\");\r\n//     context.font = SIZE + \"pt Arial\";\r\n//     var textWidth = context.measureText(text).width;\r\n//     canvas.width = textWidth + MARGIN;\r\n//     canvas.height = SIZE + MARGIN;\r\n//     context = canvas.getContext(\"2d\");\r\n//     context.font = SIZE + \"pt Arial\";\r\n//     // if(backGroundColor) {\r\n//     //     context.fillStyle = backGroundColor;\r\n//     //     context.fillRect(canvas.width / 2 - textWidth / 2 - backgroundMargin / 2, canvas.height / 2 - size / 2 - +backgroundMargin / 2, textWidth + backgroundMargin, size + backgroundMargin);\r\n//     // }\r\n//     context.textAlign = \"left\";\r\n//     context.textBaseline = \"middle\";\r\n//     context.fillStyle = config.color;;\r\n//     context.fillText(text, canvas.width / 2, canvas.height / 2);\r\n//     // context.strokeStyle = \"black\";\r\n//     // context.strokeRect(0, 0, canvas.width, canvas.height);\r\n//     var texture = new THREE.Texture(canvas);\r\n//     texture.needsUpdate = true;\r\n//     var material = new THREE.MeshBasicMaterial({\r\n//         map : texture\r\n//     });\r\n//     // tex.minFilter = THREE.LinearFilter\r\n//     // tex.flipY = true;\r\n//     // tex.needsUpdate = true;\r\n\r\n//     mesh.material.map = texture;\r\n//     mesh.material.transparent = true;\r\n//     mesh.material.needsUpdate = true;\r\n\r\n//     // adjust mesh geometry\r\n//     mesh.geometry = new THREE.PlaneGeometry(WIDTH, SIZE);\r\n//     mesh.geometry.needsUpdate = true;\r\n//     mesh.geometry.verticesNeedUpdate = true;\r\n//     mesh.needsUpdate = true;\r\n//     return mesh;\r\n\r\n\r\n//     // var mesh = new THREE.Mesh(new THREE.PlaneGeometry(canvas.width, canvas.height), material);\r\n//     // // mesh.overdraw = true;\r\n//     // mesh.doubleSided = true;\r\n//     // mesh.position.x = x - canvas.width;\r\n//     // mesh.position.y = y - canvas.height;\r\n//     // mesh.position.z = z;\r\n//     // return mesh;\r\n// }\r\n\r\n\r\nexport function setX1(mesh: THREE.Mesh, v: any) {\r\n    (mesh.geometry as THREE.Geometry).vertices[0].x = v\r\n}\r\nexport function setY1(mesh: THREE.Mesh, v: any) {\r\n    (mesh.geometry as THREE.Geometry).vertices[0].y = v\r\n}\r\nexport function setX2(mesh: THREE.Mesh, v: any) {\r\n    (mesh.geometry as THREE.Geometry).vertices[1].x = v\r\n}\r\nexport function setY2(mesh: THREE.Mesh, v: any) {\r\n    (mesh.geometry as THREE.Geometry).vertices[1].y = v\r\n}\r\n\r\n\r\n/////////////////////\r\n/// CREATE SHAPES /// \r\n/////////////////////\r\n\r\n// function fillCurve(color){\r\n//     var shape = new THREE.Shape(line.getSpacedPoints(100));\r\n//     var geometry = new THREE.ShapeGeometry( shape );\r\n//     var mesh = THREE.SceneUtils.createMultiMaterialObject( geometry, [ new THREE.MeshLambertMaterial( { color: 0xeeeeee } )] );\r\n//     for(var i=0 ; i < this.visualElements.length ; i++){\r\n\r\n//     }\r\n\r\n// }\r\n\r\nexport function createG(dataElements: any[], scene: THREE.Scene) {\r\n    var visualElements = []\r\n    // create group element for every data element\r\n    for (var i = 0; i < dataElements.length; i++) {\r\n        visualElements.push(new GroupElement());\r\n    }\r\n    return visualElements;\r\n}\r\n\r\nexport class GroupElement {\r\n    position = { x: 0, y: 0, z: 0 };\r\n    children: Object = [];\r\n}\r\n\r\nexport function createCirclesNoShader(dataElements: any[], scene: THREE.Scene) {\r\n    var material: any;\r\n    var geometry: any;\r\n    var visualElements: any[] = []\r\n    var c: any;\r\n    for (var i = 0; i < dataElements.length; i++) {\r\n        material = new THREE.MeshBasicMaterial({ color: 0x000000, transparent: true });\r\n        geometry = new THREE.CircleGeometry(1, 10);\r\n        geometry.dynamic = true;\r\n        c = new THREE.Mesh(geometry, material);\r\n        visualElements.push(c);\r\n        c.position.set(0, 0, 1)\r\n        c.scale.set(10, 10, 1)\r\n        scene.add(c);\r\n    }\r\n    return visualElements;\r\n}\r\n\r\n// SHADERS\r\nvar vertexShaderProgram = \"\\\r\n        attribute vec4 customColor;\\\r\n        varying vec4 vColor;\\\r\n        void main() {\\\r\n            vColor = customColor;\\\r\n            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1 );\\\r\n        }\";\r\n\r\n\r\nvar fragmentShaderProgram = \"\\\r\n        varying vec4 vColor;\\\r\n        void main() {\\\r\n            gl_FragColor = vec4(vColor[0], vColor[1], vColor[2], vColor[3]);\\\r\n        }\";\r\n\r\nexport function createCirclesWithBuffers(query: WebGLElementQuery, scene: THREE.Scene) {\r\n    var dataElements: Object[] = query.dataElements;\r\n    query.IS_SHADER = true;\r\n    var attributes: any = {\r\n        customColor: { type: 'c', value: [] }\r\n    }\r\n    var shaderMaterial: THREE.ShaderMaterial = new THREE.ShaderMaterial({\r\n        // attributes: attributes, // attributes doesn't exists\r\n        vertexShader: vertexShaderProgram,\r\n        fragmentShader: fragmentShaderProgram,\r\n        // lineWidth: 2 \r\n    });\r\n    shaderMaterial.blending = THREE.NormalBlending;\r\n    shaderMaterial.depthTest = true;\r\n    shaderMaterial.transparent = true;\r\n    shaderMaterial.side = THREE.DoubleSide;\r\n\r\n\r\n    var visualElements: any[] = []\r\n    var c: any;\r\n    var vertexPositionBuffer: any[] = []\r\n    var vertexColorBuffer: any[] = []\r\n    var geometry: THREE.BufferGeometry = new THREE.BufferGeometry();\r\n    // geometry.vertices.push(new THREE.Vector3(10, -10,0))\r\n    addBufferedRect([], 0, 0, 0, 10, 10, [], [0, 0, 1, .5])\r\n\r\n    for (var i = 0; i < dataElements.length; i++) {\r\n        // addBufferedCirlce(vertexPositionBuffer, Math.random()*10,Math.random()*10,0,2, vertexColorBuffer, [0,0,1,.5] )\r\n        query.x.push(0)\r\n        query.y.push(0)\r\n        query.z.push(0)\r\n        query.r.push(0)\r\n        query.fill.push('0x000000')\r\n        query.stroke.push('0x000000')\r\n        query.strokewidth.push(1)\r\n        query.opacity.push(1)\r\n    }\r\n    // geometry = new THREE.BufferGeometry();\r\n\r\n    // CREATE + ADD MESH\r\n    geometry.addAttribute('position', new THREE.BufferAttribute(makeBuffer3f([]), 3));\r\n\r\n    geometry.addAttribute('customColor', new THREE.BufferAttribute(makeBuffer4f([]), 4));\r\n    query.mesh = new THREE.Mesh(geometry, shaderMaterial);\r\n    query.mesh.position.set(0, 0, 1)\r\n\r\n    scene.add(query.mesh);\r\n    return query;\r\n}\r\n\r\nexport function createRectangles(dataElements: any[], scene: THREE.Scene) {\r\n    var material: any;\r\n    var geometry: any;\r\n    var visualElements: any[] = []\r\n    var c: any;\r\n    for (var i = 0; i < dataElements.length; i++) {\r\n        var rectShape = new THREE.Shape();\r\n        rectShape.moveTo(0, 0);\r\n        rectShape.lineTo(0, -1);\r\n        rectShape.lineTo(1, -1);\r\n        rectShape.lineTo(1, 0);\r\n        rectShape.lineTo(0, 0);\r\n\r\n        geometry = new THREE.ShapeGeometry(rectShape);\r\n        c = new THREE.Mesh(geometry, new THREE.MeshBasicMaterial({ color: 0x000000, transparent: true }));\r\n        c.position.set(0, 0, 1)\r\n        visualElements.push(c);\r\n        scene.add(c);\r\n\r\n        geometry = new THREE.Geometry()\r\n        geometry.vertices.push(\r\n            new THREE.Vector3(0, 0, 0),\r\n            new THREE.Vector3(0, -1, 0),\r\n            new THREE.Vector3(1, -1, 0),\r\n            new THREE.Vector3(1, 0, 0),\r\n            new THREE.Vector3(0, 0, 0)\r\n        );\r\n        var wireframe = new THREE.Line(geometry, new THREE.LineBasicMaterial({ color: 0x000000, transparent: true, linewidth: 1 }));\r\n        (c as any)['wireframe'] = wireframe;\r\n        wireframe.position.set(0, 0, 1.1)\r\n        scene.add(wireframe);\r\n    }\r\n    return visualElements;\r\n}\r\n\r\nexport function createPaths(dataElements: any[], scene: THREE.Scene) {\r\n    var material: any;\r\n    var geometry: any;\r\n    var visualElements: any[] = []\r\n    var c: any, p: any;\r\n    for (var i = 0; i < dataElements.length; i++) {\r\n        geometry = new THREE.Geometry();\r\n        c = new THREE.Line(geometry, new THREE.LineBasicMaterial({ color: 0x000000, transparent: true }));\r\n        c.position.set(0, 0, 0)\r\n        visualElements.push(c);\r\n        scene.add(c);\r\n    }\r\n    return visualElements;\r\n}\r\n\r\nexport function createPolygons(dataElements: any[], scene: THREE.Scene) {\r\n    var material: any;\r\n    var geometry: any;\r\n    var visualElements: any[] = []\r\n    var c: any, p: any;\r\n    for (var i = 0; i < dataElements.length; i++) {\r\n        geometry = new THREE.Geometry();\r\n        // geometry.vertices.push(\r\n        //     new THREE.Vector3(5, 0, 0 ),\r\n        //     new THREE.Vector3( 15, 3, 0 ),\r\n        //     new THREE.Vector3( 15, -3, 0 )\r\n        // );\r\n        // geometry.faces.push(new THREE.Face3(0, 1, 2)); \r\n        c = new THREE.Mesh(geometry, new THREE.MeshBasicMaterial({ color: 0x000000, transparent: true, side: THREE.DoubleSide }));\r\n        c.doubleSided = true;\r\n        c.position.set(0, 0, 0)\r\n        visualElements.push(c);\r\n        scene.add(c);\r\n    }\r\n    return visualElements;\r\n}\r\n\r\nexport function createLines(dataElements: any[], scene: THREE.Scene) {\r\n    var material: any;\r\n    var geometry: any;\r\n    var visualElements: any[] = []\r\n    var c: any, p: any;\r\n    for (var i = 0; i < dataElements.length; i++) {\r\n        geometry = new THREE.Geometry();\r\n        geometry.vertices.push(\r\n            new THREE.Vector3(-10, 0, 0),\r\n            new THREE.Vector3(0, 10, 0));\r\n        c = new THREE.Line(geometry, new THREE.LineBasicMaterial({ color: 0x000000, transparent: true }));\r\n        c.position.set(0, 0, 0)\r\n        visualElements.push(c);\r\n        scene.add(c);\r\n    }\r\n    return visualElements;\r\n}\r\n\r\nexport function createWebGLText(dataElements: any[], scene: THREE.Scene) {\r\n    var visualElements = []\r\n    var mesh: any;\r\n    for (var i = 0; i < dataElements.length; i++) {\r\n        mesh = new THREE.Mesh(new THREE.PlaneGeometry(1000, 100), new THREE.MeshBasicMaterial());\r\n        mesh.doubleSided = true;\r\n        visualElements.push(mesh);\r\n        scene.add(mesh);\r\n    }\r\n    return visualElements;\r\n}\r\n\r\nexport function createPath(mesh: THREE.Mesh, points: any[]) {\r\n    (mesh.geometry as THREE.Geometry).vertices = []\r\n    for (var i = 0; i < points.length; i++) {\r\n        (mesh.geometry as THREE.Geometry).vertices.push(new THREE.Vector3(points[i].x, points[i].y, 0));\r\n    }\r\n    (mesh.geometry as THREE.Geometry).verticesNeedUpdate = true;\r\n}\r\n\r\nexport function createPolygon(mesh: THREE.Mesh, points: THREE.Vector2[]) {\r\n    var vectors = []\r\n    var shape = new THREE.Shape(points);\r\n    mesh.geometry = new THREE.ShapeGeometry(shape);\r\n    mesh.geometry.verticesNeedUpdate = true;\r\n}\r\n\r\n\r\n\r\n\r\n///////////////////\r\n/// INTERACTION /// \r\n///////////////////\r\n\r\n\r\nexport class WebGLInteractor {\r\n    scene: any;\r\n    canvas: any;\r\n    camera: any;\r\n    raycaster: any;\r\n    mouse: any[] = [];\r\n    mouseStart: any[] = []\r\n    mouseDown: boolean = false;\r\n    cameraStart: any[] = []\r\n    panOffset: any[] = []\r\n    lastIntersectedSelections: any[] = []\r\n    lastIntersectedElements: any[] = []\r\n    isPanEnabled: boolean = true;\r\n    isHorizontalPanEnabled: boolean = true;\r\n\r\n    isLassoEnabled: boolean = true;\r\n    lassoPoints: any[] = []\r\n    lassoStartHandler: any; // BEFORE Function;\r\n    lassoMoveHandler: any; // BEFORE Function;\r\n    lassoEndHandler: any; // BEFORE Function;\r\n\r\n    mouseOverSelections: WebGLElementQuery[] = []\r\n    mouseMoveSelections: WebGLElementQuery[] = []\r\n    mouseOutSelections: WebGLElementQuery[] = []\r\n    mouseDownSelections: WebGLElementQuery[] = []\r\n    mouseUpSelections: WebGLElementQuery[] = []\r\n    clickSelections: WebGLElementQuery[] = []\r\n\r\n    constructor(scene: THREE.Scene, canvas: HTMLCanvasElement, camera: THREE.Camera) {\r\n        this.scene = scene;\r\n        this.canvas = canvas\r\n        this.camera = camera;\r\n        this.mouse = [0, 0];\r\n        canvas.addEventListener('mousemove', (e) => {\r\n            this.mouseMoveHandler(e);\r\n        })\r\n        canvas.addEventListener('mousedown', (e) => {\r\n            this.mouseDownHandler(e);\r\n        })\r\n        canvas.addEventListener('mouseup', (e) => {\r\n            this.mouseUpHandler(e);\r\n        })\r\n        canvas.addEventListener('click', (e) => {\r\n            this.clickHandler(e);\r\n        })\r\n\r\n        // not really working in iFrames..\r\n        // window.addEventListener('keyDown', (e)=>{\r\n        //     this.keyDownHandler(e);\r\n        // })\r\n        // window.addEventListener('keyUp', (e)=>{\r\n        //     this.keyUpHandler(e);\r\n        // })\r\n    }\r\n\r\n    register(selection: WebGLElementQuery, method: string) {\r\n        switch (method) {\r\n            case 'mouseover': this.mouseOverSelections.push(selection); break;\r\n            case 'mousemove': this.mouseMoveSelections.push(selection); break;\r\n            case 'mouseout': this.mouseOutSelections.push(selection); break;\r\n            case 'mousedown': this.mouseDownSelections.push(selection); break;\r\n            case 'mouseup': this.mouseUpSelections.push(selection); break;\r\n            case 'click': this.clickSelections.push(selection); break;\r\n        }\r\n    }\r\n\r\n    addEventListener(eventName: String, f: Function) {\r\n        if (eventName == 'lassoStart')\r\n            this.lassoStartHandler = f;\r\n        if (eventName == 'lassoEnd')\r\n            this.lassoEndHandler = f;\r\n        if (eventName == 'lassoMove')\r\n            this.lassoMoveHandler = f;\r\n    }\r\n\r\n\r\n    // Event handlers\r\n    mouseMoveHandler(e: any) {\r\n        this.mouse = mouseToWorldCoordinates(e.clientX, e.clientY)\r\n\r\n        if (this.isLassoEnabled && e.which == 2) {\r\n            this.lassoPoints.push(this.mouse)\r\n            if (this.lassoMoveHandler)\r\n                this.lassoMoveHandler(this.lassoPoints);\r\n        } else {\r\n            var intersectedVisualElements: any[] = []\r\n\r\n            // remove previous highlighting\r\n            for (var i = 0; i < this.lastIntersectedSelections.length; i++) {\r\n                for (var j = 0; j < this.lastIntersectedElements[i].length; j++) {\r\n                    this.lastIntersectedSelections[i].call('mouseout', this.lastIntersectedElements[i][j])\r\n                }\r\n            }\r\n\r\n            this.lastIntersectedSelections = []\r\n            this.lastIntersectedElements = []\r\n\r\n            var nothingIntersected = true;\r\n\r\n            // call mouseover on all elements with a mouse over handler\r\n            for (var i = 0; i < this.mouseOverSelections.length; i++) {\r\n                // If selecton is SHADER, check manually\r\n                intersectedVisualElements = this.intersect(this.mouseOverSelections[i], this.mouse[0], this.mouse[1]);\r\n                if (intersectedVisualElements.length > 0) {\r\n                    this.lastIntersectedElements.push(intersectedVisualElements);\r\n                    this.lastIntersectedSelections.push(this.mouseOverSelections[i])\r\n                }\r\n                for (var j = 0; j < intersectedVisualElements.length; j++) {\r\n                    this.mouseOverSelections[i].call('mouseover', intersectedVisualElements[j], e)\r\n                }\r\n                if (intersectedVisualElements.length > 0)\r\n                    nothingIntersected = false;\r\n            }\r\n\r\n            // call mousemove on all elements with a mouse move handler\r\n            for (var i = 0; i < this.mouseMoveSelections.length; i++) {\r\n                intersectedVisualElements = this.intersect(this.mouseMoveSelections[i], this.mouse[0], this.mouse[1]);\r\n                for (var j = 0; j < intersectedVisualElements.length; j++) {\r\n                    this.mouseMoveSelections[i].call('mousemove', intersectedVisualElements[j], e)\r\n                }\r\n                if (intersectedVisualElements.length > 0)\r\n                    nothingIntersected = false;\r\n            }\r\n\r\n            // if nothing intersected pan:\r\n            if (nothingIntersected && this.mouseDown) {\r\n                if (this.isPanEnabled) {\r\n                    this.panOffset = [e.clientX - this.mouseStart[0], e.clientY - this.mouseStart[1]]\r\n                    if (this.isHorizontalPanEnabled)\r\n                        webgl.camera.position.x = this.cameraStart[0] - this.panOffset[0] / webgl.camera.zoom;\r\n                    webgl.camera.position.y = this.cameraStart[1] + this.panOffset[1] / webgl.camera.zoom;\r\n                    webgl.render();\r\n                }\r\n            }\r\n        }\r\n\r\n\r\n\r\n    }\r\n    clickHandler(e: any) {\r\n        this.mouse = mouseToWorldCoordinates(e.clientX, e.clientY)\r\n\r\n        var intersectedVisualElements: any[] = []\r\n\r\n        // call mouseclick on all elements with a mouse over handler\r\n        for (var i = 0; i < this.clickSelections.length; i++) {\r\n            intersectedVisualElements = this.intersect(this.clickSelections[i], this.mouse[0], this.mouse[1]);\r\n            for (var j = 0; j < intersectedVisualElements.length; j++) {\r\n                this.clickSelections[i].call('click', intersectedVisualElements[j], e)\r\n            }\r\n        }\r\n        this.mouseDown = false;\r\n    }\r\n\r\n    mouseDownHandler(e: any) {\r\n        this.mouse = mouseToWorldCoordinates(e.clientX, e.clientY)\r\n        this.mouseStart = [e.clientX, e.clientY]\r\n        this.cameraStart = [webgl.camera.position.x, webgl.camera.position.y];\r\n        this.mouseDown = true;\r\n        var intersectedVisualElements: any[] = []\r\n        for (var i = 0; i < this.mouseDownSelections.length; i++) {\r\n            intersectedVisualElements = this.intersect(this.mouseDownSelections[i], this.mouse[0], this.mouse[1]);\r\n            for (var j = 0; j < intersectedVisualElements.length; j++) {\r\n                this.mouseDownSelections[i].call('mousedown', intersectedVisualElements[j], e)\r\n            }\r\n        }\r\n        this.lassoPoints = []\r\n        this.lassoPoints.push(this.mouse)\r\n        if (this.lassoStartHandler && e.which == 2) {\r\n            this.lassoStartHandler(this.lassoPoints);\r\n        }\r\n    }\r\n    mouseUpHandler(e: any) {\r\n        this.mouse = mouseToWorldCoordinates(e.clientX, e.clientY)\r\n        var intersectedVisualElements: any[] = []\r\n        for (var i = 0; i < this.mouseUpSelections.length; i++) {\r\n            intersectedVisualElements = this.intersect(this.mouseUpSelections[i], this.mouse[0], this.mouse[1]);\r\n            for (var j = 0; j < intersectedVisualElements.length; j++) {\r\n                this.mouseUpSelections[i].call('mouseup', intersectedVisualElements[j], e)\r\n            }\r\n        }\r\n        this.mouseDown = false;\r\n        if (this.lassoEndHandler && e.which == 2) {\r\n            this.lassoEndHandler(this.lassoPoints);\r\n        }\r\n    }\r\n\r\n    intersect(selection: WebGLElementQuery, mousex?: any, mousey?: any): any[] {\r\n        switch (selection.shape) {\r\n            case 'circle': return this.intersectCircles(selection); break;\r\n            case 'rect': return this.intersectRects(selection); break;\r\n            case 'path': return this.intersectPaths(selection); break;\r\n            case 'text': return this.intersectRects(selection); break;\r\n        }\r\n        return []\r\n    }\r\n\r\n    // returns list of data elements \r\n\r\n    intersectCircles(selection: WebGLElementQuery): any[] {\r\n        var intersectedElements = []\r\n        var d;\r\n        for (var i = 0; i < selection.dataElements.length; i++) {\r\n            d = Math.sqrt(Math.pow(this.mouse[0] - selection.x[i], 2) + Math.pow(this.mouse[1] - selection.y[i], 2))\r\n            if (d <= selection.r[i])\r\n                intersectedElements.push(selection.dataElements[i]);\r\n        }\r\n\r\n        return intersectedElements;\r\n    }\r\n    intersectRects(selection: WebGLElementQuery): any[] {\r\n        var intersectedElements = []\r\n        var d;\r\n        var e;\r\n        for (var i = 0; i < selection.visualElements.length; i++) {\r\n            e = selection.visualElements[i];\r\n            if (this.mouse[0] >= e.position.x && this.mouse[0] <= e.position.x + e.geometry.vertices[0].x * e.scale.x\r\n                && this.mouse[1] <= e.position.y && this.mouse[1] >= e.position.y + e.geometry.vertices[1].y * e.scale.y\r\n            )\r\n                intersectedElements.push(selection.dataElements[i]);\r\n        }\r\n        return intersectedElements;\r\n    }\r\n    intersectPaths(selection: WebGLElementQuery): any[] {\r\n        var intersectedElements = []\r\n        var e;\r\n        var v1, v2\r\n        var x, y\r\n        var found = false\r\n        for (var i = 0; i < selection.visualElements.length; i++) {\r\n            e = selection.visualElements[i];\r\n            for (var j = 1; j < e.geometry.vertices.length; j++) {\r\n                v1 = e.geometry.vertices[j - 1]\r\n                v1 = {\r\n                    x: v1.x + selection.x[i],\r\n                    y: v1.y + selection.y[i]\r\n                }\r\n                v2 = e.geometry.vertices[j]\r\n                v2 = {\r\n                    x: v2.x + selection.x[i],\r\n                    y: v2.y + selection.y[i]\r\n                }\r\n                if (distToSegmentSquared({ x: this.mouse[0], y: this.mouse[1] }, v1, v2) < 3) {\r\n                    intersectedElements.push(selection.dataElements[i]);\r\n                    found = true;\r\n                    break;\r\n                }\r\n            }\r\n            if (found)\r\n                break;\r\n        }\r\n\r\n        return intersectedElements;\r\n\r\n        function sqr(x: number) {\r\n            return x * x\r\n        }\r\n        function dist2(v: any, w: any) {\r\n            return sqr(v.x - w.x) + sqr(v.y - w.y)\r\n        }\r\n        function distToSegmentSquared(p: any, v: any, w: any) {\r\n            var l2 = dist2(v, w);\r\n\r\n            if (l2 == 0) return dist2(p, v);\r\n\r\n            var t = ((p.x - v.x) * (w.x - v.x) + (p.y - v.y) * (w.y - v.y)) / l2;\r\n\r\n            if (t < 0) return dist2(p, v);\r\n            if (t > 1) return dist2(p, w);\r\n\r\n            return dist2(p, { x: v.x + t * (w.x - v.x), y: v.y + t * (w.y - v.y) });\r\n        }\r\n\r\n        function distToSegment(p: any, v: any, w: any) {\r\n            return Math.sqrt(distToSegmentSquared(p, v, w));\r\n        }\r\n    }\r\n\r\n\r\n}\r\n\r\n// Calculate intersection\r\nexport function mouseToWorldCoordinates(mouseX: any, mouseY: any) {\r\n    var rect = webgl.canvas.getBoundingClientRect();\r\n    var x = webgl.camera.position.x + webgl.camera.left / webgl.camera.zoom + (mouseX - rect.left) / webgl.camera.zoom;\r\n    var y = webgl.camera.position.y + webgl.camera.top / webgl.camera.zoom - (mouseY - rect.top) / webgl.camera.zoom;            // this.mouse[1] *= -1\r\n    return [x, y];\r\n}\r\n\r\n\r\n\r\nexport function curve(points: any[]): any[] {\r\n    var arrayPoints: any[] = []\r\n    for (var i = 0; i < points.length; i++) {\r\n        if (!isNaN(points[i].x))\r\n            arrayPoints.push([points[i].x, points[i].y])\r\n    }\r\n\r\n    var spline = new BSpline(arrayPoints, 3); //making BSpline\r\n    var curvePoints = []\r\n    for (var t = 0; t <= 1; t += 0.01) {\r\n        var p = spline.calcAt(t);\r\n        curvePoints.push({ x: p[0], y: p[1] })\r\n    }\r\n    return curvePoints;\r\n}\r\n\r\n\r\n///////////////////\r\n/// UI ELEMENTS ///\r\n///////////////////\r\n\r\nexport class CheckBox {\r\n    selected: boolean = false;\r\n    changeCallBack: any; // BEFORE Function;\r\n    circle: any;\r\n    frame: any;\r\n\r\n    constructor() {\r\n        this.frame = selectAll()\r\n            .data([0])\r\n            .append('circle')\r\n            .attr('r', 5)\r\n            .style('fill', '#fff')\r\n            .style('stroke', '#000000')\r\n            .on('click', () => {\r\n                this.selected = !this.selected;\r\n                this.circle.style('opacity', this.selected ? 1 : 0)\r\n                if (this.changeCallBack != undefined)\r\n                    this.changeCallBack();\r\n            })\r\n        this.circle = selectAll()\r\n            .data([0]);\r\n        // .append('circle')\r\n        //     .attr('r', 3)\r\n        //     .attr('z', 1)\r\n        //     .style('fill', '#000000')\r\n        //     .style('opacity', 0);\r\n    }\r\n\r\n    attr(attrName: string, value: any) {\r\n        switch (attrName) {\r\n            case 'x':\r\n                this.frame.attr('x', value);\r\n                // this.circle.attr('x', value); \r\n                return this;\r\n            case 'y':\r\n                this.frame.attr('y', value);\r\n                // this.circle.attr('y', value); \r\n                return this;\r\n        }\r\n\r\n    }\r\n\r\n    on(eventType: string, fn: Function) {\r\n        switch (eventType) {\r\n            case 'change': this.changeCallBack = fn;\r\n        }\r\n    }\r\n}\r\n\r\n\r\n// }\r\n\r\n\r\n\r\nexport class THREEx {\r\n    canvas: any;\r\n    context: any;\r\n    texture: any;\r\n\r\n    /**\r\n     * create a dynamic texture with a underlying canvas\r\n     * \r\n     * @param {Number} width  width of the canvas\r\n     * @param {Number} height height of the canvas\r\n    */\r\n    constructor(width: number, height: number) {\r\n        var canvas = document.createElement('canvas')\r\n        canvas.width = width\r\n        canvas.height = height\r\n        this.canvas = canvas\r\n\r\n        var context = canvas.getContext('2d')\r\n        this.context = context\r\n\r\n        var texture = new THREE.Texture(canvas)\r\n        this.texture = texture\r\n    }\r\n\r\n\r\n    /**\r\n     * clear the canvas\r\n     * \r\n     * @param  {String*} fillStyle \t\tthe fillStyle to clear with, if not provided, fallback on .clearRect\r\n     * @return {THREEx.DynamicTexture}      the object itself, for chained texture\r\n     */\r\n\r\n    clear(fillStyle?: any) {\r\n        // depends on fillStyle\r\n        if (fillStyle !== undefined) {\r\n            this.context.fillStyle = fillStyle\r\n            this.context.fillRect(0, 0, this.canvas.width, this.canvas.height)\r\n        } else {\r\n            this.context.clearRect(0, 0, this.canvas.width, this.canvas.height)\r\n        }\r\n        // make the texture as .needsUpdate\r\n        this.texture.needsUpdate = true;\r\n        // for chained API \r\n        return this;\r\n    }\r\n\r\n\r\n    /**\r\n     * draw text\r\n     * \r\n     * @param  {String}\t\ttext\tthe text to display\r\n     * @param  {Number|undefined}\tx\tif provided, it is the x where to draw, if not, the text is centered\r\n     * @param  {Number}\t\ty\tthe y where to draw the text\r\n     * @param  {String*} \t\tfillStyle the fillStyle to clear with, if not provided, fallback on .clearRect\r\n     * @param  {String*} \t\tcontextFont the font to use\r\n     * @return {THREEx.DynamicTexture}\tthe object itself, for chained texture\r\n     */\r\n\r\n    drawText(text: string, x: number | undefined, y: number, fillStyle?: string, contextFont?: string) {\r\n        // set font if needed\r\n        if (contextFont !== undefined) this.context.font = contextFont;\r\n        // if x isnt provided \r\n        if (x === undefined || x === null) {\r\n            var textSize = this.context.measureText(text);\r\n            x = (this.canvas.width - textSize.width) / 2;\r\n        }\r\n        // actually draw the text\r\n        this.context.fillStyle = fillStyle;\r\n        this.context.fillText(text, x, y);\r\n        // make the texture as .needsUpdate\r\n        this.texture.needsUpdate = true;\r\n        // for chained API \r\n        return this;\r\n    };\r\n\r\n    drawTextCooked(text: string, options: any) {\r\n        var context = this.context\r\n        var canvas = this.canvas\r\n        options = options || {}\r\n        var params = {\r\n            margin: options.margin !== undefined ? options.margin : 0.1,\r\n            lineHeight: options.lineHeight !== undefined ? options.lineHeight : 0.1,\r\n            align: options.align !== undefined ? options.align : 'left',\r\n            fillStyle: options.fillStyle !== undefined ? options.fillStyle : 'black',\r\n        }\r\n        context.save()\r\n        context.fillStyle = params.fillStyle;\r\n\r\n        var y = (params.lineHeight + params.margin) * canvas.height\r\n        while (text.length > 0) {\r\n            // compute the text for specifically this line\r\n            var maxText = computeMaxTextLength(text)\r\n            // update the remaining text\r\n            text = text.substr(maxText.length)\r\n\r\n            // compute x based on params.align\r\n            var textSize = context.measureText(maxText);\r\n\r\n            // new variable to recognize if x exists or not\r\n            var computeX: boolean = true;\r\n            var x: number = 0;\r\n            if (params.align === 'left') {\r\n                x = params.margin * canvas.width\r\n            } else if (params.align === 'right') {\r\n                x = (1 - params.margin) * canvas.width - textSize.width\r\n            } else if (params.align === 'center') {\r\n                x = (canvas.width - textSize.width) / 2;\r\n            } else {\r\n                computeX = false;\r\n                console.assert(false)\r\n            }\r\n\r\n            if (computeX) {\r\n                // actually draw the text at the proper position\r\n                this.context.fillText(maxText, x, y);\r\n            }\r\n\r\n            // goto the next line\r\n            y += params.lineHeight * canvas.height\r\n        }\r\n        context.restore()\r\n\r\n        // make the texture as .needsUpdate\r\n        this.texture.needsUpdate = true;\r\n        // for chained API\r\n        return this;\r\n\r\n        function computeMaxTextLength(text: string) {\r\n            var maxText = ''\r\n            var maxWidth = (1 - params.margin * 2) * canvas.width\r\n            while (maxText.length !== text.length) {\r\n                var textSize = context.measureText(maxText);\r\n                if (textSize.width > maxWidth) break;\r\n                maxText += text.substr(maxText.length, 1)\r\n            }\r\n            return maxText\r\n        }\r\n    }\r\n\r\n    /**\r\n     * execute the drawImage on the internal context\r\n     * the arguments are the same the official context2d.drawImage\r\n     */\r\n    drawImage(/* same params as context2d.drawImage */) {\r\n        // call the drawImage\r\n        this.context.drawImage.apply(this.context, arguments)\r\n        // make the texture as .needsUpdate\r\n        this.texture.needsUpdate = true;\r\n        // for chained API \r\n        return this;\r\n    }\r\n\r\n}\r\n\r\n/*\r\nvar THREEx: any = THREEx || {}\r\n\r\n//////////////////////////////////////////////////////////////////////////////////\r\n//\t\tConstructor\t\t\t\t\t\t\t//\r\n//////////////////////////////////////////////////////////////////////////////////\r\n\r\n/**\r\n * create a dynamic texture with a underlying canvas\r\n * \r\n * @param {Number} width  width of the canvas\r\n * @param {Number} height height of the canvas\r\n */\r\n/*\r\nTHREEx.DynamicTexture = function (width: number, height: number) {\r\n    var canvas = document.createElement('canvas')\r\n    canvas.width = width\r\n    canvas.height = height\r\n    this.canvas = canvas\r\n\r\n    var context = canvas.getContext('2d')\r\n    this.context = context\r\n\r\n    var texture = new THREE.Texture(canvas)\r\n    this.texture = texture\r\n}\r\n\r\n//////////////////////////////////////////////////////////////////////////////////\r\n//\t\tmethods\t\t\t\t\t\t\t\t//\r\n//////////////////////////////////////////////////////////////////////////////////\r\n\r\n/**\r\n * clear the canvas\r\n * \r\n * @param  {String*} fillStyle \t\tthe fillStyle to clear with, if not provided, fallback on .clearRect\r\n * @return {THREEx.DynamicTexture}      the object itself, for chained texture\r\n */\r\n/*\r\nTHREEx.DynamicTexture.prototype.clear = function (fillStyle: any) {\r\n    // depends on fillStyle\r\n    if (fillStyle !== undefined) {\r\n        this.context.fillStyle = fillStyle\r\n        this.context.fillRect(0, 0, this.canvas.width, this.canvas.height)\r\n    } else {\r\n        this.context.clearRect(0, 0, this.canvas.width, this.canvas.height)\r\n    }\r\n    // make the texture as .needsUpdate\r\n    this.texture.needsUpdate = true;\r\n    // for chained API \r\n    return this;\r\n}\r\n\r\n/**\r\n * draw text\r\n * \r\n * @param  {String}\t\ttext\tthe text to display\r\n * @param  {Number|undefined}\tx\tif provided, it is the x where to draw, if not, the text is centered\r\n * @param  {Number}\t\ty\tthe y where to draw the text\r\n * @param  {String*} \t\tfillStyle the fillStyle to clear with, if not provided, fallback on .clearRect\r\n * @param  {String*} \t\tcontextFont the font to use\r\n * @return {THREEx.DynamicTexture}\tthe object itself, for chained texture\r\n */\r\n/*\r\nTHREEx.DynamicTexture.prototype.drawText = function (text, x, y, fillStyle, contextFont) {\r\n    // set font if needed\r\n    if (contextFont !== undefined) this.context.font = contextFont;\r\n    // if x isnt provided \r\n    if (x === undefined || x === null) {\r\n        var textSize = this.context.measureText(text);\r\n        x = (this.canvas.width - textSize.width) / 2;\r\n    }\r\n    // actually draw the text\r\n    this.context.fillStyle = fillStyle;\r\n    this.context.fillText(text, x, y);\r\n    // make the texture as .needsUpdate\r\n    this.texture.needsUpdate = true;\r\n    // for chained API \r\n    return this;\r\n};\r\n\r\nTHREEx.DynamicTexture.prototype.drawTextCooked = function (text, options) {\r\n    var context = this.context\r\n    var canvas = this.canvas\r\n    options = options || {}\r\n    var params = {\r\n        margin: options.margin !== undefined ? options.margin : 0.1,\r\n        lineHeight: options.lineHeight !== undefined ? options.lineHeight : 0.1,\r\n        align: options.align !== undefined ? options.align : 'left',\r\n        fillStyle: options.fillStyle !== undefined ? options.fillStyle : 'black',\r\n    }\r\n    context.save()\r\n    context.fillStyle = params.fillStyle;\r\n\r\n    var y = (params.lineHeight + params.margin) * canvas.height\r\n    while (text.length > 0) {\r\n        // compute the text for specifically this line\r\n        var maxText = computeMaxTextLength(text)\r\n        // update the remaining text\r\n        text = text.substr(maxText.length)\r\n\r\n\r\n        // compute x based on params.align\r\n        var textSize = context.measureText(maxText);\r\n        if (params.align === 'left') {\r\n            var x = params.margin * canvas.width\r\n        } else if (params.align === 'right') {\r\n            var x = (1 - params.margin) * canvas.width - textSize.width\r\n        } else if (params.align === 'center') {\r\n            var x = (canvas.width - textSize.width) / 2;\r\n        } else console.assert(false)\r\n\r\n        // actually draw the text at the proper position\r\n        this.context.fillText(maxText, x, y);\r\n\r\n        // goto the next line\r\n        y += params.lineHeight * canvas.height\r\n    }\r\n    context.restore()\r\n\r\n    // make the texture as .needsUpdate\r\n    this.texture.needsUpdate = true;\r\n    // for chained API\r\n    return this;\r\n\r\n    function computeMaxTextLength(text) {\r\n        var maxText = ''\r\n        var maxWidth = (1 - params.margin * 2) * canvas.width\r\n        while (maxText.length !== text.length) {\r\n            var textSize = context.measureText(maxText);\r\n            if (textSize.width > maxWidth) break;\r\n            maxText += text.substr(maxText.length, 1)\r\n        }\r\n        return maxText\r\n    }\r\n}\r\n\r\n/**\r\n * execute the drawImage on the internal context\r\n * the arguments are the same the official context2d.drawImage\r\n */\r\n/*\r\nTHREEx.DynamicTexture.prototype.drawImage = function () {\r\n    // call the drawImage\r\n    this.context.drawImage.apply(this.context, arguments)\r\n    // make the texture as .needsUpdate\r\n    this.texture.needsUpdate = true;\r\n    // for chained API \r\n    return this;\r\n}\r\n*/\r\n\r\n\r\n\r\n//////////////////\r\n/// VECTOR OPS ///\r\n//////////////////\r\n\r\n//module geometry {\r\n\r\nexport function length(v1: any[]) {\r\n    return Math.sqrt(v1[0] * v1[0] + v1[1] * v1[1]);\r\n}\r\n\r\nexport function normalize(v: number[]) {\r\n    var l = length(v)\r\n    return [v[0] / l, v[1] / l]\r\n}\r\n\r\nexport function setLength(v: number[], l: number) {\r\n    var len = length(v)\r\n    return [l * v[0] / len, l * v[1] / len]\r\n}\r\n\r\n\r\n//}\r\n\r\n\r\n\r\n","/// <reference path=\"./lib/d3.d.ts\"/>\r\n\r\nimport * as dynamicgraph from './dynamicgraph';\r\n\r\n//import * as d3 from 'd3'\r\n\r\nimport $ from 'jquery'\r\n\r\nexport class Legend {\r\n\r\n    data: any[]\r\n\r\n    margin = {\r\n        left: 10,\r\n        top: 20\r\n    }\r\n\r\n    height: number = 0; // INIT ???? \r\n\r\n    constructor(data: dynamicgraph.LegendElement[], handlerFunction?: Function) {\r\n        this.data = data;\r\n    }\r\n\r\n    setClickCallBack(handlerFunction: Function) {\r\n        this.clickCallBack = handlerFunction;\r\n    }\r\n\r\n    legendEntries: any;\r\n\r\n    clickCallBack: any; // BEFORE Function;\r\n\r\n    appendTo(svg: SVGSVGElement) {\r\n\r\n        this.legendEntries = d3.select('#legendSvg')\r\n            .selectAll('.legend')\r\n            .data(this.data)\r\n            .enter().append('g')\r\n            .attr('transform', (d: any, i: any) => {\r\n                return 'translate(' + this.margin.left + ',' + (this.margin.top + i * 20) + ')'\r\n            })\r\n        this.height = this.margin.top + this.data.length * 20\r\n\r\n        $(svg).height(this.height);\r\n\r\n\r\n        this.legendEntries.append('circle')\r\n            .attr('r', 5)\r\n            .style('opacity', .7)\r\n            .style('fill', function (d: any) {\r\n                if (d.color)\r\n                    return d.color;\r\n                else\r\n                    return '#000';\r\n            })\r\n            .style('stroke', function (d: any) {\r\n                if (d.color)\r\n                    return d.color;\r\n                else\r\n                    return '#000';\r\n            })\r\n            .style('stroke-width', 2)\r\n            .on('click', this.clickCallBack);\r\n\r\n        this.legendEntries.append('text')\r\n            .text(function (d: any) {\r\n                return d.name;\r\n            })\r\n            .attr('x', 20)\r\n            .attr('y', 5)\r\n    }\r\n\r\n}\r\n","/// <reference path=\"./lib/d3.d.ts\"/>\r\n\r\nexport class RangeSlider {\r\n\r\n    /* VISUALIZATION PARAMETERS */\r\n    BAR_WIDTH: number = 5;\r\n    RADIUS_HANDLE: number = 4;\r\n\r\n    LEFT: number = this.RADIUS_HANDLE;\r\n    RIGHT: number = this.RADIUS_HANDLE;\r\n    HEIGHT: number = 10;\r\n    TOP: number = 0;\r\n\r\n    max: number;\r\n    min: number;\r\n    stepWidth: number;\r\n    hasTickmarks: boolean;\r\n    isInverted: boolean = false;\r\n\r\n    svg: any; // BEFORE d3.Selection<d3.BaseType, {}, HTMLElement, any>; // ???????????????\r\n    x: number;\r\n    y: number;\r\n    width: number;\r\n    g: any; // BEFORE d3.Selection<d3.BaseType, {}, HTMLElement, any>; // ???????????????\r\n\r\n    dragEndCallBackFn: any; // BEFORE Function;\r\n\r\n    constructor(\r\n        x: number,\r\n        y: number,\r\n        width: number,\r\n        minValue: number,\r\n        maxValue: number,\r\n        stepWidth: number,\r\n        tickMarks?: boolean) {\r\n        this.x = x;\r\n        this.y = y;\r\n        this.width = width;\r\n        this.min = minValue;\r\n        this.max = maxValue;\r\n        this.stepWidth = stepWidth;\r\n\r\n        if (tickMarks != undefined)\r\n            this.hasTickmarks = tickMarks;\r\n        else\r\n            this.hasTickmarks = false;\r\n    }\r\n\r\n    setDragEndCallBack(fn: Function) {\r\n        this.dragEndCallBackFn = fn;\r\n    }\r\n\r\n\r\n    valueRange: any; // BEFORE d3.ScaleLinear<number, number>;\r\n    val2spaceScale: any; // BEFORE d3.ScaleLinear<number, number>;\r\n\r\n    drag: any; // BEFORE d3.DragBehavior<Element, {}, {} | d3.SubjectPosition>;\r\n    bar0: any; // BEFORE d3.Selection<d3.BaseType, {}, HTMLElement, any>;\r\n    bar1: any; // BEFORE d3.Selection<d3.BaseType, {}, HTMLElement, any>;\r\n    circleMin: any;\r\n    circleMax: any;\r\n    rect: any;\r\n\r\n    appendTo(svg: D3.Selection) {\r\n\r\n        this.svg = svg;\r\n\r\n        //this.rect = this.svg['_groups'][0][0].getBoundingClientRect(); // d3 v4\r\n        this.rect = this.svg[0][0].getBoundingClientRect();\r\n\r\n        this.valueRange = d3.scale.linear()\r\n            .domain([0, this.width])\r\n            .range([this.min, this.max])\r\n\r\n\r\n        this.drag = d3.behavior.drag()\r\n            .origin(Object)\r\n            .on(\"dragstart\", () => { this.dragStart() }) // d3 v4 is only \"start\"\r\n            .on(\"drag\", () => { this.dragMove() })\r\n\r\n        this.svg = svg;\r\n\r\n        this.g = svg.append(\"g\")\r\n            .attr(\"height\", this.HEIGHT)\r\n            .attr(\"width\", this.width)\r\n            .attr(\"transform\", \"translate(\" + this.x + \",\" + this.y + \")\");\r\n\r\n        this.g.append(\"line\")\r\n            .attr(\"x1\", this.LEFT)\r\n            .attr(\"y1\", this.TOP)\r\n            .attr(\"x2\", this.width - this.RIGHT - this.LEFT)\r\n            .attr(\"y2\", this.TOP)\r\n            .style(\"stroke\", \"#aaa\");\r\n\r\n        if (this.hasTickmarks) {\r\n            this.val2spaceScale = d3.scale.linear()\r\n                .domain([this.min, this.max])\r\n                .range([this.LEFT, this.width - this.RIGHT - this.LEFT]);\r\n\r\n            for (var i = this.min; i <= this.max; i += this.stepWidth) {\r\n                var x = this.val2spaceScale(i);\r\n                this.g.append(\"line\")\r\n                    .attr('class', 'rangeTick')\r\n                    .attr(\"x1\", x)\r\n                    .attr(\"y1\", this.TOP)\r\n                    .attr(\"x2\", x)\r\n                    .attr(\"y2\", this.TOP + 20)\r\n                    .style('stroke', '#bbb');\r\n\r\n                this.g.append('text')\r\n                    .attr('class', 'rangeTickText')\r\n                    .attr('x', x)\r\n                    .attr('y', this.TOP + 20)\r\n                    .text(i.toFixed(1))\r\n                    .style('opacity', .5)\r\n                    .style('font-family', 'Helvetica')\r\n                    .style('font-weigth', '100')\r\n                    .style('font-size', '7pt');\r\n            }\r\n        }\r\n\r\n        if (this.isInverted) {\r\n            this.bar0 = this.g.append('rect')\r\n                .attr('x', this.LEFT)\r\n                .attr('y', this.TOP)\r\n                .attr('height', this.BAR_WIDTH)\r\n                .attr('width', 0)\r\n                .style('fill', '#bbb')\r\n                .call(this.drag)\r\n                .attr('id', 'bar0');\r\n            this.bar1 = this.g.append('rect')\r\n                .attr('x', this.RIGHT)\r\n                .attr('y', this.TOP)\r\n                .attr('height', this.BAR_WIDTH)\r\n                .attr('width', 0)\r\n                .style('fill', '#bbb')\r\n                .call(this.drag)\r\n                .attr('id', 'bar1');\r\n        } else {\r\n            this.bar0 = this.g.append('rect')\r\n                .attr('x', this.LEFT)\r\n                .attr('y', this.TOP)\r\n                .attr('height', this.BAR_WIDTH)\r\n                .attr('width', this.width - this.RIGHT - this.LEFT)\r\n                .style('fill', '#bbb')\r\n                .call(this.drag)\r\n                .attr('id', 'bar0');\r\n            this.bar1 = null;\r\n        }\r\n\r\n        this.circleMin = this.g.append(\"circle\")\r\n            .attr(\"id\", \"sliderKnobMin\")\r\n            .attr(\"r\", this.RADIUS_HANDLE)\r\n            .attr(\"cx\", this.LEFT)\r\n            .attr(\"cy\", this.TOP + this.BAR_WIDTH)\r\n            .attr(\"fill\", \"#777\")\r\n            .attr('onchange','trace.event(\\'vis_27\\',document.location.pathname,\\'Time Sliden Min\\',\\'cx\\' + this.getAttribute(\\'cx\\'))')\r\n            .attr('onmouseup','trace.event(\\'vis_27\\',document.location.pathname,\\'Time Sliden Min\\',\\'cx\\' + this.getAttribute(\\'cx\\'))')\r\n            .call(this.drag);\r\n\r\n        this.circleMax = this.g.append(\"circle\")\r\n            .attr(\"id\", \"sliderKnobMax\")\r\n            .attr(\"r\", this.RADIUS_HANDLE)\r\n            .attr(\"cx\", this.width - this.RIGHT)\r\n            .attr(\"cy\", this.TOP + this.BAR_WIDTH)\r\n            .attr(\"fill\", \"#777\")\r\n            .attr('onchange','trace.event(\\'vis_28\\',document.location.pathname,\\'Time Sliden Max\\',\\'cx\\' + this.getAttribute(\\'cx\\'))')\r\n            .attr('onmouseup','trace.event(\\'vis_28\\',document.location.pathname,\\'Time Sliden Max\\',\\'cx\\' + this.getAttribute(\\'cx\\'))')\r\n            .call(this.drag);\r\n    }\r\n\r\n    dragStartXMouse: number = 0; // BEFORE number;\r\n    dragStartXBar: number = 0; // BEFORE number;\r\n    dragObj: any;\r\n    currentBarLength: number = 0; // BEFORE number;\r\n\r\n    dragStart() {\r\n        this.dragStartXMouse = Math.max(this.LEFT, Math.min(this.width - this.RIGHT, this.getRelX()));\r\n        var sourceEvent = (d3.event).sourceEvent; //(d3.event as D3.BaseEvent)\r\n        this.dragObj = sourceEvent ? sourceEvent.target : undefined;\r\n        if (this.isInverted) {\r\n            // determine whether we are left of min, in between, or right of max\r\n            // the startxbar is the left end of whichever segment we are in, \r\n            // and the barlength is same\r\n            var minPos: number = parseInt(this.circleMin.attr('cx'));\r\n            var maxPos: number = parseInt(this.circleMax.attr('cx'));\r\n            if (this.dragStartXMouse < minPos) {\r\n                this.dragStartXBar = this.LEFT;\r\n                this.currentBarLength = minPos - this.LEFT;\r\n            } else if (this.dragStartXMouse < maxPos) {\r\n                this.dragStartXBar = minPos;\r\n                this.currentBarLength = maxPos - minPos;\r\n            } else {\r\n                this.dragStartXBar = maxPos;\r\n                this.currentBarLength = this.width - this.RIGHT - maxPos;\r\n            }\r\n        } else {\r\n            this.dragStartXBar = parseInt(this.bar0.attr('x'));\r\n            this.currentBarLength = parseInt(this.bar0.attr('width'));\r\n        }\r\n    }\r\n\r\n    dragMove() {\r\n        // if we are dragging the entire bar\r\n        if (!this.isInverted && this.dragObj.id == this.bar0.attr('id')) {\r\n            var xOffset = Math.max(this.LEFT, Math.min(this.width - this.RIGHT, this.getRelX())) - this.dragStartXMouse;\r\n            var x1 = Math.max(this.LEFT, Math.min(this.width - this.RIGHT - this.currentBarLength, this.dragStartXBar + xOffset))\r\n            this.bar0.attr('x', x1)\r\n            this.circleMin.attr(\"cx\", x1)\r\n            this.circleMax.attr(\"cx\", x1 + this.currentBarLength);\r\n            // or else we are dragging one of the circles.\r\n        } else if (this.isInverted\r\n            && (this.dragObj.id == this.bar0.attr('id')\r\n                || this.dragObj.id == this.bar1.attr('id'))) {\r\n            // when inverted, dragging bars does nothing\r\n            return;\r\n        } else {\r\n            d3.select(this.dragObj).attr(\"cx\", Math.max(this.LEFT, Math.min(this.width - this.RIGHT, this.getRelX())));\r\n            if (this.isInverted) {\r\n                this.bar0\r\n                    .attr('x', this.LEFT)\r\n                    .attr('width', this.circleMin.attr('cx') - this.LEFT);\r\n                this.bar1\r\n                    .attr('x', this.circleMax.attr('cx'))\r\n                    .attr('width', this.width - (this.RIGHT * 2) - this.circleMax.attr('cx'));\r\n            } else {\r\n                this.bar0.attr('x', this.circleMin.attr('cx'))\r\n                    .attr('width', this.circleMax.attr('cx') - this.circleMin.attr('cx'));\r\n            }\r\n        }\r\n        this.dragEnd();\r\n    }\r\n\r\n\r\n    dragEnd() {\r\n        this.min = this.valueRange(this.circleMin.attr(\"cx\"));\r\n        this.max = this.valueRange(this.circleMax.attr(\"cx\"));\r\n        this.dragEndCallBackFn(this.min, this.max);\r\n    }\r\n\r\n\r\n    getRelX(): number {\r\n        var sourceEvent = (d3.event).sourceEvent; //(d3.event as D3.BaseEvent)\r\n        var pageX = sourceEvent ? (sourceEvent).pageX : 0;\r\n        return pageX - this.LEFT - this.x - this.rect.left;\r\n    }\r\n\r\n\r\n\r\n    set(min: number, max: number) {\r\n        // seems like this would make sense, \r\n        // this.min = min;\r\n        // this.max = max;\r\n        this.circleMin.attr(\"cx\", this.valueRange.invert(min));\r\n        this.circleMax.attr(\"cx\", this.valueRange.invert(max));\r\n        // inverted support\r\n        if (this.isInverted) {\r\n            this.bar0\r\n                .attr('x', this.LEFT)\r\n                .attr('width', this.circleMin.attr('cx'));\r\n            this.bar1\r\n                .attr('x', this.circleMax.attr('cx'))\r\n                .attr('width', this.width - (this.RIGHT * 2) - this.circleMax.attr('cx'));\r\n        } else {\r\n            this.bar0\r\n                .attr('x', this.circleMin.attr('cx'))\r\n                .attr('width', this.circleMax.attr('cx') - this.circleMin.attr('cx'));\r\n        }\r\n    }\r\n\r\n    setIsInverted(inv: boolean): void {\r\n        if (inv == this.isInverted)\r\n            return;\r\n\r\n        this.isInverted = inv;\r\n\r\n        if (this.isInverted) {\r\n            // create bar1, set positions of both\r\n            this.bar1 = this.g.insert('rect', '#bar0')\r\n                .attr('x', this.RIGHT)\r\n                .attr('y', this.TOP)\r\n                .attr('height', this.BAR_WIDTH)\r\n                .attr('width', 0)\r\n                .style('fill', '#bbb')\r\n                .call(this.drag)\r\n                .attr('id', 'bar1');\r\n        } else {\r\n            this.bar1.remove();\r\n        }\r\n        this.set(this.min, this.max);\r\n    }\r\n}\r\n","/// <reference path=\"./lib/d3.d.ts\"/>\r\n\r\nexport class Slider {\r\n\r\n    /* VISUALIZATION PARAMETERS */\r\n    BAR_WIDTH: number = 5;\r\n    RADIUS_HANDLE: number = 5;\r\n\r\n    LEFT: number = this.RADIUS_HANDLE;\r\n    RIGHT: number = this.RADIUS_HANDLE;\r\n    HEIGHT: number = 10;\r\n    TOP: number = 0;\r\n\r\n    max: number;\r\n    min: number;\r\n    value: number;\r\n    stepWidth: number;\r\n\r\n    svg: any; // BEFORE d3.Selection<d3.BaseType, {}, HTMLElement, any>; // ?????????????\r\n    x: number;\r\n    y: number;\r\n    width: number;\r\n    g: any; // BEFORE d3.Selection<SVGElement, {}, HTMLElement, any>; // ?????????????\r\n\r\n    dragEndCallBackFn: any; // BEFORE Function\r\n\r\n    constructor(x: number, y: number, width: number, minValue: number, maxValue: number, stepWidth: number) {\r\n        this.x = x;\r\n        this.y = y;\r\n        this.width = width;\r\n        this.min = minValue;\r\n        this.max = maxValue;\r\n        this.value = this.min;\r\n        this.stepWidth = stepWidth;\r\n    }\r\n\r\n    setDragEndCallBack(fn: Function) {\r\n        this.dragEndCallBackFn = fn;\r\n    }\r\n\r\n\r\n    valueRange: any; // BEFORE d3.ScaleLinear<number, number> ;\r\n    drag: any; // BEFORE d3.DragBehavior<Element, {}, {} | d3.SubjectPosition>;\r\n    bar: any;\r\n    knob: any;\r\n    rect: any;\r\n    appendTo(svg: D3.Selection) {\r\n\r\n        this.svg = svg;\r\n\r\n        // this.rect = (this.svg as any)['_groups'][0][0].getBoundingClientRect(); // D3 V4\r\n        this.rect = (this.svg as any)[0][0].getBoundingClientRect();\r\n\r\n\r\n        this.valueRange = d3.scale.linear()\r\n            .domain([0, this.width])\r\n            .range([this.min, this.max])\r\n\r\n\r\n        this.drag = d3.behavior.drag()\r\n            .origin(Object)\r\n            .on(\"dragstart\", () => { this.dragStart() }) // d3 v4 is only \"start\"\r\n            .on(\"drag\", () => { this.dragMove() })\r\n\r\n        this.svg = svg;\r\n\r\n        this.g = svg.append(\"g\")\r\n            .attr(\"height\", this.HEIGHT)\r\n            .attr(\"width\", this.width)\r\n            .attr(\"transform\", \"translate(\" + this.x + \",\" + this.y + \")\")\r\n\r\n        this.g.append(\"line\")\r\n            .attr(\"x1\", this.LEFT)\r\n            .attr(\"y1\", this.TOP)\r\n            .attr(\"x2\", this.width - this.RIGHT - this.LEFT)\r\n            .attr(\"y2\", this.TOP)\r\n            .style(\"stroke\", \"#aaa\")\r\n\r\n        this.knob = this.g.append(\"circle\")\r\n            .attr(\"id\", \"#sliderKnob\")\r\n            .attr(\"r\", this.RADIUS_HANDLE)\r\n            .attr(\"cx\", this.LEFT)\r\n            .attr(\"cy\", this.TOP)\r\n            .attr(\"fill\", \"#777\")\r\n            .attr('onchange','trace.event(\\'vis_4\\',document.location.pathname,this.parentElement.previousElementSibling.innerHTML ,\\'cx\\' + this.getAttribute(\\'cx\\'))')\r\n            .attr('onmouseup','trace.event(\\'vis_4\\',document.location.pathname,this.parentElement.previousElementSibling.innerHTML ,\\'cx\\' + this.getAttribute(\\'cx\\'))')\r\n            .call(this.drag);\r\n            \r\n    }\r\n\r\n    dragStartXMouse: any;\r\n    dragStartXBar: any;\r\n    dragObj: any;\r\n    currentBarLength: any;\r\n    dragStart() {\r\n        this.dragStartXMouse = Math.max(this.LEFT, Math.min(this.width - this.RIGHT, this.getRelX()))\r\n        var sourceEvent = d3.event.sourceEvent; // (d3.event as d3.BaseEvent)\r\n        this.dragObj = sourceEvent ? sourceEvent.target : undefined;\r\n    }\r\n\r\n    dragMove() {\r\n        d3.select(this.dragObj).attr(\"cx\", Math.max(this.LEFT, Math.min(this.width - this.RIGHT, this.getRelX())));\r\n        this.dragEnd()\r\n    }\r\n\r\n\r\n    dragEnd() {\r\n        this.value = this.valueRange(this.knob.attr(\"cx\"));\r\n        this.dragEndCallBackFn(this.value);\r\n    }\r\n\r\n\r\n    getRelX(): number {\r\n        var sourceEvent = d3.event.sourceEvent;\r\n        var pageX = sourceEvent ? (sourceEvent).pageX : 0; // <MouseEvent>\r\n        return pageX - this.LEFT - this.x - this.rect.left;\r\n    }\r\n\r\n\r\n\r\n    set(value: number) {\r\n        this.knob.attr(\"cx\", this.valueRange.invert(value));\r\n    }\r\n\r\n\r\n}\r\n","/// <reference path=\"./lib/d3.d.ts\"/>\r\n\r\nexport class SmartSlider {\r\n\r\n    /* VISUALIZATION PARAMETERS */\r\n    BAR_WIDTH: number = 15;\r\n    RADIUS_HANDLE: number = 5;\r\n\r\n    // LEFT: number = this.RADIUS_HANDLE;\r\n    // RIGHT: number = this.RADIUS_HANDLE;\r\n    LEFT: number = 0;\r\n    RIGHT: number = 0;\r\n    HEIGHT: number = 10;\r\n    TOP: number = 0;\r\n\r\n    max: number;\r\n    min: number;\r\n    stepWidth: number;\r\n    hasTickmarks: boolean;\r\n    isInverted: boolean = false;\r\n\r\n    svg: any; // BEFORE d3.Selection<d3.BaseType, {}, HTMLElement, any>;\r\n    x: number;\r\n    y: number;\r\n    width: number;\r\n    g: any; // BEFORE d3.Selection<d3.BaseType, {}, HTMLElement, any>;\r\n\r\n    dragEndCallBackFn: any; // BEFORE Function;\r\n\r\n    constructor(\r\n        x: number,\r\n        y: number,\r\n        width: number,\r\n        minValue: number,\r\n        maxValue: number,\r\n        stepWidth: number,\r\n        tickMarks?: boolean) {\r\n        this.x = x;\r\n        this.y = y;\r\n        this.width = width;\r\n        this.min = minValue;\r\n        this.max = maxValue;\r\n        this.stepWidth = stepWidth;\r\n\r\n        if (tickMarks != undefined)\r\n            this.hasTickmarks = tickMarks;\r\n        else\r\n            this.hasTickmarks = false;\r\n    }\r\n\r\n    setDragEndCallBack(fn: Function) {\r\n        this.dragEndCallBackFn = fn;\r\n    }\r\n\r\n\r\n    valueRange: any; // BEFORE d3.ScaleLinear<number, number>;\r\n    val2spaceScale: any; // BEFORE d3.ScaleLinear<number, number>;\r\n\r\n    drag: any; // BEFORE d3.DragBehavior<Element, {}, {} | d3.SubjectPosition>;\r\n    bar0: any; // BEFORE d3.Selection<d3.BaseType, {}, HTMLElement, any>;\r\n    bar1: any; // BEFORE d3.Selection<d3.BaseType, {}, HTMLElement, any>;\r\n    circleMin: any;\r\n    circleMax: any;\r\n    circleSingle: any;\r\n    rect: any;\r\n    singleTimeStepX = 0;\r\n\r\n    appendTo(svg: D3.Selection) {\r\n\r\n        this.svg = svg;\r\n\r\n        //this.rect = this.svg['_groups'][0][0].getBoundingClientRect(); // D3 V4\r\n        this.rect = this.svg[0][0].getBoundingClientRect();\r\n\r\n        this.valueRange = d3.scale.linear()\r\n            .domain([0, this.width])\r\n            .range([this.min, this.max])\r\n\r\n        this.svg = svg;\r\n\r\n        this.g = svg.append(\"g\")\r\n            .attr(\"height\", this.HEIGHT)\r\n            .attr(\"width\", this.width)\r\n            .attr(\"transform\", \"translate(\" + this.x + \",\" + this.y + \")\");\r\n\r\n        this.drag = d3.behavior.drag()\r\n            .origin(Object)\r\n            .on(\"dragstart\", () => { this.dragStart() }) // d3 v4 is only \"start\"\r\n            .on(\"drag\", () => { this.dragMove() })\r\n\r\n        this.g.append(\"line\")\r\n            .attr(\"x1\", this.LEFT)\r\n            .attr(\"y1\", this.TOP)\r\n            .attr(\"x2\", this.width - this.RIGHT - this.LEFT)\r\n            .attr(\"y2\", this.TOP)\r\n            .style(\"stroke\", \"#aaa\");\r\n\r\n        if (this.hasTickmarks) {\r\n            this.val2spaceScale = d3.scale.linear()\r\n                .domain([this.min, this.max])\r\n                .range([this.LEFT, this.width - this.RIGHT - this.LEFT]);\r\n\r\n            for (var i = this.min; i <= this.max; i += this.stepWidth) {\r\n                var x = this.val2spaceScale(i);\r\n                this.g.append(\"line\")\r\n                    .attr('class', 'rangeTick')\r\n                    .attr(\"x1\", x)\r\n                    .attr(\"y1\", this.TOP)\r\n                    .attr(\"x2\", x)\r\n                    .attr(\"y2\", this.TOP + 20)\r\n                    .style('stroke', '#bbb');\r\n\r\n                this.g.append('text')\r\n                    .attr('class', 'rangeTickText')\r\n                    .attr('x', x)\r\n                    .attr('y', this.TOP + 20)\r\n                    .text(i.toFixed(1))\r\n                    .style('opacity', .5)\r\n                    .style('font-family', 'Helvetica')\r\n                    .style('font-weigth', '100')\r\n                    .style('font-size', '7pt');\r\n            }\r\n        }\r\n\r\n        if (this.isInverted) {\r\n            this.bar0 = this.g.append('rect')\r\n                .attr('x', this.LEFT)\r\n                .attr('y', this.TOP)\r\n                .attr('height', this.BAR_WIDTH)\r\n                .attr('width', 0)\r\n                .style('fill', '#bbb')\r\n                .call(this.drag)\r\n                .attr('id', 'bar0')\r\n                .attr('onmouseup','trace.event(\\'vis_43\\',document.location.pathname,\\'Time Slider\\',\\'x\\' + this.getAttribute(\\'x\\') + \\'width\\' + this.getAttribute(\\'width\\'))')\r\n                .attr('oninput','trace.event(\\'vis_43\\',document.location.pathname,\\'Time Slider\\',\\'x\\' + this.getAttribute(\\'x\\') + \\'width\\' + this.getAttribute(\\'width\\'))');\r\n    \r\n            this.bar1 = this.g.append('rect')\r\n                .attr('x', this.RIGHT)\r\n                .attr('y', this.TOP)\r\n                .attr('height', this.BAR_WIDTH)\r\n                .attr('width', 0)\r\n                .style('fill', '#bbb')\r\n                .call(this.drag)\r\n                .attr('id', 'bar1')\r\n                .attr('onmouseup','trace.event(\\'vis_43\\',document.location.pathname,\\'Time Slider\\',\\'x\\' + this.getAttribute(\\'x\\') + \\'width\\' + this.getAttribute(\\'width\\'))')\r\n                .attr('oninput','trace.event(\\'vis_43\\',document.location.pathname,\\'Time Slider\\',\\'x\\' + this.getAttribute(\\'x\\') + \\'width\\' + this.getAttribute(\\'width\\'))');\r\n\r\n        } else {\r\n            this.bar0 = this.g.append('rect')\r\n                .attr('x', this.LEFT)\r\n                .attr('y', this.TOP)\r\n                .attr('height', this.BAR_WIDTH)\r\n                .attr('width', this.width - this.RIGHT - this.LEFT)\r\n                .style('fill', '#bbb')\r\n                .call(this.drag)\r\n                .attr('id', 'bar0')\r\n                .attr('onmouseup','trace.event(\\'vis_43\\',document.location.pathname,\\'Time Slider\\',\\'x\\' + this.getAttribute(\\'x\\') + \\'width\\' + this.getAttribute(\\'width\\'))')\r\n                .attr('oninput','trace.event(\\'vis_43\\',document.location.pathname,\\'Time Slider\\',\\'x\\' + this.getAttribute(\\'x\\') + \\'width\\' + this.getAttribute(\\'width\\'))');\r\n\r\n            this.bar1 = null;\r\n        }\r\n\r\n        this.circleMin = this.g.append(\"circle\")\r\n            .attr(\"id\", \"sliderKnobMin\")\r\n            .attr(\"r\", this.RADIUS_HANDLE)\r\n            .attr(\"cx\", this.LEFT)\r\n            .attr(\"cy\", this.TOP + this.BAR_WIDTH)\r\n            .attr(\"fill\", \"#777\")\r\n            .attr('onchange','trace.event(\\'vis_27\\',document.location.pathname,\\'Time Sliden Min\\',\\'cx\\' + this.getAttribute(\\'cx\\'))')\r\n            .attr('onmouseup','trace.event(\\'vis_27\\',document.location.pathname,\\'Time Sliden Min\\',\\'cx\\' + this.getAttribute(\\'cx\\'))')\r\n            .attr('oninput','trace.event(\\'vis_27\\',document.location.pathname,\\'Time Sliden Min\\',\\'cx\\' + this.getAttribute(\\'cx\\'))')\r\n            .call(this.drag);\r\n\r\n        this.circleMax = this.g.append(\"circle\")\r\n            .attr(\"id\", \"sliderKnobMax\")\r\n            .attr(\"r\", this.RADIUS_HANDLE)\r\n            .attr(\"cx\", this.width - this.RIGHT)\r\n            .attr(\"cy\", this.TOP + this.BAR_WIDTH)\r\n            .attr(\"fill\", \"#777\")\r\n            .attr('onchange','trace.event(\\'vis_28\\',document.location.pathname,\\'Time Sliden Max\\',\\'cx\\' + this.getAttribute(\\'cx\\'))')\r\n            .attr('onmouseup','trace.event(\\'vis_28\\',document.location.pathname,\\'Time Sliden Max\\',\\'cx\\' + this.getAttribute(\\'cx\\'))')\r\n            .attr('oninput','trace.event(\\'vis_28\\',document.location.pathname,\\'Time Sliden Max\\',\\'cx\\' + this.getAttribute(\\'cx\\'))')\r\n            .call(this.drag);\r\n\r\n        // this.circleSingle = this.g\r\n        //     .append('svg:path')\r\n        //     .attr('d', 'M0,0L4,4L4,15L-4,15L-4,4L0,0')\r\n        //     .attr('fill', '#777')\r\n        //     .attr(\"id\", \"sliderKnobSingle\")\r\n        //     .call(this.drag);\r\n\r\n    }\r\n\r\n    dragStartXMouse: number = 0; // BEFORE number;\r\n    dragStartXBar: number = 0; // BEFORE number;\r\n    dragObj: any;\r\n    currentBarLength: number = 0; // BEFORE number;\r\n\r\n    dragStart() {\r\n        this.dragStartXMouse = Math.max(this.LEFT, Math.min(this.width - this.RIGHT, this.getRelX()));\r\n        var sourceEvent = (d3.event).sourceEvent; // d3.BaseEvent\r\n        this.dragObj = sourceEvent ? sourceEvent.target : undefined;\r\n        if (this.isInverted) {\r\n            // determine whether we are left of min, in between, or right of max\r\n            // the startxbar is the left end of whichever segment we are in, \r\n            // and the barlength is same\r\n            var minPos: number = parseInt(this.circleMin.attr('cx'));\r\n            var maxPos: number = parseInt(this.circleMax.attr('cx'));\r\n            if (this.dragStartXMouse < minPos) {\r\n                this.dragStartXBar = this.LEFT;\r\n                this.currentBarLength = minPos - this.LEFT;\r\n            } else if (this.dragStartXMouse < maxPos) {\r\n                this.dragStartXBar = minPos;\r\n                this.currentBarLength = maxPos - minPos;\r\n            } else {\r\n                this.dragStartXBar = maxPos;\r\n                this.currentBarLength = this.width - this.RIGHT - maxPos;\r\n            }\r\n        } else {\r\n            this.dragStartXBar = parseInt(this.bar0.attr('x'));\r\n            this.currentBarLength = parseInt(this.bar0.attr('width'));\r\n        }\r\n    }\r\n\r\n    dragMove() {\r\n        // if we are dragging the entire bar\r\n        if (!this.isInverted && this.dragObj.id == this.bar0.attr('id')) {\r\n            var xOffset = Math.max(this.LEFT, Math.min(this.width - this.RIGHT, this.getRelX())) - this.dragStartXMouse;\r\n            var x1 = Math.max(this.LEFT, Math.min(this.width - this.RIGHT - this.currentBarLength, this.dragStartXBar + xOffset))\r\n            this.bar0.attr('x', x1)\r\n            this.circleMin.attr(\"cx\", x1)\r\n            this.circleMax.attr(\"cx\", x1 + this.currentBarLength);\r\n            // or else we are dragging one of the circles.\r\n        } else if (this.isInverted\r\n            && (this.dragObj.id == this.bar0.attr('id')\r\n                || this.dragObj.id == this.bar1.attr('id'))) {\r\n            // when inverted, dragging bars does nothing\r\n            return;\r\n        } else if (this.dragObj == this.circleSingle) {\r\n            // move the one time steper\r\n            this.singleTimeStepX = Math.max(this.LEFT, Math.min(this.width - this.RIGHT, this.getRelX()))\r\n            d3.select(this.dragObj).attr(\"transform\", 'translate(' + this.singleTimeStepX + ', 0)');\r\n        } else {\r\n            d3.select(this.dragObj).attr(\"cx\", Math.max(this.LEFT, Math.min(this.width - this.RIGHT, this.getRelX())));\r\n            if (this.isInverted) {\r\n                this.bar0\r\n                    .attr('x', this.LEFT)\r\n                    .attr('width', this.circleMin.attr('cx') - this.LEFT);\r\n                this.bar1\r\n                    .attr('x', this.circleMax.attr('cx'))\r\n                    .attr('width', this.width - (this.RIGHT * 2) - this.circleMax.attr('cx'));\r\n            } else {\r\n                this.bar0.attr('x', this.circleMin.attr('cx'))\r\n                    .attr('width', this.circleMax.attr('cx') - this.circleMin.attr('cx'));\r\n            }\r\n        }\r\n        this.dragEnd();\r\n    }\r\n\r\n\r\n    dragEnd() {\r\n        this.min = this.valueRange(this.circleMin.attr(\"cx\"));\r\n        this.max = this.valueRange(this.circleMax.attr(\"cx\"));\r\n        this.dragEndCallBackFn(this.min, this.max, this.valueRange(this.singleTimeStepX));\r\n    }\r\n\r\n\r\n    getRelX(): number {\r\n        var sourceEvent = (d3.event).sourceEvent;\r\n        var pageX = sourceEvent ? (sourceEvent).pageX : 0;\r\n        return pageX - this.LEFT - this.x - this.rect.left;\r\n    }\r\n\r\n\r\n\r\n    set(min: number, max: number) {\r\n        // seems like this would make sense, \r\n        // this.min = min;\r\n        // this.max = max;\r\n        this.circleMin.attr(\"cx\", this.valueRange.invert(min));\r\n        this.circleMax.attr(\"cx\", this.valueRange.invert(max));\r\n        // inverted support\r\n        if (this.isInverted) {\r\n            this.bar0\r\n                .attr('x', this.LEFT)\r\n                .attr('width', this.circleMin.attr('cx'));\r\n            this.bar1\r\n                .attr('x', this.circleMax.attr('cx'))\r\n                .attr('width', this.width - (this.RIGHT * 2) - this.circleMax.attr('cx'));\r\n        } else {\r\n            this.bar0\r\n                .attr('x', this.circleMin.attr('cx'))\r\n                .attr('width', this.circleMax.attr('cx') - this.circleMin.attr('cx'));\r\n        }\r\n    }\r\n\r\n    setIsInverted(inv: boolean): void {\r\n        if (inv == this.isInverted)\r\n            return;\r\n\r\n        this.isInverted = inv;\r\n\r\n        if (this.isInverted) {\r\n            // create bar1, set positions of both\r\n            this.bar1 = this.g.insert('rect', '#bar0')\r\n                .attr('x', this.RIGHT)\r\n                .attr('y', this.TOP)\r\n                .attr('height', this.BAR_WIDTH)\r\n                .attr('width', 0)\r\n                .style('fill', '#bbb')\r\n                .call(this.drag)\r\n                .attr('id', 'bar1');\r\n        } else {\r\n            this.bar1.remove();\r\n        }\r\n        this.set(this.min, this.max);\r\n    }\r\n}\r\n","/// <reference path=\"./lib/d3.d.ts\"/>\r\n\r\nimport * as dynamicgraph from \"./dynamicgraph\";\r\nimport * as moment from \"moment\";\r\nimport * as utils from \"./utils\";\r\n\r\nimport {\r\n    WebGL,\r\n    WebGLElementQuery\r\n} from './glutils';\r\n\r\nexport class Timeline {\r\n\r\n    TICK_MIN_DIST = 13;\r\n    LABEL_MIN_DIST = 13;\r\n\r\n    WIDTH: number;\r\n    HEIGHT: number;\r\n    webgl: WebGL;\r\n    network: dynamicgraph.DynamicGraph;\r\n    x: number;\r\n    y: number;\r\n\r\n    position_x: any;\r\n    position_y: any;\r\n    label_opacity: any;\r\n\r\n    minTimeId: any;\r\n    maxTimeId: any;\r\n\r\n    timeObjects: moment.Moment[] = []; // INIT\r\n    highlightPointer: any;\r\n    highlightLabel: any;\r\n\r\n    minGran: number; // INIT\r\n    maxGran: number; // INIT\r\n\r\n    granules: moment.unitOfTime.Base[];\r\n\r\n    tickmarks: WebGLElementQuery = new WebGLElementQuery(); // INIT\r\n    timeLabels: WebGLElementQuery = new WebGLElementQuery(); // INIT\r\n\r\n    tick_minGran_visible: any;\r\n    tick_minGran_visible_prev: any = -1; // INIT\r\n\r\n    label_minGran_visible: any;\r\n\r\n    constructor(webgl: WebGL,\r\n        network: dynamicgraph.DynamicGraph,\r\n        x: number, y: number,\r\n        width: number, height: number) {\r\n        this.x = x;\r\n        this.y = y;\r\n        this.WIDTH = width;\r\n        this.HEIGHT = height;\r\n        this.webgl = webgl;\r\n        this.network = network;\r\n        this.granules = dynamicgraph.GRANULARITY;\r\n        this.minGran = this.network.getMinGranularity();\r\n        this.maxGran = this.granules.length - 1;\r\n        this.visualize();\r\n    }\r\n\r\n    timeGranularities: any;\r\n    visualize() {\r\n\r\n        /* MOVE TO CONSTRUCTOR */\r\n        var times = this.network.times().toArray();\r\n\r\n        // create non-indexed times\r\n        var unix_start = times[0] ? times[0].unixTime() : 0;\r\n        var unix_end = times[times.length - 1] ? times[times.length - 1].unixTime() : 0;\r\n\r\n        var start = moment.utc(unix_start + '', 'x').startOf(this.granules[this.minGran]);\r\n        var end = moment.utc(unix_end + '', 'x').startOf(this.granules[this.minGran]);\r\n        var numTimes = Math.ceil(Math.abs(start.diff(end, this.granules[this.minGran]))); // WITHOUT 's'\r\n        this.maxGran = Math.min(this.maxGran, this.granules.length - 1);\r\n        var granularity_levels = ((this.maxGran - this.minGran) + 1);\r\n        var granularity_height = this.HEIGHT / granularity_levels;\r\n\r\n        // create all timeObjects (UTC)\r\n        var prev = moment.utc(unix_start + '', 'x');\r\n        var prevprev = moment.utc((unix_start - 86400000) + '', 'x'); // substract one day\r\n        // bb: check why 'substract' is not working:\r\n        // prevprev.substract(1, this.granules[this.minGran] + 's');\r\n        this.timeObjects.push(prev);\r\n        for (var i = 1; i < numTimes; i++) {\r\n            prev = moment.utc(prev) // ???\r\n            prev.add(1, this.granules[this.minGran]) // WITHOUT 's'\r\n            this.timeObjects.push(prev)\r\n        }\r\n\r\n\r\n        this.timeGranularities = []\r\n        // set granularity for first time step: \r\n\r\n        var granularitySet: boolean\r\n        var y1: any, y2: any;\r\n        var to1: any, to2: any;\r\n        for (var i = 0; i < this.timeObjects.length; i++) {\r\n            granularitySet = false\r\n            if (i == 0)\r\n                to1 = prevprev;\r\n            else\r\n                to1 = this.timeObjects[i - 1]\r\n            to2 = this.timeObjects[i];\r\n            for (var gran = this.maxGran; gran >= this.minGran && !granularitySet; gran--) {\r\n                if (gran > 7) {\r\n                    y1 = to1.get(this.granules[7]) + '';\r\n                    y2 = to2.get(this.granules[7]) + '';\r\n\r\n                    // test for millenia\r\n                    if (y1[y1.length - 4] != y2[y2.length - 4]) {\r\n                        this.timeGranularities.push(10);\r\n                        granularitySet = true;\r\n                    }\r\n                    // test for centuries\r\n                    else if (y1[y1.length - 3] != y2[y2.length - 3]) {\r\n                        this.timeGranularities.push(9);\r\n                        granularitySet = true;\r\n                    }\r\n                    // test for decades\r\n                    else if (y1[y1.length - 2] != y2[y2.length - 2]) {\r\n                        this.timeGranularities.push(8);\r\n                        granularitySet = true;\r\n                    }\r\n                } else\r\n                    if (to1.get(this.granules[gran]) != to2.get(this.granules[gran])) {\r\n                        this.timeGranularities.push(gran);\r\n                        granularitySet = true;\r\n                    }\r\n            }\r\n        }\r\n\r\n        // create mapping functions\r\n        this.position_x = d3.scale.linear()\r\n            .domain([0, this.timeGranularities.length - 1])\r\n            .range([this.x + 1, this.x + this.WIDTH - 1]);\r\n        this.position_y = d3.scale.linear()\r\n            .domain([this.minGran - 1, this.maxGran])\r\n            .range([-this.HEIGHT, 0]);\r\n        this.label_opacity = d3.scale.linear()\r\n            .domain([this.minGran - 1, this.maxGran])\r\n            .range([.2, 1]);\r\n\r\n        // Draw tickmarks\r\n        this.tickmarks = this.webgl.selectAll()\r\n            .data(this.timeGranularities)\r\n            .append('line')\r\n            .attr('x1', (d: any, i: any) => this.position_x(i))\r\n            .attr('x2', (d: any, i: any) => this.position_x(i))\r\n            .attr('y1', (d: any, i: any) => this.position_y(d))\r\n            .attr('y2', (d: any, i: any) => -this.HEIGHT)\r\n            .style('stroke', '#000')\r\n            .style('opacity', .1)\r\n\r\n\r\n        // create highlight pointer\r\n        this.highlightPointer = this.webgl.selectAll()\r\n            .data([0])\r\n            .append('line')\r\n            .attr('x1', 0)\r\n            .attr('x2', 0)\r\n            .attr('y1', 0)\r\n            .attr('y2', -this.HEIGHT)\r\n            .style('stroke', '#f00')\r\n            .style('opacity', 0)\r\n        this.highlightLabel = this.webgl.selectAll()\r\n            .data([0])\r\n            .append('text')\r\n            .attr('x', 0)\r\n            .attr('y', -6)\r\n            .style('fill', '#f00')\r\n            .style('font-size', 10)\r\n            .style('opacity', 0)\r\n\r\n\r\n\r\n        this.updateWithIds(0, this.timeObjects.length - 1)\r\n\r\n\r\n\r\n    }\r\n\r\n    update(startUnix: any, endUnix: any) {\r\n        // search for start:\r\n        var startId: any, endId: any;\r\n        for (var i = 0; i < this.timeObjects.length; i++) {\r\n            if ((this.timeObjects[i].unix() * 1000) > startUnix) {\r\n                startId = i - 1;\r\n                break;\r\n            }\r\n        }\r\n        for (i = startId; i < this.timeObjects.length; i++) {\r\n            if ((this.timeObjects[i].unix() * 1000) > endUnix) {\r\n                endId = i;\r\n                break;\r\n            }\r\n        }\r\n        if (endId == undefined) {\r\n            endId = this.timeObjects.length - 1\r\n        }\r\n        this.updateWithIds(startId, endId)\r\n    }\r\n\r\n    updateWithIds(minTimeId: any, maxTimeId: any) {\r\n\r\n        this.minTimeId = minTimeId;\r\n        this.maxTimeId = maxTimeId;\r\n        // set range function domain\r\n        this.position_x.domain([minTimeId, maxTimeId]);\r\n\r\n        var ticksFitting = Math.floor(this.WIDTH / this.TICK_MIN_DIST);\r\n        var minTime = this.timeObjects[this.minTimeId];\r\n        var maxTime = this.timeObjects[this.maxTimeId];\r\n        var requiredTicks: number = Number.MAX_VALUE; // INIT?\r\n        var t1: any, t2: any;\r\n        this.tick_minGran_visible = undefined;\r\n        for (var g = this.minGran; g < this.maxGran && this.tick_minGran_visible == undefined; g++) {\r\n            // calculate how many times of this granularity can fit.\r\n            t1 = moment.utc(minTime).startOf(this.granules[g])\r\n            t2 = moment.utc(maxTime).startOf(this.granules[g])\r\n            if (g <= 7) {\r\n                requiredTicks = moment.duration(t2.diff(t1)).as(this.granules[g])\r\n            } else {\r\n                if (g == 8)\r\n                    requiredTicks = moment.duration(t2.diff(t1)).as(this.granules[7]) / 10\r\n                if (g == 9)\r\n                    requiredTicks = moment.duration(t2.diff(t1)).as(this.granules[7]) / 100\r\n                if (g == 10)\r\n                    requiredTicks = moment.duration(t2.diff(t1)).as(this.granules[7]) / 1000\r\n            }\r\n\r\n            if (requiredTicks <= ticksFitting) {\r\n                this.tick_minGran_visible = g;\r\n            }\r\n        }\r\n\r\n        this.label_minGran_visible = this.tick_minGran_visible\r\n\r\n        this.label_opacity\r\n            .domain([this.tick_minGran_visible - 1, this.maxGran])\r\n\r\n        if (this.tick_minGran_visible_prev != this.tick_minGran_visible) {\r\n\r\n\r\n            console.log('re-create time labels')\r\n            // re-create labels\r\n            if (this.timeLabels != undefined)\r\n                this.timeLabels.removeAll();\r\n\r\n            this.timeLabels = this.webgl.selectAll()\r\n                .data(this.timeObjects)\r\n                .filter((d: any, i: number) => {\r\n                    var visible =\r\n                        this.timeGranularities[i] >= this.tick_minGran_visible;\r\n                    return visible;\r\n                })\r\n                .append('text')\r\n                .attr('x', (d: any, i: number) => this.position_x(this.timeObjects.indexOf(d)) + 8)\r\n                .attr('y', (d: any, i: number) => -this.HEIGHT + 17)\r\n                .text((d: any, i: number) => this.formatTime(this.timeObjects.indexOf(d)))\r\n                .attr('z', 1)\r\n                .style('fill', '#000')\r\n                .attr('rotation', 90)\r\n                .style('font-size', 10)\r\n                .style('opacity', .1)\r\n\r\n            console.log('time labels created:', this.timeLabels.length)\r\n\r\n        }\r\n        this.tick_minGran_visible_prev = this.tick_minGran_visible;\r\n\r\n        this.tickmarks\r\n            .style('opacity', (d: any, i: number) => {\r\n                var visible =\r\n                    i == 0\r\n                        || i >= this.minTimeId\r\n                        && i <= this.maxTimeId\r\n                        && this.timeGranularities[i] >= this.tick_minGran_visible\r\n                        ? this.label_opacity(this.timeGranularities[i])\r\n                        : 0;\r\n                return visible;\r\n            })\r\n            .attr('x1', (d: any, i: number) => this.position_x(i))\r\n            .attr('x2', (d: any, i: number) => this.position_x(i))\r\n            .style('stroke-width', (d: any, i: number) => this.label_opacity(this.timeGranularities[i]) * 4)\r\n\r\n\r\n        // update labels\r\n        this.timeLabels\r\n            .style('opacity', (d: any, i: number) => {\r\n                var globalId = this.timeObjects.indexOf(d)\r\n                var visible =\r\n                    globalId >= this.minTimeId\r\n                    && globalId <= this.maxTimeId\r\n                    && this.timeGranularities[globalId] >= this.label_minGran_visible\r\n                return visible ? 1 : 0;\r\n            })\r\n            .attr('x', (d: any, i: number) => {\r\n                var globalId = this.timeObjects.indexOf(d)\r\n                return this.position_x(globalId) + 8;\r\n            })\r\n\r\n        // update highlightPointer\r\n        if (this.highlightId != undefined) {\r\n            this.highlightPointer\r\n                .attr('x1', this.position_x(this.highlightId))\r\n                .attr('x2', this.position_x(this.highlightId))\r\n\r\n            this.highlightLabel\r\n                .attr('x', this.position_x(this.highlightId) + 37)\r\n        }\r\n    }\r\n\r\n    formatTime(index: number): string {\r\n        var t = this.timeObjects[index];\r\n        var g = Math.min(Math.max(this.tick_minGran_visible, this.timeGranularities[index]), 7);\r\n\r\n        return utils.formatAtGranularity(t, g)\r\n    }\r\n\r\n    highlightId: any; // INIT ???\r\n    highlight(unixTime?: number) {\r\n\r\n        if (unixTime == undefined) {\r\n            this.highlightPointer\r\n                .style('opacity', 0)\r\n            this.highlightId = undefined;\r\n        }\r\n\r\n        for (var i = 0; i < this.timeObjects.length; i++) {\r\n            if (!unixTime || (this.timeObjects[i].unix() * 1000) > unixTime) { // IS CORRECT !unixTime ?? \r\n                this.highlightId = i - 1;\r\n                break;\r\n            }\r\n        }\r\n        if (this.highlightId == undefined) {\r\n            this.highlightId = this.timeObjects.length - 1\r\n        }\r\n\r\n        this.highlightPointer\r\n            .attr('x1', this.position_x(this.highlightId))\r\n            .attr('x2', this.position_x(this.highlightId))\r\n            .style('opacity', 1)\r\n\r\n        this.highlightLabel\r\n            .style('opacity', 1)\r\n            .attr('x', this.position_x(this.highlightId) + 37)\r\n            .text(this.timeObjects[this.highlightId].format('DD/MM/YYYY'))\r\n\r\n    }\r\n\r\n\r\n}\r\n","/// <reference path=\"./lib/d3.d.ts\"/>\r\n\r\nimport { Slider } from './slider'\r\n\r\nexport function makeSlider(\r\n    d3parent: any, // BEFORE d3.Selection<d3.BaseType, {}, HTMLElement, any>, \r\n    label: string,\r\n    width: number,\r\n    height: number,\r\n    value: number,\r\n    min: number,\r\n    max: number,\r\n    handler: Function): void \r\n{\r\n\r\n        var slider: Slider = new Slider(5, height - 5, width, min, max, .01);\r\n        var svg = d3parent.append('svg')\r\n            .attr('width', width + 20)\r\n            .attr('height', height);\r\n\r\n        svg.append('text')\r\n            .attr('x', 10)\r\n            .attr('y', height - 15)\r\n            .text(label)\r\n            .attr('class', 'sliderLabel');\r\n\r\n        slider.appendTo(svg);\r\n        slider.set(value);\r\n        slider.setDragEndCallBack(handler);\r\n}\r\n\r\nexport class RadioButton {\r\n\r\n    private checked: boolean = false;\r\n\r\n    circle: any; // BEFORE d3.Selection<d3.BaseType, {}, HTMLElement, any>; \r\n    label: any; // BEFORE d3.Selection<d3.BaseType, {}, HTMLElement, any>; \r\n\r\n    color: string;\r\n    text: string = '';\r\n\r\n    RADIUS: number = 7;\r\n\r\n    clickHandler: any; // BEFORE Function;\r\n\r\n    constructor(color: string, text?: string) {\r\n        this.color = color;\r\n        if (text)\r\n            this.text = text;\r\n    }\r\n\r\n\r\n\r\n    appendTo(x: number, y: number, svg: D3.Selection) { \r\n        var g = svg.append('g')\r\n            .attr('transform', 'translate(' + x + ',' + y + ')');\r\n\r\n        this.circle = g.append('circle')\r\n            .attr('r', this.RADIUS)\r\n            .attr('fill', '#ffffff')\r\n            .attr('stroke', this.color)\r\n            .attr('stroke-width', 1)\r\n            .attr('cx', this.RADIUS * 2)\r\n            .attr('cy', 0)\r\n            .attr('oninput','trace.event(\\'vis_4\\',document.location.pathname,this.parentElement.previousElementSibling.innerHTML ,\\'cx\\' + this.getAttribute(\\'cx\\'))')\r\n            .attr('onmouseup','trace.event(\\'vis_4\\',document.location.pathname,this.parentElement.previousElementSibling.innerHTML ,\\'cx\\' + this.getAttribute(\\'cx\\'))');\r\n\r\n\r\n\r\n        if (this.text) {\r\n            this.label = g.append('text')\r\n                .attr('x', this.RADIUS * 1.4)\r\n                .attr('y', 5)\r\n                .style('font-family', 'Helvetica')\r\n                .style('font-size', '9pt')\r\n                .style('user-select', 'none')\r\n                .text(this.text[0])\r\n                .on('click', () => {\r\n                    this.checked = !this.checked;\r\n                    if (this.checked) {\r\n                        this.circle.attr('fill', this.color);\r\n                        this.label.attr('fill', '#ffffff');\r\n                    } else {\r\n                        this.circle.attr('fill', '#ffffff');\r\n                        this.label.attr('fill', this.color);\r\n                    }\r\n                    if (this.clickHandler) {\r\n                        this.clickHandler();\r\n                    }\r\n                });\r\n        }\r\n    }\r\n\r\n    isChecked(): boolean {\r\n        return this.checked;\r\n    }\r\n\r\n    addClickHandler(f: Function) {\r\n        this.clickHandler = f;\r\n    }\r\n}\r\n\r\n\r\nexport function makeCheckBox(d3parent: any, label: string, callback: Function) {\r\n    d3parent.append('input')\r\n        .attr('type', 'checkbox')\r\n        .on('change', callback);\r\n    d3parent.append('b').attr('class', 'sliderLabel').html(label);\r\n}\r\n\r\nexport function makeButton(d3parent: any, label: string, callback: Function) {\r\n    d3parent.append('input')\r\n        .attr('type', 'button')\r\n        .attr('value', label)\r\n        .on('click', callback);\r\n}\r\n\r\n","/// <reference path=\"./lib/d3.d.ts\"/>\r\n\r\nimport * as dynamicgraph from \"./dynamicgraph\";\r\nimport * as messenger from \"./messenger\";\r\n\r\n\r\nimport { SmartSlider } from './smartslider'\r\n\r\nimport {\r\n    RadioButton\r\n} from './ui'\r\n\r\nimport * as m from 'moment'\r\n\r\nexport class TimeSlider {\r\n\r\n\r\n    /** VISUALIZATION  PARAMETERS */\r\n\r\n    MARGIN_SLIDER_RIGHT: number = 30;\r\n    MARGIN_SLIDER_LEFT: number = 10;\r\n    TICK_GAP: number = 2;\r\n    TICK_LABEL_GAP: number = 40;\r\n    SLIDER_TOP: number = 25;\r\n    HEIGHT = 200;\r\n\r\n\r\n    /** GLOBAL VARIABLES */\r\n\r\n    dgraph: dynamicgraph.DynamicGraph;\r\n    slider: SmartSlider;\r\n    times: dynamicgraph.Time[];\r\n    sliderWidth: number;\r\n    widgetWidth: number;\r\n    callBack: Function | undefined = undefined;\r\n\r\n    // function that is called when this time slider's time is changed\r\n    propagateButton: RadioButton = new RadioButton('#000000');\r\n\r\n    labelStart: any; // BEFORE d3.Selection<d3.BaseType, {}, HTMLElement, any>;\r\n    labelEnd: any; // BEFORE d3.Selection<d3.BaseType, {}, HTMLElement, any>; \r\n\r\n    tickScale: any;\r\n    tickHeightFunction: Function;\r\n\r\n    constructor(dgraph: dynamicgraph.DynamicGraph, width: number, callBack?: Function) {\r\n        this.dgraph = dgraph;\r\n        this.times = dgraph.times().toArray();\r\n        this.widgetWidth = width;\r\n\r\n        var timesDummy = new dynamicgraph.Time(0, this.dgraph);\r\n        this.sliderWidth = width - this.MARGIN_SLIDER_RIGHT + 5 - this.MARGIN_SLIDER_LEFT - 5;\r\n        var lastDummyYear: m.Moment = this.times.length != 0 ? this.times[this.times.length - 1].moment() : timesDummy.moment(); // WHAT HAPPEND??\r\n        var minGran: number = dgraph.gran_min;\r\n        var minGranName: m.unitOfTime.DurationConstructor = 'milliseconds';\r\n        switch (minGran) {\r\n            case 1: minGranName = 'milliseconds'; break;\r\n            case 2: minGranName = 'seconds'; break;\r\n            case 3: minGranName = 'minutes'; break;\r\n            case 4: minGranName = 'hours'; break;\r\n            case 5: minGranName = 'days'; break;\r\n            case 5: minGranName = 'weeks'; break;\r\n            case 6: minGranName = 'months'; break;\r\n            case 7: minGranName = 'years'; break;\r\n            // case 8: minGranName = 'decades'; break;\r\n            // case 9: minGranName = 'centuries'; break;\r\n            // case 10: minGranName = 'millenia'; break;\r\n        }\r\n\r\n        if (!lastDummyYear) {\r\n            lastDummyYear = m.unix(0);\r\n        }\r\n\r\n        lastDummyYear.add(1, minGranName);\r\n\r\n        let unixTimeSlider = this.times.length != 0 ? this.times[0].unixTime() : 0; // IS IT OK?? \r\n        this.slider = new SmartSlider(this.MARGIN_SLIDER_LEFT, this.SLIDER_TOP, this.sliderWidth, unixTimeSlider, lastDummyYear.valueOf(), 1);\r\n\r\n        if (callBack)\r\n            this.callBack = callBack\r\n\r\n        this.tickScale = d3.time.scale.utc()\r\n            .range([this.MARGIN_SLIDER_LEFT, this.MARGIN_SLIDER_LEFT + this.sliderWidth])\r\n            .domain([unixTimeSlider, lastDummyYear.valueOf()]);\r\n\r\n\r\n        this.tickHeightFunction = d3.scale.linear()\r\n            .range([4, this.SLIDER_TOP - 10])\r\n            .domain([dgraph.gran_min, dgraph.gran_max]);\r\n    }\r\n\r\n    appendTo(svg: D3.Selection, x?: number, y?: number) {\r\n\r\n        if (!x) x = 0\r\n        if (!y) y = 0\r\n\r\n        var g: any = svg.append('g')\r\n            .attr('transform', 'translate(' + x + ',' + y + ')')\r\n\r\n        g.append(\"g\")\r\n            .attr('transform', 'translate(0,' + this.SLIDER_TOP + ')')\r\n            .attr(\"class\", \"x axis\")\r\n            .call(d3.svg.axis().scale(this.tickScale).orient(\"top\"));\r\n\r\n        this.labelStart = g.append('text')\r\n            .attr('y', this.SLIDER_TOP + 20)\r\n            .style('opacity', 0)\r\n            .style('font-family', 'Helvetica')\r\n            .style('font-weigth', '100')\r\n            .style('font-size', '8pt')\r\n            .style('text-anchor', 'end')\r\n            .text('')\r\n            .style('user-select', 'none')\r\n            .style('-webkit-user-select', 'none')\r\n            .style('-khtml-user-select', 'none')\r\n            .style('-moz-user-select', 'none')\r\n            .style('-o-user-select', 'none')\r\n            .style('user-select', 'none')\r\n\r\n        this.labelEnd = g.append('text')\r\n            .style('opacity', 0)\r\n            .attr('y', this.SLIDER_TOP + 20)\r\n            .style('font-family', 'Helvetica')\r\n            .style('font-weigth', '100')\r\n            .style('font-size', '8pt')\r\n            .style('text-anchor', 'start')\r\n            .text('')\r\n            .style('user-select', 'none')\r\n            .style('-webkit-user-select', 'none')\r\n            .style('-khtml-user-select', 'none')\r\n            .style('-moz-user-select', 'none')\r\n            .style('-o-user-select', 'none')\r\n            .style('user-select', 'none')\r\n\r\n        this.slider.appendTo(g);\r\n        this.slider.setDragEndCallBack((min: any, max: any, single: any) => this.updateTime(min, max, single));\r\n\r\n        this.propagateButton = new RadioButton('#000000', 'Syncronize Time')\r\n        this.propagateButton.appendTo(this.sliderWidth + 15, this.SLIDER_TOP + 8, g)\r\n    }\r\n\r\n\r\n    drawTickmarks(granularity: number, tickTimes: dynamicgraph.Time[], svg: D3.Selection) {\r\n        var time: dynamicgraph.Time;\r\n        var displayLabelSpacing: number = 1; // display every label\r\n        while (Math.floor(this.sliderWidth / this.TICK_LABEL_GAP) < (tickTimes.length / displayLabelSpacing) && displayLabelSpacing < 100) {\r\n            displayLabelSpacing++;\r\n        }\r\n\r\n        for (var i = 0; i < tickTimes.length; i++) {\r\n\r\n            if ((i % displayLabelSpacing) == 0) {\r\n                svg.append('text')\r\n                    .attr('x', this.tickScale(tickTimes[i].unixTime()))\r\n                    .attr('y', this.SLIDER_TOP - this.tickHeightFunction(granularity))\r\n                    .text(this.formatAtGranularity(tickTimes[i].time(), granularity))\r\n                    .attr('id', 'timelabel_' + granularity + '_' + i)\r\n                    .attr('class', 'timelabel')\r\n                    .style('opacity', .5)\r\n                    .style('font-family', 'Helvetica')\r\n                    .style('font-weigth', '100')\r\n                    .style('font-size', '7pt');\r\n\r\n                svg.append('line')\r\n                    .attr('x1', this.tickScale(tickTimes[i].unixTime()))\r\n                    .attr('x2', this.tickScale(tickTimes[i].unixTime()))\r\n                    .attr('y1', this.SLIDER_TOP)\r\n                    .attr('y2', this.SLIDER_TOP - this.tickHeightFunction(granularity))\r\n                    .style('stroke', '#bbb');\r\n            }\r\n        }\r\n    }\r\n\r\n    formatAtGranularity(time: m.Moment, granualarity: number) {\r\n        switch (granualarity) {\r\n            case 0: return time.millisecond();\r\n            case 1: return time.second();\r\n            case 2: return time.minute();\r\n            case 3: return time.hour();\r\n            case 4: return time.day();\r\n            case 5: return time.week();\r\n            case 6: return time.month() + 1;\r\n            default: return time.year();\r\n        }\r\n    }\r\n\r\n    formatForGranularities(time: dynamicgraph.Time, gran_min: number, gran_max: number) {\r\n        var formatString: string = ''\r\n        var format: string;\r\n        while (gran_max >= gran_min) {\r\n            formatString += this.getGranularityFormattingString(gran_max, (gran_max > gran_min));\r\n            gran_max--;\r\n        }\r\n        return time.format(formatString.trim());\r\n    }\r\n\r\n    getGranularityFormattingString(granualarity: any, separator: boolean) {\r\n        switch (granualarity) {\r\n            case 0: return 'SSS';\r\n            case 1: return 'ss' + (separator ? '.' : '');\r\n            case 2: return 'mm' + (separator ? ':' : '');\r\n            case 3: return 'hh' + (separator ? '' : '');\r\n            case 4: return 'DD' + (separator ? ' ' : '');\r\n            case 6: return 'MM' + (separator ? '-' : '');\r\n            default: return 'YYYY' + (separator ? '-' : '');\r\n        }\r\n    }\r\n\r\n\r\n    updateTime(minUnix: number, maxUnix: number, single: number) {\r\n        // times are still correct here? \r\n\r\n        var format = function (d: any) { return d.toDateString(); };\r\n\r\n        single = Math.round(single);\r\n\r\n        this.labelStart\r\n            .attr('x', this.slider.valueRange.invert(minUnix) + 10)\r\n            .style('opacity', 1)\r\n            .text(format(new Date(minUnix)));\r\n\r\n        this.labelEnd\r\n            .attr('x', this.slider.valueRange.invert(maxUnix) + 10)\r\n            .style('opacity', 1)\r\n            .text(format(new Date(maxUnix)));\r\n\r\n        if (this.callBack != undefined)\r\n            this.callBack(minUnix, maxUnix, this.propagateButton.isChecked());\r\n        else\r\n            messenger.timeRange(minUnix, maxUnix, this.times[single], this.propagateButton.isChecked());\r\n    }\r\n\r\n\r\n    set(startUnix: number, endUnix: number) {\r\n        this.slider.set(startUnix, endUnix)\r\n    }\r\n}\r\n"],"names":["moment.utc","LZString.compress","LZString.decompress","reorder\r\n        .optimal_leaf_order","timeFormat","main.timeFormat","search","THREE.Geometry","THREE.Vector3","THREE.LineBasicMaterial","THREE.Line","THREE.TextGeometry","THREE.MeshBasicMaterial","THREE.Mesh","THREE.Scene","THREE.OrthographicCamera","THREE.WebGLRenderer","THREE.BufferGeometry","$","THREE.PointLight","THREE.Color","THREE.BufferAttribute","THREE.Texture","THREE.LinearFilter","THREE.PlaneGeometry","THREE.CircleGeometry","THREE.ShaderMaterial","THREE.NormalBlending","THREE.DoubleSide","THREE.Shape","THREE.ShapeGeometry","dynamicgraph.GRANULARITY","moment.duration","utils.formatAtGranularity","dynamicgraph.Time","m.unix","messenger.timeRange"],"mappings":"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"}